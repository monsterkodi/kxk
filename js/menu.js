(function() {
  /*
  00     00  00000000  000   000  000   000  
  000   000  000       0000  000  000   000  
  000000000  0000000   000 0 000  000   000  
  000 0 000  000       000  0000  000   000  
  000   000  00000000  000   000   0000000   
  */
  var Menu, elem, keyinfo, log, popup, post, stopEvent;

  ({post, stopEvent, keyinfo, popup, elem, log} = require('./kxk'));

  Menu = class Menu {
    constructor(opt) {
      var combo, div, i, item, len, ref;
      
      // 00000000   0000000    0000000  000   000   0000000  
      // 000       000   000  000       000   000  000       
      // 000000    000   000  000       000   000  0000000   
      // 000       000   000  000       000   000       000  
      // 000        0000000    0000000   0000000   0000000   
      this.focus = this.focus.bind(this);
      this.blur = this.blur.bind(this);
      this.onHover = this.onHover.bind(this);
      this.onFocusOut = this.onFocusOut.bind(this);
      
      //  0000000  000       0000000    0000000  00000000  
      // 000       000      000   000  000       000       
      // 000       000      000   000  0000000   0000000   
      // 000       000      000   000       000  000       
      //  0000000  0000000   0000000   0000000   00000000  
      this.close = this.close.bind(this);
      
      // 000   000  00000000  000   000  
      // 000  000   000        000 000   
      // 0000000    0000000     00000    
      // 000  000   000          000     
      // 000   000  00000000     000     
      this.onKeyDown = this.onKeyDown.bind(this);
      this.onClick = this.onClick.bind(this);
      this.elem = elem({
        class: 'menu',
        tabindex: 3
      });
      ref = opt.items;
      for (i = 0, len = ref.length; i < len; i++) {
        item = ref[i];
        if (item.hide) {
          continue;
        }
        div = elem({
          class: 'menuItem',
          text: item.text
        });
        div.item = item;
        div.addEventListener('click', this.onClick);
        if (item.combo != null) {
          combo = elem('span', {
            class: 'popupCombo',
            text: keyinfo.short(item.combo)
          });
          div.appendChild(combo);
        }
        this.elem.appendChild(div);
      }
      this.select(this.elem.firstChild);
      this.elem.addEventListener('keydown', this.onKeyDown);
      this.elem.addEventListener('focusout', this.onFocusOut);
      this.elem.addEventListener('mouseover', this.onHover);
    }

    focus() {
      this.focusElem = document.activeElement;
      return this.elem.focus();
    }

    blur() {
      var ref;
      this.close();
      return (ref = this.focusElem) != null ? typeof ref.focus === "function" ? ref.focus() : void 0 : void 0;
    }

    onHover(event) {
      return this.select(event.target, {
        selectFirstItem: false
      });
    }

    onFocusOut(event) {
      var ref;
      if (this.popup && !((ref = event.relatedTarget) != null ? ref.classList.contains('popup') : void 0)) {
        this.popup.close({
          focus: false
        });
        return delete this.popup;
      }
    }

    
    //  0000000   00000000   00000000  000   000  
    // 000   000  000   000  000       0000  000  
    // 000   000  00000000   0000000   000 0 000  
    // 000   000  000        000       000  0000  
    //  0000000   000        00000000  000   000  
    open() {
      return this.select(this.elem.firstChild, {
        activate: true
      });
    }

    close(opt = {}) {
      var ref;
      if (this.popup != null) {
        this.popup.close({
          focus: false
        });
        delete this.popup;
        if (opt.focus !== false) {
          return this.elem.focus();
        }
      } else {
        if (opt.focus !== false) {
          return (ref = this.focusElem) != null ? typeof ref.focus === "function" ? ref.focus() : void 0 : void 0;
        }
      }
    }

    childClosed(child, opt) {
      if (child === this.popup) {
        delete this.popup;
        if (opt.focus !== false) {
          return this.elem.focus();
        }
      }
    }

    
    //  0000000  00000000  000      00000000   0000000  000000000  
    // 000       000       000      000       000          000     
    // 0000000   0000000   000      0000000   000          000     
    //      000  000       000      000       000          000     
    // 0000000   00000000  0000000  00000000   0000000     000     
    select(item, opt = {}) {
      var hadPopup, ref;
      if (item == null) {
        return;
      }
      if (this.popup != null) {
        hadPopup = true;
        this.popup.close({
          focus: false
        });
      }
      if ((ref = this.selected) != null) {
        ref.classList.remove('selected');
      }
      this.selected = item;
      this.selected.classList.add('selected');
      if (hadPopup || opt.activate) {
        delete this.popup;
        return this.activate(item, opt);
      }
    }

    
    //  0000000    0000000  000000000  000  000   000   0000000   000000000  00000000  
    // 000   000  000          000     000  000   000  000   000     000     000       
    // 000000000  000          000     000   000 000   000000000     000     0000000   
    // 000   000  000          000     000     000     000   000     000     000       
    // 000   000   0000000     000     000      0      000   000     000     00000000  
    activate(item, opt = {}) {
      var br, items, pr;
      items = item.item.menu;
      if (items) {
        if (this.popup) {
          this.popup.close({
            focus: false
          });
          delete this.popup;
        }
        br = item.getBoundingClientRect();
        pr = item.parentNode.getBoundingClientRect();
        opt.items = items;
        opt.parent = this;
        opt.x = br.left;
        opt.y = pr.top + pr.height;
        opt.class = 'titlemenu';
        this.popup = popup.menu(opt);
        if (opt.selectFirstItem === false) {
          return this.elem.focus();
        }
      }
    }

    toggle(item) {
      if (this.popup) {
        this.popup.close({
          focus: false
        });
        return delete this.popup;
      } else {
        return this.activate(item, {
          selectFirstItem: false
        });
      }
    }

    itemSelected(item, elem) {}

    deactivate(item) {
      return log(item.item);
    }

    navigateLeft() {
      var ref;
      return this.select((ref = this.selected) != null ? ref.previousSibling : void 0, {
        activate: true,
        selectFirstItem: false
      });
    }

    navigateRight() {
      var ref;
      return this.select((ref = this.selected) != null ? ref.nextSibling : void 0, {
        activate: true,
        selectFirstItem: false
      });
    }

    onKeyDown(event) {
      var combo, key, mod;
      ({mod, key, combo} = keyinfo.forEvent(event));
      switch (combo) {
        case 'end':
        case 'page down':
          return stopEvent(event, this.select(this.elem.lastChild, {
            activate: true,
            selectFirstItem: false
          }));
        case 'home':
        case 'page up':
          return stopEvent(event, this.select(this.elem.firstChild, {
            activate: true,
            selectFirstItem: false
          }));
        case 'enter':
        case 'down':
        case 'space':
          return stopEvent(event, this.activate(this.selected));
        case 'esc':
          return stopEvent(event, this.close());
        case 'right':
          return stopEvent(event, this.navigateRight());
        case 'left':
          return stopEvent(event, this.navigateLeft());
      }
    }

    onClick(e) {
      return this.toggle(e.target);
    }

  };

  module.exports = Menu;

}).call(this);

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibWVudS5qcyIsInNvdXJjZVJvb3QiOiIuIiwic291cmNlcyI6WyIuLi9jb2ZmZWUvbWVudS5jb2ZmZWUiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7RUFBQTs7Ozs7OztBQUFBLE1BQUEsSUFBQSxFQUFBLElBQUEsRUFBQSxPQUFBLEVBQUEsR0FBQSxFQUFBLEtBQUEsRUFBQSxJQUFBLEVBQUE7O0VBUUEsQ0FBQSxDQUFFLElBQUYsRUFBUSxTQUFSLEVBQW1CLE9BQW5CLEVBQTRCLEtBQTVCLEVBQW1DLElBQW5DLEVBQXlDLEdBQXpDLENBQUEsR0FBaUQsT0FBQSxDQUFRLE9BQVIsQ0FBakQ7O0VBRU0sT0FBTixNQUFBLEtBQUE7SUFFSSxXQUFhLENBQUMsR0FBRCxDQUFBO0FBRVQsVUFBQSxLQUFBLEVBQUEsR0FBQSxFQUFBLENBQUEsRUFBQSxJQUFBLEVBQUEsR0FBQSxFQUFBLEdBQUE7Ozs7Ozs7VUF3QkosQ0FBQSxZQUFBLENBQUE7VUFLQSxDQUFBLFdBQUEsQ0FBQTtVQUVBLENBQUEsY0FBQSxDQUFBO1VBRUEsQ0FBQSxpQkFBQSxDQUFBLHNCQWpDSTs7Ozs7OztVQXFESixDQUFBLFlBQUEsQ0FBQSxpQkFyREk7Ozs7Ozs7VUE2SUosQ0FBQSxnQkFBQSxDQUFBO1VBYUEsQ0FBQSxjQUFBLENBQUE7TUExSkksSUFBQyxDQUFBLElBQUQsR0FBUSxJQUFBLENBQUs7UUFBQSxLQUFBLEVBQU8sTUFBUDtRQUFlLFFBQUEsRUFBVTtNQUF6QixDQUFMO0FBRVI7TUFBQSxLQUFBLHFDQUFBOztRQUNJLElBQVksSUFBSSxDQUFDLElBQWpCO0FBQUEsbUJBQUE7O1FBQ0EsR0FBQSxHQUFNLElBQUEsQ0FBSztVQUFBLEtBQUEsRUFBTyxVQUFQO1VBQW1CLElBQUEsRUFBTSxJQUFJLENBQUM7UUFBOUIsQ0FBTDtRQUNOLEdBQUcsQ0FBQyxJQUFKLEdBQVc7UUFDWCxHQUFHLENBQUMsZ0JBQUosQ0FBcUIsT0FBckIsRUFBOEIsSUFBQyxDQUFBLE9BQS9CO1FBQ0Es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Q0FBQSxJQUFJLENBQUMsVUFBZCxFQUEwQjtZQUFBLFFBQUEsRUFBUyxJQUFUO1lBQWUsZUFBQSxFQUFnQjtVQUEvQixDQUExQixDQUFqQjtBQUh6QyxhQUlTLE9BSlQ7QUFBQSxhQUlrQixNQUpsQjtBQUFBLGFBSTBCLE9BSjFCO2lCQUl5QyxTQUFBLENBQVUsS0FBVixFQUFpQixJQUFDLENBQUEsUUFBRCxDQUFVLElBQUMsQ0FBQSxRQUFYLENBQWpCO0FBSnpDLGFBS1MsS0FMVDtpQkFLeUMsU0FBQSxDQUFVLEtBQVYsRUFBaUIsSUFBQyxDQUFBLEtBQUQsQ0FBQSxDQUFqQjtBQUx6QyxhQU1TLE9BTlQ7aUJBTXlDLFNBQUEsQ0FBVSxLQUFWLEVBQWlCLElBQUMsQ0FBQSxhQUFELENBQUEsQ0FBakI7QUFOekMsYUFPUyxNQVBUO2lCQU95QyxTQUFBLENBQVUsS0FBVixFQUFpQixJQUFDLENBQUEsWUFBRCxDQUFBLENBQWpCO0FBUHpDO0lBSk87O0lBYVgsT0FBUyxDQUFDLENBQUQsQ0FBQTthQUFPLElBQUMsQ0FBQSxNQUFELENBQVEsQ0FBQyxDQUFDLE1BQVY7SUFBUDs7RUE5SmI7O0VBZ0tBLE1BQU0sQ0FBQyxPQUFQLEdBQWlCO0FBMUtqQiIsInNvdXJjZXNDb250ZW50IjpbIiMjI1xuMDAgICAgIDAwICAwMDAwMDAwMCAgMDAwICAgMDAwICAwMDAgICAwMDAgIFxuMDAwICAgMDAwICAwMDAgICAgICAgMDAwMCAgMDAwICAwMDAgICAwMDAgIFxuMDAwMDAwMDAwICAwMDAwMDAwICAgMDAwIDAgMDAwICAwMDAgICAwMDAgIFxuMDAwIDAgMDAwICAwMDAgICAgICAgMDAwICAwMDAwICAwMDAgICAwMDAgIFxuMDAwICAgMDAwICAwMDAwMDAwMCAgMDAwICAgMDAwICAgMDAwMDAwMCAgIFxuIyMjXG5cbnsgcG9zdCwgc3RvcEV2ZW50LCBrZXlpbmZvLCBwb3B1cCwgZWxlbSwgbG9nIH0gPSByZXF1aXJlICcuL2t4aydcblxuY2xhc3MgTWVudVxuICAgIFxuICAgIGNvbnN0cnVjdG9yOiAob3B0KSAtPlxuICAgICAgICBcbiAgICAgICAgQGVsZW0gPSBlbGVtIGNsYXNzOiAnbWVudScsIHRhYmluZGV4OiAzXG4gICAgICAgIFxuICAgICAgICBmb3IgaXRlbSBpbiBvcHQuaXRlbXNcbiAgICAgICAgICAgIGNvbnRpbnVlIGlmIGl0ZW0uaGlkZVxuICAgICAgICAgICAgZGl2ID0gZWxlbSBjbGFzczogJ21lbnVJdGVtJywgdGV4dDogaXRlbS50ZXh0XG4gICAgICAgICAgICBkaXYuaXRlbSA9IGl0ZW1cbiAgICAgICAgICAgIGRpdi5hZGRFdmVudExpc3RlbmVyICdjbGljaycsIEBvbkNsaWNrXG4gICAgICAgICAgICBpZiBpdGVtLmNvbWJvP1xuICAgICAgICAgICAgICAgIGNvbWJvID0gZWxlbSAnc3BhbicsIGNsYXNzOiAncG9wdXBDb21ibycsIHRleHQ6IGtleWluZm8uc2hvcnQgaXRlbS5jb21ib1xuICAgICAgICAgICAgICAgIGRpdi5hcHBlbmRDaGlsZCBjb21ib1xuICAgICAgICAgICAgQGVsZW0uYXBwZW5kQ2hpbGQgZGl2XG5cbiAgICAgICAgQHNlbGVjdCBAZWxlbS5maXJzdENoaWxkXG4gICAgICAgICAgICBcbiAgICAgICAgQGVsZW0uYWRkRXZlbnRMaXN0ZW5lciAna2V5ZG93bicsICAgQG9uS2V5RG93blxuICAgICAgICBAZWxlbS5hZGRFdmVudExpc3RlbmVyICdmb2N1c291dCcsICBAb25Gb2N1c091dFxuICAgICAgICBAZWxlbS5hZGRFdmVudExpc3RlbmVyICdtb3VzZW92ZXInLCBAb25Ib3ZlclxuICAgICAgICBcbiAgICAjIDAwMDAwMDAwICAgMDAwMDAwMCAgICAwMDAwMDAwICAwMDAgICAwMDAgICAwMDAwMDAwICBcbiAgICAjIDAwMCAgICAgICAwMDAgICAwMDAgIDAwMCAgICAgICAwMDAgICAwMDAgIDAwMCAgICAgICBcbiAgICAjIDAwMDAwMCAgICAwMDAgICAwMDAgIDAwMCAgICAgICAwMDAgICAwMDAgIDAwMDAwMDAgICBcbiAgICAjIDAwMCAgICAgICAwMDAgICAwMDAgIDAwMCAgICAgICAwMDAgICAwMDAgICAgICAgMDAwICBcbiAgICAjIDAwMCAgICAgICAgMDAwMDAwMCAgICAwMDAwMDAwICAgMDAwMDAwMCAgIDAwMDAwMDAgICBcbiAgICBcbiAgICBmb2N1czogPT4gXG4gICAgICAgIFxuICAgICAgICBAZm9jdXNFbGVtID0gZG9jdW1lbnQuYWN0aXZlRWxlbWVudFxuICAgICAgICBAZWxlbS5mb2N1cygpXG4gICAgICAgIFxuICAgIGJsdXI6ID0+IEBjbG9zZSgpOyBAZm9jdXNFbGVtPy5mb2N1cz8oKVxuICAgIFxuICAgIG9uSG92ZXI6IChldmVudCkgPT4gQHNlbGVjdCBldmVudC50YXJnZXQsIHNlbGVjdEZpcnN0SXRlbTpmYWxzZVxuICAgIFxuICAgIG9uRm9jdXNPdXQ6IChldmVudCkgPT4gXG4gICAgICAgIFxuICAgICAgICBpZiBAcG9wdXAgYW5kIG5vdCBldmVudC5yZWxhdGVkVGFyZ2V0Py5jbGFzc0xpc3QuY29udGFpbnMgJ3BvcHVwJ1xuICAgICAgICAgICAgQHBvcHVwLmNsb3NlIGZvY3VzOmZhbHNlXG4gICAgICAgICAgICBkZWxldGUgQHBvcHVwXG4gICAgXG4gICAgIyAgMDAwMDAwMCAgIDAwMDAwMDAwICAgMDAwMDAwMDAgIDAwMCAgIDAwMCAgXG4gICAgIyAwMDAgICAwMDAgIDAwMCAgIDAwMCAgMDAwICAgICAgIDAwMDAgIDAwMCAgXG4gICAgIyAwMDAgICAwMDAgIDAwMDAwMDAwICAgMDAwMDAwMCAgIDAwMCAwIDAwMCAgXG4gICAgIyAwMDAgICAwMDAgIDAwMCAgICAgICAgMDAwICAgICAgIDAwMCAgMDAwMCAgXG4gICAgIyAgMDAwMDAwMCAgIDAwMCAgICAgICAgMDAwMDAwMDAgIDAwMCAgIDAwMCAgXG4gICAgXG4gICAgb3BlbjogLT4gQHNlbGVjdCBAZWxlbS5maXJzdENoaWxkLCBhY3RpdmF0ZTp0cnVlXG4gICAgICAgICAgICBcbiAgICAjICAwMDAwMDAwICAwMDAgICAgICAgMDAwMDAwMCAgICAwMDAwMDAwICAwMDAwMDAwMCAgXG4gICAgIyAwMDAgICAgICAgMDAwICAgICAgMDAwICAgMDAwICAwMDAgICAgICAgMDAwICAgICAgIFxuICAgICMgMDAwICAgICAgIDAwMCAgICAgIDAwMCAgIDAwMCAgMDAwMDAwMCAgIDAwMDAwMDAgICBcbiAgICAjIDAwMCAgICAgICAwMDAgICAgICAwMDAgICAwMDAgICAgICAgMDAwICAwMDAgICAgICAgXG4gICAgIyAgMDAwMDAwMCAgMDAwMDAwMCAgIDAwMDAwMDAgICAwMDAwMDAwICAgMDAwMDAwMDAgIFxuICAgIFxuICAgIGNsb3NlOiAob3B0PXt9KSA9PlxuICAgICAgICBcbiAgICAgICAgaWYgQHBvcHVwP1xuICAgICAgICAgICAgQHBvcHVwLmNsb3NlIGZvY3VzOmZhbHNlXG4gICAgICAgICAgICBkZWxldGUgQHBvcHVwXG4gICAgICAgICAgICBpZiBvcHQuZm9jdXMgIT0gZmFsc2VcbiAgICAgICAgICAgICAgICBAZWxlbS5mb2N1cygpXG4gICAgICAgIGVsc2VcbiAgICAgICAgICAgIGlmIG9wdC5mb2N1cyAhPSBmYWxzZVxuICAgICAgICAgICAgICAgIEBmb2N1c0VsZW0/LmZvY3VzPygpXG4gICAgICAgICAgICBcbiAgICBjaGlsZENsb3NlZDogKGNoaWxkLCBvcHQpIC0+XG4gICAgICAgIFxuICAgICAgICBpZiBjaGlsZCA9PSBAcG9wdXBcbiAgICAgICAgICAgIGRlbGV0ZSBAcG9wdXBcbiAgICAgICAgICAgIGlmIG9wdC5mb2N1cyAhPSBmYWxzZVxuICAgICAgICAgICAgICAgIEBlbGVtLmZvY3VzKClcbiAgICBcbiAgICAjICAwMDAwMDAwICAwMDAwMDAwMCAgMDAwICAgICAgMDAwMDAwMDAgICAwMDAwMDAwICAwMDAwMDAwMDAgIFxuICAgICMgMDAwICAgICAgIDAwMCAgICAgICAwMDAgICAgICAwMDAgICAgICAgMDAwICAgICAgICAgIDAwMCAgICAgXG4gICAgIyAwMDAwMDAwICAgMDAwMDAwMCAgIDAwMCAgICAgIDAwMDAwMDAgICAwMDAgICAgICAgICAgMDAwICAgICBcbiAgICAjICAgICAgMDAwICAwMDAgICAgICAgMDAwICAgICAgMDAwICAgICAgIDAwMCAgICAgICAgICAwMDAgICAgIFxuICAgICMgMDAwMDAwMCAgIDAwMDAwMDAwICAwMDAwMDAwICAwMDAwMDAwMCAgIDAwMDAwMDAgICAgIDAwMCAgICAgXG4gICAgXG4gICAgc2VsZWN0OiAoaXRlbSwgb3B0PXt9KSAtPiBcbiAgICAgICAgXG4gICAgICAgIHJldHVybiBpZiBub3QgaXRlbT9cbiAgICAgICAgXG4gICAgICAgIGlmIEBwb3B1cD9cbiAgICAgICAgICAgIGhhZFBvcHVwID0gdHJ1ZVxuICAgICAgICAgICAgQHBvcHVwLmNsb3NlIGZvY3VzOmZhbHNlXG4gICAgICAgIFxuICAgICAgICBAc2VsZWN0ZWQ/LmNsYXNzTGlzdC5yZW1vdmUgJ3NlbGVjdGVkJ1xuICAgICAgICBAc2VsZWN0ZWQgPSBpdGVtXG4gICAgICAgIEBzZWxlY3RlZC5jbGFzc0xpc3QuYWRkICdzZWxlY3RlZCdcbiAgICAgICAgXG4gICAgICAgIGlmIGhhZFBvcHVwIG9yIG9wdC5hY3RpdmF0ZVxuICAgICAgICAgICAgZGVsZXRlIEBwb3B1cFxuICAgICAgICAgICAgQGFjdGl2YXRlIGl0ZW0sIG9wdFxuICAgICAgICBcbiAgICAjICAwMDAwMDAwICAgIDAwMDAwMDAgIDAwMDAwMDAwMCAgMDAwICAwMDAgICAwMDAgICAwMDAwMDAwICAgMDAwMDAwMDAwICAwMDAwMDAwMCAgXG4gICAgIyAwMDAgICAwMDAgIDAwMCAgICAgICAgICAwMDAgICAgIDAwMCAgMDAwICAgMDAwICAwMDAgICAwMDAgICAgIDAwMCAgICAgMDAwICAgICAgIFxuICAgICMgMDAwMDAwMDAwICAwMDAgICAgICAgICAgMDAwICAgICAwMDAgICAwMDAgMDAwICAgMDAwMDAwMDAwICAgICAwMDAgICAgIDAwMDAwMDAgICBcbiAgICAjIDAwMCAgIDAwMCAgMDAwICAgICAgICAgIDAwMCAgICAgMDAwICAgICAwMDAgICAgIDAwMCAgIDAwMCAgICAgMDAwICAgICAwMDAgICAgICAgXG4gICAgIyAwMDAgICAwMDAgICAwMDAwMDAwICAgICAwMDAgICAgIDAwMCAgICAgIDAgICAgICAwMDAgICAwMDAgICAgIDAwMCAgICAgMDAwMDAwMDAgIFxuICAgIFxuICAgIGFjdGl2YXRlOiAoaXRlbSwgb3B0PXt9KSAtPiBcbiAgICAgICAgXG4gICAgICAgIGl0ZW1zID0gaXRlbS5pdGVtLm1lbnVcbiAgICAgICAgXG4gICAgICAgIGlmIGl0ZW1zXG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGlmIEBwb3B1cFxuICAgICAgICAgICAgICAgIEBwb3B1cC5jbG9zZSBmb2N1czpmYWxzZVxuICAgICAgICAgICAgICAgIGRlbGV0ZSBAcG9wdXBcblxuICAgICAgICAgICAgYnIgPSBpdGVtLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpXG4gICAgICAgICAgICBwciA9IGl0ZW0ucGFyZW50Tm9kZS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKVxuICAgICAgICAgICAgb3B0Lml0ZW1zID0gaXRlbXNcbiAgICAgICAgICAgIG9wdC5wYXJlbnQgPSBAXG4gICAgICAgICAgICBvcHQueCA9IGJyLmxlZnRcbiAgICAgICAgICAgIG9wdC55ID0gcHIudG9wK3ByLmhlaWdodFxuICAgICAgICAgICAgb3B0LmNsYXNzID0gJ3RpdGxlbWVudSdcbiAgICAgICAgICAgIEBwb3B1cCA9IHBvcHVwLm1lbnUgb3B0XG4gICAgICAgICAgICBpZiBvcHQuc2VsZWN0Rmlyc3RJdGVtID09IGZhbHNlXG4gICAgICAgICAgICAgICAgQGVsZW0uZm9jdXMoKVxuXG4gICAgdG9nZ2xlOiAoaXRlbSkgLT5cbiAgICAgICAgXG4gICAgICAgIGlmIEBwb3B1cFxuICAgICAgICAgICAgQHBvcHVwLmNsb3NlIGZvY3VzOmZhbHNlXG4gICAgICAgICAgICBkZWxldGUgQHBvcHVwXG4gICAgICAgIGVsc2VcbiAgICAgICAgICAgIEBhY3RpdmF0ZSBpdGVtLCBzZWxlY3RGaXJzdEl0ZW06ZmFsc2VcbiAgICAgICAgICAgIFxuICAgIGl0ZW1TZWxlY3RlZDogKGl0ZW0sIGVsZW0pIC0+XG4gICAgICAgICAgICBcbiAgICBkZWFjdGl2YXRlOiAoaXRlbSkgLT4gbG9nIGl0ZW0uaXRlbVxuXG4gICAgbmF2aWdhdGVMZWZ0OiAgLT4gQHNlbGVjdCBAc2VsZWN0ZWQ/LnByZXZpb3VzU2libGluZywgYWN0aXZhdGU6dHJ1ZSwgc2VsZWN0Rmlyc3RJdGVtOmZhbHNlXG4gICAgbmF2aWdhdGVSaWdodDogLT4gQHNlbGVjdCBAc2VsZWN0ZWQ/Lm5leHRTaWJsaW5nLCAgICAgYWN0aXZhdGU6dHJ1ZSwgc2VsZWN0Rmlyc3RJdGVtOmZhbHNlXG4gICAgXG4gICAgIyAwMDAgICAwMDAgIDAwMDAwMDAwICAwMDAgICAwMDAgIFxuICAgICMgMDAwICAwMDAgICAwMDAgICAgICAgIDAwMCAwMDAgICBcbiAgICAjIDAwMDAwMDAgICAgMDAwMDAwMCAgICAgMDAwMDAgICAgXG4gICAgIyAwMDAgIDAwMCAgIDAwMCAgICAgICAgICAwMDAgICAgIFxuICAgICMgMDAwICAgMDAwICAwMDAwMDAwMCAgICAgMDAwICAgICBcbiAgICBcbiAgICBvbktleURvd246IChldmVudCkgPT5cbiAgICAgICAgXG4gICAgICAgIHsgbW9kLCBrZXksIGNvbWJvIH0gPSBrZXlpbmZvLmZvckV2ZW50IGV2ZW50XG4gICAgICAgIFxuICAgICAgICBzd2l0Y2ggY29tYm9cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgd2hlbiAnZW5kJywgJ3BhZ2UgZG93bicgICAgICAgICB0aGVuIHN0b3BFdmVudCBldmVudCwgQHNlbGVjdCBAZWxlbS5sYXN0Q2hpbGQsICBhY3RpdmF0ZTp0cnVlLCBzZWxlY3RGaXJzdEl0ZW06ZmFsc2VcbiAgICAgICAgICAgIHdoZW4gJ2hvbWUnLCAncGFnZSB1cCcgICAgICAgICAgdGhlbiBzdG9wRXZlbnQgZXZlbnQsIEBzZWxlY3QgQGVsZW0uZmlyc3RDaGlsZCwgYWN0aXZhdGU6dHJ1ZSwgc2VsZWN0Rmlyc3RJdGVtOmZhbHNlXG4gICAgICAgICAgICB3aGVuICdlbnRlcicsICdkb3duJywgJ3NwYWNlJyAgIHRoZW4gc3RvcEV2ZW50IGV2ZW50LCBAYWN0aXZhdGUgQHNlbGVjdGVkXG4gICAgICAgICAgICB3aGVuICdlc2MnICAgICAgICAgICAgICAgICAgICAgIHRoZW4gc3RvcEV2ZW50IGV2ZW50LCBAY2xvc2UoKVxuICAgICAgICAgICAgd2hlbiAncmlnaHQnICAgICAgICAgICAgICAgICAgICB0aGVuIHN0b3BFdmVudCBldmVudCwgQG5hdmlnYXRlUmlnaHQoKVxuICAgICAgICAgICAgd2hlbiAnbGVmdCcgICAgICAgICAgICAgICAgICAgICB0aGVuIHN0b3BFdmVudCBldmVudCwgQG5hdmlnYXRlTGVmdCgpXG4gICAgICAgICAgICBcbiAgICBvbkNsaWNrOiAoZSkgPT4gQHRvZ2dsZSBlLnRhcmdldFxuICAgICAgICBcbm1vZHVsZS5leHBvcnRzID0gTWVudVxuIl19
//# sourceURL=../coffee/menu.coffee