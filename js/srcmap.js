// koffee 1.3.0

/*
 0000000  00000000    0000000  00     00   0000000   00000000   
000       000   000  000       000   000  000   000  000   000  
0000000   0000000    000       000000000  000000000  00000000   
     000  000   000  000       000 0 000  000   000  000        
0000000   000   000   0000000  000   000  000   000  000
 */
var _, empty, errorStack, errorTrace, filePos, fs, klog, logErr, mapConvert, ref, regex1, regex2, slash, sourceMap, toCoffee, toJs, valid;

ref = require('./kxk'), fs = ref.fs, valid = ref.valid, empty = ref.empty, slash = ref.slash, klog = ref.klog, _ = ref._;

sourceMap = require('source-map');

mapConvert = require('convert-source-map');

regex1 = /^\s+at\s+(\S+)\s+\((.*):(\d+):(\d+)\)/;

regex2 = /^\s+at\s+(.*):(\d+):(\d+)/;

logErr = function(err, sep) {
    var i, len, line, ref1, results, trace;
    if (sep == null) {
        sep = 'ðŸ’¥';
    }
    console.log(err);
    trace = errorTrace(err);
    if (valid(trace.lines)) {
        klog.flog({
            str: trace.text,
            source: trace.lines[0].file,
            line: trace.lines[0].line,
            sep: sep
        });
        ref1 = trace.lines;
        results = [];
        for (i = 0, len = ref1.length; i < len; i++) {
            line = ref1[i];
            sep = slash.isAbsolute(line.file) || line.file[0] === '~' ? 'ðŸž' : 'ðŸ”¼';
            if (sep === 'ðŸž' || line.file[0] === '.') {
                results.push(klog.flog({
                    str: '       ' + line.func,
                    source: line.file,
                    line: line.line,
                    sep: sep
                }));
            } else {
                results.push(void 0);
            }
        }
        return results;
    } else {
        return klog.flog({
            str: trace.text,
            source: '',
            line: 0,
            sep: sep
        });
    }
};

filePos = function(line) {
    var a, absFile, b, coffeeCol, coffeeFile, coffeeLine, jsFile, mappedLine, match, ref1, ref2, result;
    if (match = regex1.exec(line)) {
        result = {
            func: match[1].replace('.<anonymous>', ''),
            file: match[2],
            line: match[3],
            col: match[4]
        };
        if (slash.ext(result.file) === 'js') {
            mappedLine = toCoffee(result.file, result.line, result.col);
            if (mappedLine != null) {
                result.file = mappedLine[0];
                result.line = mappedLine[1];
                result.col = mappedLine[2];
            }
        } else if (slash.ext(result.file) === 'coffee' && !slash.isAbsolute(result.file)) {
            absFile = slash.resolve(slash.join(process.cwd(), 'coffee', result.file));
            if (slash.fileExists(absFile)) {
                ref1 = toJs(absFile, 1, 0), jsFile = ref1[0], a = ref1[1], b = ref1[2];
                if (slash.fileExists(jsFile)) {
                    ref2 = toCoffee(jsFile, result.line, result.col), coffeeFile = ref2[0], coffeeLine = ref2[1], coffeeCol = ref2[2];
                    if (slash.fileExists(coffeeFile)) {
                        result.file = coffeeFile;
                        result.line = coffeeLine;
                        result.col = coffeeCol;
                    }
                }
            }
        }
    } else if (match = regex2.exec(line)) {
        result = {
            func: slash.file(match[1]),
            file: match[1],
            line: match[2],
            col: match[3]
        };
        if (slash.ext(result.file) === 'js') {
            mappedLine = toCoffee(result.file, result.line, result.col);
            if (mappedLine != null) {
                result.file = mappedLine[0];
                result.line = mappedLine[1];
                result.col = mappedLine[2];
            }
        }
    }
    return result;
};

errorStack = function(err) {
    var fp, i, len, lines, ref1, stackLine;
    lines = [];
    ref1 = err.stack.split('\n');
    for (i = 0, len = ref1.length; i < len; i++) {
        stackLine = ref1[i];
        if (fp = filePos(stackLine)) {
            lines.push("       " + (_.padEnd(fp.func, 30)) + " " + fp.file + ":" + fp.line);
        } else {
            lines.push(stackLine);
        }
    }
    return lines.join('\n');
};

errorTrace = function(err) {
    var fp, i, len, lines, ref1, stackLine, text;
    lines = [];
    text = [];
    ref1 = err.stack.split('\n');
    for (i = 0, len = ref1.length; i < len; i++) {
        stackLine = ref1[i];
        if (fp = filePos(stackLine)) {
            lines.push(fp);
        } else {
            text.push(stackLine);
        }
    }
    return {
        lines: lines,
        text: text.join('\n')
    };
};

toCoffee = function(jsFile, jsLine, jsCol) {
    var coffeeCol, coffeeFile, coffeeLine, consumer, mapData, pos, ref1;
    if (jsCol == null) {
        jsCol = 0;
    }
    jsLine = parseInt(jsLine);
    jsCol = parseInt(jsCol);
    coffeeFile = slash.tilde(jsFile);
    coffeeLine = jsLine;
    coffeeCol = jsCol;
    if (slash.fileExists(jsFile)) {
        mapData = (ref1 = mapConvert.fromSource(fs.readFileSync(jsFile, 'utf8'))) != null ? ref1.toObject() : void 0;
        if (valid(mapData)) {
            if (mapData != null ? mapData.sources[0] : void 0) {
                mapData.sources[0] = slash.resolve(slash.join(slash.dir(jsFile), mapData != null ? mapData.sources[0] : void 0));
            }
            consumer = new sourceMap.SourceMapConsumer(mapData);
            if (consumer.originalPositionFor) {
                pos = consumer.originalPositionFor({
                    line: jsLine,
                    column: jsCol,
                    bias: sourceMap.SourceMapConsumer.LEAST_UPPER_BOUND
                });
                if (valid(pos.line) && valid(pos.column)) {
                    coffeeFile = slash.tilde(mapData.sources[0]);
                    coffeeLine = pos.line;
                    coffeeCol = pos.column;
                } else {
                    klog('no pos.line', pos);
                }
            } else {
                klog('no consumer originalPositionFor', mapData != null, consumer != null);
            }
        }
    }
    return [coffeeFile, coffeeLine, coffeeCol];
};

toJs = function(coffeeFile, coffeeLine, coffeeCol) {
    var consumer, jsFile, mapData, poss, ref1, ref2, ref3;
    if (coffeeCol == null) {
        coffeeCol = 0;
    }
    jsFile = coffeeFile.replace(/\/coffee\//, '/js/');
    jsFile = jsFile.replace(/\.coffee$/, '.js');
    if (!slash.fileExists(jsFile)) {
        return [null, null, null];
    }
    if (coffeeLine == null) {
        return jsFile;
    }
    mapData = (ref1 = mapConvert.fromSource(fs.readFileSync(jsFile, 'utf8'))) != null ? ref1.toObject() : void 0;
    if (valid(mapData)) {
        if (mapData != null ? mapData.sources[0] : void 0) {
            mapData.sources[0] = slash.resolve(slash.join(slash.dir(jsFile), mapData != null ? mapData.sources[0] : void 0));
        }
        consumer = new sourceMap.SourceMapConsumer(mapData);
        if ((consumer != null ? consumer.allGeneratedPositionsFor : void 0) != null) {
            poss = consumer.allGeneratedPositionsFor({
                source: mapData.sources[0],
                line: coffeeLine
            });
            if (valid(poss)) {
                return [jsFile, (ref2 = poss[0]) != null ? ref2.line : void 0, (ref3 = poss[0]) != null ? ref3.column : void 0];
            } else {
                console.log('srcmap.toJs -- empty poss!');
            }
        } else {
            console.log('srcmap.toJs -- no allGeneratedPositionsFor in', consumer);
        }
    }
    return [jsFile, null, null];
};

module.exports = {
    toJs: toJs,
    toCoffee: toCoffee,
    errorStack: errorStack,
    errorTrace: errorTrace,
    logErr: logErr
};

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic3JjbWFwLmpzIiwic291cmNlUm9vdCI6Ii4iLCJzb3VyY2VzIjpbIiJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOztBQUFBOzs7Ozs7O0FBQUEsSUFBQTs7QUFRQSxNQUF1QyxPQUFBLENBQVEsT0FBUixDQUF2QyxFQUFFLFdBQUYsRUFBTSxpQkFBTixFQUFhLGlCQUFiLEVBQW9CLGlCQUFwQixFQUEyQixlQUEzQixFQUFpQzs7QUFFakMsU0FBQSxHQUFhLE9BQUEsQ0FBUSxZQUFSOztBQUNiLFVBQUEsR0FBYSxPQUFBLENBQVEsb0JBQVI7O0FBRWIsTUFBQSxHQUFhOztBQUNiLE1BQUEsR0FBYTs7QUFRYixNQUFBLEdBQVMsU0FBQyxHQUFELEVBQU0sR0FBTjtBQUdOLFFBQUE7O1FBSFksTUFBSTs7SUFHaEIsT0FBQSxDQUFDLEdBQUQsQ0FBSyxHQUFMO0lBQ0MsS0FBQSxHQUFRLFVBQUEsQ0FBVyxHQUFYO0lBRVIsSUFBRyxLQUFBLENBQU0sS0FBSyxDQUFDLEtBQVosQ0FBSDtRQUNJLElBQUksQ0FBQyxJQUFMLENBQVU7WUFBQSxHQUFBLEVBQUksS0FBSyxDQUFDLElBQVY7WUFBZ0IsTUFBQSxFQUFPLEtBQUssQ0FBQyxLQUFNLENBQUEsQ0FBQSxDQUFFLENBQUMsSUFBdEM7WUFBNEMsSUFBQSxFQUFLLEtBQUssQ0FBQyxLQUFNLENBQUEsQ0FBQSxDQUFFLENBQUMsSUFBaEU7WUFBc0UsR0FBQSxFQUFJLEdBQTFFO1NBQVY7QUFDQTtBQUFBO2FBQUEsc0NBQUE7O1lBQ0ksR0FBQSxHQUFTLEtBQUssQ0FBQyxVQUFOLENBQWlCLElBQUksQ0FBQyxJQUF0QixDQUFBLElBQStCLElBQUksQ0FBQyxJQUFLLENBQUEsQ0FBQSxDQUFWLEtBQWMsR0FBaEQsR0FBeUQsSUFBekQsR0FBbUU7WUFDekUsSUFBRyxHQUFBLEtBQU8sSUFBUCxJQUFlLElBQUksQ0FBQyxJQUFLLENBQUEsQ0FBQSxDQUFWLEtBQWdCLEdBQWxDOzZCQUNJLElBQUksQ0FBQyxJQUFMLENBQVU7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WCxJQUFHLHVFQUFIO1lBQ0ksSUFBQSxHQUFPLFFBQVEsQ0FBQyx3QkFBVCxDQUFrQztnQkFBQSxNQUFBLEVBQU8sT0FBTyxDQUFDLE9BQVEsQ0FBQSxDQUFBLENBQXZCO2dCQUEyQixJQUFBLEVBQUssVUFBaEM7YUFBbEM7WUFDUCxJQUFHLEtBQUEsQ0FBTSxJQUFOLENBQUg7QUFDSSx1QkFBTyxDQUFDLE1BQUQsaUNBQWdCLENBQUUsYUFBbEIsaUNBQStCLENBQUUsZUFBakMsRUFEWDthQUFBLE1BQUE7Z0JBR0csT0FBQSxDQUFDLEdBQUQsQ0FBSyw0QkFBTCxFQUhIO2FBRko7U0FBQSxNQUFBO1lBT0csT0FBQSxDQUFDLEdBQUQsQ0FBSywrQ0FBTCxFQUFzRCxRQUF0RCxFQVBIO1NBSEo7O1dBWUEsQ0FBQyxNQUFELEVBQVMsSUFBVCxFQUFlLElBQWY7QUF2Qkc7O0FBeUJQLE1BQU0sQ0FBQyxPQUFQLEdBQ0k7SUFBQSxJQUFBLEVBQVksSUFBWjtJQUNBLFFBQUEsRUFBWSxRQURaO0lBRUEsVUFBQSxFQUFZLFVBRlo7SUFHQSxVQUFBLEVBQVksVUFIWjtJQUlBLE1BQUEsRUFBWSxNQUpaIiwic291cmNlc0NvbnRlbnQiOlsiIyMjXG4gMDAwMDAwMCAgMDAwMDAwMDAgICAgMDAwMDAwMCAgMDAgICAgIDAwICAgMDAwMDAwMCAgIDAwMDAwMDAwICAgXG4wMDAgICAgICAgMDAwICAgMDAwICAwMDAgICAgICAgMDAwICAgMDAwICAwMDAgICAwMDAgIDAwMCAgIDAwMCAgXG4wMDAwMDAwICAgMDAwMDAwMCAgICAwMDAgICAgICAgMDAwMDAwMDAwICAwMDAwMDAwMDAgIDAwMDAwMDAwICAgXG4gICAgIDAwMCAgMDAwICAgMDAwICAwMDAgICAgICAgMDAwIDAgMDAwICAwMDAgICAwMDAgIDAwMCAgICAgICAgXG4wMDAwMDAwICAgMDAwICAgMDAwICAgMDAwMDAwMCAgMDAwICAgMDAwICAwMDAgICAwMDAgIDAwMCAgICAgICAgXG4jIyNcblxueyBmcywgdmFsaWQsIGVtcHR5LCBzbGFzaCwga2xvZywgXyB9ID0gcmVxdWlyZSAnLi9reGsnXG5cbnNvdXJjZU1hcCAgPSByZXF1aXJlICdzb3VyY2UtbWFwJ1xubWFwQ29udmVydCA9IHJlcXVpcmUgJ2NvbnZlcnQtc291cmNlLW1hcCdcblxucmVnZXgxICAgICA9IC9eXFxzK2F0XFxzKyhcXFMrKVxccytcXCgoLiopOihcXGQrKTooXFxkKylcXCkvXG5yZWdleDIgICAgID0gL15cXHMrYXRcXHMrKC4qKTooXFxkKyk6KFxcZCspL1xuXG4jIDAwMCAgICAgICAwMDAwMDAwICAgIDAwMDAwMDAgICAwMDAwMDAwMCAgMDAwMDAwMDAgICAwMDAwMDAwMCAgIFxuIyAwMDAgICAgICAwMDAgICAwMDAgIDAwMCAgICAgICAgMDAwICAgICAgIDAwMCAgIDAwMCAgMDAwICAgMDAwICBcbiMgMDAwICAgICAgMDAwICAgMDAwICAwMDAgIDAwMDAgIDAwMDAwMDAgICAwMDAwMDAwICAgIDAwMDAwMDAgICAgXG4jIDAwMCAgICAgIDAwMCAgIDAwMCAgMDAwICAgMDAwICAwMDAgICAgICAgMDAwICAgMDAwICAwMDAgICAwMDAgIFxuIyAwMDAwMDAwICAgMDAwMDAwMCAgICAwMDAwMDAwICAgMDAwMDAwMDAgIDAwMCAgIDAwMCAgMDAwICAgMDAwICBcblxubG9nRXJyID0gKGVyciwgc2VwPSfwn5KlJykgLT5cbiAgICBcbiAgICAjIGxvZyBlcnJvclN0YWNrIGVyclxuICAgIGxvZyBlcnJcbiAgICB0cmFjZSA9IGVycm9yVHJhY2UgZXJyXG4gICAgIyBjb25zb2xlLmxvZyAndHJhY2U6Jywgc3RyKHRyYWNlKVxuICAgIGlmIHZhbGlkIHRyYWNlLmxpbmVzXG4gICAgICAgIGtsb2cuZmxvZyBzdHI6dHJhY2UudGV4dCwgc291cmNlOnRyYWNlLmxpbmVzWzBdLmZpbGUsIGxpbmU6dHJhY2UubGluZXNbMF0ubGluZSwgc2VwOnNlcFxuICAgICAgICBmb3IgbGluZSBpbiB0cmFjZS5saW5lc1xuICAgICAgICAgICAgc2VwID0gaWYgc2xhc2guaXNBYnNvbHV0ZShsaW5lLmZpbGUpIG9yIGxpbmUuZmlsZVswXT09J34nIHRoZW4gJ/CfkJ4nIGVsc2UgJ/CflLwnXG4gICAgICAgICAgICBpZiBzZXAgPT0gJ/CfkJ4nIG9yIGxpbmUuZmlsZVswXSA9PSAnLidcbiAgICAgICAgICAgICAgICBrbG9nLmZsb2cgc3RyOicgICAgICAgJytsaW5lLmZ1bmMsIHNvdXJjZTpsaW5lLmZpbGUsIGxpbmU6bGluZS5saW5lLCBzZXA6c2VwXG4gICAgZWxzZVxuICAgICAgICBrbG9nLmZsb2cgc3RyOnRyYWNlLnRleHQsIHNvdXJjZTonJywgbGluZTowLCBzZXA6c2VwXG5cbiMgMDAwMDAwMDAgIDAwMCAgMDAwICAgICAgMDAwMDAwMDAgIDAwMDAwMDAwICAgIDAwMDAwMDAgICAgMDAwMDAwMCAgXG4jIDAwMCAgICAgICAwMDAgIDAwMCAgICAgIDAwMCAgICAgICAwMDAgICAwMDAgIDAwMCAgIDAwMCAgMDAwICAgICAgIFxuIyAwMDAwMDAgICAgMDAwICAwMDAgICAgICAwMDAwMDAwICAgMDAwMDAwMDAgICAwMDAgICAwMDAgIDAwMDAwMDAgICBcbiMgMDAwICAgICAgIDAwMCAgMDAwICAgICAgMDAwICAgICAgIDAwMCAgICAgICAgMDAwICAgMDAwICAgICAgIDAwMCAgXG4jIDAwMCAgICAgICAwMDAgIDAwMDAwMDAgIDAwMDAwMDAwICAwMDAgICAgICAgICAwMDAwMDAwICAgMDAwMDAwMCAgIFxuXG5maWxlUG9zID0gKGxpbmUpIC0+XG5cbiAgICBpZiBtYXRjaCA9IHJlZ2V4MS5leGVjIGxpbmVcbiAgICAgICAgXG4gICAgICAgIHJlc3VsdCA9XG4gICAgICAgICAgICBmdW5jOiBtYXRjaFsxXS5yZXBsYWNlICcuPGFub255bW91cz4nLCAnJ1xuICAgICAgICAgICAgZmlsZTogbWF0Y2hbMl1cbiAgICAgICAgICAgIGxpbmU6IG1hdGNoWzNdXG4gICAgICAgICAgICBjb2w6ICBtYXRjaFs0XVxuICAgICAgICBcbiAgICAgICAgaWYgc2xhc2guZXh0KHJlc3VsdC5maWxlKSA9PSAnanMnXG4gICAgICAgICAgICBcbiAgICAgICAgICAgIG1hcHBlZExpbmUgPSB0b0NvZmZlZSByZXN1bHQuZmlsZSwgcmVzdWx0LmxpbmUsIHJlc3VsdC5jb2xcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgaWYgbWFwcGVkTGluZT9cbiAgICAgICAgICAgICAgICByZXN1bHQuZmlsZSA9IG1hcHBlZExpbmVbMF1cbiAgICAgICAgICAgICAgICByZXN1bHQubGluZSA9IG1hcHBlZExpbmVbMV1cbiAgICAgICAgICAgICAgICByZXN1bHQuY29sICA9IG1hcHBlZExpbmVbMl1cbiAgICAgICAgICAgICAgICBcbiAgICAgICAgZWxzZSBpZiBzbGFzaC5leHQocmVzdWx0LmZpbGUpID09ICdjb2ZmZWUnIGFuZCBub3Qgc2xhc2guaXNBYnNvbHV0ZSByZXN1bHQuZmlsZVxuICAgICAgICAgICAgXG4gICAgICAgICAgICAjIHNlZW1zIGxpa2UgY2hyb21lIGlzIHJlc29sdmluZyB0byByZWxhdGl2ZSBwYXRocyBhbHJlYWR5IHdpdGhvdXQgbWFwcGluZyB0aGUgbGluZSBudW1iZXJzIGNvcnJlY3RseSA6KFxuICAgICAgICAgICAgXG4gICAgICAgICAgICAjIGNvbnNvbGUubG9nIFwiZmlsZVBvczEgbGluZTonI3tsaW5lfScgcmVzdWx0OlwiLCBzdHIgcmVzdWx0XG4gICAgICAgICAgICAjIGNvbnNvbGUubG9nICdwcm9jZXNzLmN3ZCcsIHByb2Nlc3MuY3dkKClcbiAgICAgICAgICAgICMgdHJ5XG4gICAgICAgICAgICAgICAgIyBjb25zb2xlLmxvZyAnYXBwLmdldFBhdGgoXCJleGVcIiknLCByZXF1aXJlKCdlbGVjdHJvbicpLnJlbW90ZS5hcHAuZ2V0UGF0aCAnZXhlJ1xuICAgICAgICAgICAgIyBjYXRjaCBlcnJcbiAgICAgICAgICAgICAgICAjIGNvbnNvbGUubG9nIGVyci5zdGFja1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgYWJzRmlsZSA9IHNsYXNoLnJlc29sdmUgc2xhc2guam9pbiBwcm9jZXNzLmN3ZCgpLCAnY29mZmVlJywgcmVzdWx0LmZpbGVcbiAgICAgICAgICAgIGlmIHNsYXNoLmZpbGVFeGlzdHMgYWJzRmlsZVxuICAgICAgICAgICAgICAgIFtqc0ZpbGUsYSxiXSA9IHRvSnMgYWJzRmlsZSwgMSwgMFxuICAgICAgICAgICAgICAgIGlmIHNsYXNoLmZpbGVFeGlzdHMganNGaWxlXG4gICAgICAgICAgICAgICAgICAgIFtjb2ZmZWVGaWxlLCBjb2ZmZWVMaW5lLCBjb2ZmZWVDb2xdID0gdG9Db2ZmZWUganNGaWxlLCByZXN1bHQubGluZSwgcmVzdWx0LmNvbFxuICAgICAgICAgICAgICAgICAgICBpZiBzbGFzaC5maWxlRXhpc3RzIGNvZmZlZUZpbGVcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdC5maWxlID0gY29mZmVlRmlsZSAjIHRoaXMgJ2ZpeCcgcmVsaWVzIG9uIHByb2Nlc3MuY3dkIHRvIGJlIHVuY2hhbmdlZFxuICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0LmxpbmUgPSBjb2ZmZWVMaW5lICMgYW5kIG9ubHkgd29ya3MgZm9yIGFwcCBzdGFydGVkIGZyb20gc291cmNlXG4gICAgICAgICAgICAgICAgICAgICAgICByZXN1bHQuY29sICA9IGNvZmZlZUNvbCAgIyB2aWEgbm9kZV9tb2R1bGVzL2VsZWN0cm9uLi4uIDooXG4gICAgICAgICAgICAgICAgICAgICAgICAjIHVzaW5nIGFwcC5nZXRQYXRoKFwiZXhlXCIpIGFuZCBmaWx0ZXIgb3V0IG5vZGVfbW9kdWxlcyB3b3VsZCBwcm9iYWJseSBiZSBiZXR0ZXJcbiAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgIGVsc2UgaWYgbWF0Y2ggPSByZWdleDIuZXhlYyBsaW5lXG4gICAgICAgIFxuICAgICAgICByZXN1bHQgPVxuICAgICAgICAgICAgZnVuYzogc2xhc2guZmlsZSBtYXRjaFsxXVxuICAgICAgICAgICAgZmlsZTogbWF0Y2hbMV1cbiAgICAgICAgICAgIGxpbmU6IG1hdGNoWzJdXG4gICAgICAgICAgICBjb2w6ICBtYXRjaFszXVxuICAgICAgICBcbiAgICAgICAgaWYgc2xhc2guZXh0KHJlc3VsdC5maWxlKSA9PSAnanMnXG4gICAgICAgICAgICBcbiAgICAgICAgICAgIG1hcHBlZExpbmUgPSB0b0NvZmZlZSByZXN1bHQuZmlsZSwgcmVzdWx0LmxpbmUsIHJlc3VsdC5jb2xcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgaWYgbWFwcGVkTGluZT9cbiAgICAgICAgICAgICAgICByZXN1bHQuZmlsZSA9IG1hcHBlZExpbmVbMF1cbiAgICAgICAgICAgICAgICByZXN1bHQubGluZSA9IG1hcHBlZExpbmVbMV1cbiAgICAgICAgICAgICAgICByZXN1bHQuY29sICA9IG1hcHBlZExpbmVbMl1cbiAgICAgICAgICAgICAgICBcbiAgICAgICAgIyBlbHNlIGlmIHNsYXNoLmV4dChyZXN1bHQuZmlsZSkgPT0gJ2NvZmZlZScgYW5kIG5vdCBzbGFzaC5pc0Fic29sdXRlIHJlc3VsdC5maWxlICAgICAgICAgICAgICAgIFxuIyAgICAgICAgICAgICBcbiAgICAgICAgICAgICMgY29uc29sZS5sb2cgXCJmaWxlUG9zMiBGSVhNRSFcIiwgbGluZSwgcmVzdWx0XG4gICAgICAgICAgICBcbiAgICByZXN1bHRcblxuIyAgMDAwMDAwMCAgMDAwMDAwMDAwICAgMDAwMDAwMCAgICAwMDAwMDAwICAwMDAgICAwMDAgIFxuIyAwMDAgICAgICAgICAgMDAwICAgICAwMDAgICAwMDAgIDAwMCAgICAgICAwMDAgIDAwMCAgIFxuIyAwMDAwMDAwICAgICAgMDAwICAgICAwMDAwMDAwMDAgIDAwMCAgICAgICAwMDAwMDAwICAgIFxuIyAgICAgIDAwMCAgICAgMDAwICAgICAwMDAgICAwMDAgIDAwMCAgICAgICAwMDAgIDAwMCAgIFxuIyAwMDAwMDAwICAgICAgMDAwICAgICAwMDAgICAwMDAgICAwMDAwMDAwICAwMDAgICAwMDAgIFxuXG5lcnJvclN0YWNrID0gKGVycikgLT5cbiAgICBcbiAgICBsaW5lcyA9IFtdXG4gICAgXG4gICAgZm9yIHN0YWNrTGluZSBpbiBlcnIuc3RhY2suc3BsaXQgJ1xcbicgXG4gICAgICAgIFxuICAgICAgICBpZiBmcCA9IGZpbGVQb3Mgc3RhY2tMaW5lXG4gICAgICAgICAgICBsaW5lcy5wdXNoIFwiICAgICAgICN7Xy5wYWRFbmQgZnAuZnVuYywgMzB9ICN7ZnAuZmlsZX06I3tmcC5saW5lfVwiIFxuICAgICAgICBlbHNlXG4gICAgICAgICAgICBsaW5lcy5wdXNoIHN0YWNrTGluZSBcblxuICBcbiAgICBsaW5lcy5qb2luICdcXG4nXG5cbiMgMDAwMDAwMDAwICAwMDAwMDAwMCAgICAwMDAwMDAwICAgIDAwMDAwMDAgIDAwMDAwMDAwICBcbiMgICAgMDAwICAgICAwMDAgICAwMDAgIDAwMCAgIDAwMCAgMDAwICAgICAgIDAwMCAgICAgICBcbiMgICAgMDAwICAgICAwMDAwMDAwICAgIDAwMDAwMDAwMCAgMDAwICAgICAgIDAwMDAwMDAgICBcbiMgICAgMDAwICAgICAwMDAgICAwMDAgIDAwMCAgIDAwMCAgMDAwICAgICAgIDAwMCAgICAgICBcbiMgICAgMDAwICAgICAwMDAgICAwMDAgIDAwMCAgIDAwMCAgIDAwMDAwMDAgIDAwMDAwMDAwICBcblxuZXJyb3JUcmFjZSA9IChlcnIpIC0+XG4gICAgXG4gICAgbGluZXMgPSBbXVxuICAgIHRleHQgID0gW11cblxuICAgIGZvciBzdGFja0xpbmUgaW4gZXJyLnN0YWNrLnNwbGl0ICdcXG4nIFxuICAgICAgICBcbiAgICAgICAgaWYgZnAgPSBmaWxlUG9zIHN0YWNrTGluZVxuICAgICAgICAgICAgbGluZXMucHVzaCBmcFxuICAgICAgICBlbHNlXG4gICAgICAgICAgICB0ZXh0LnB1c2ggc3RhY2tMaW5lIFxuXG4gIFxuICAgIGxpbmVzOiAgbGluZXNcbiAgICB0ZXh0OiAgIHRleHQuam9pbiAnXFxuJ1xuICAgIFxuIyAwMDAwMDAwMDAgICAwMDAwMDAwICAgICAgICAgIDAwMDAwMDAgICAwMDAwMDAwICAgMDAwMDAwMDAgIDAwMDAwMDAwICAwMDAwMDAwMCAgMDAwMDAwMDAgIFxuIyAgICAwMDAgICAgIDAwMCAgIDAwMCAgICAgICAgMDAwICAgICAgIDAwMCAgIDAwMCAgMDAwICAgICAgIDAwMCAgICAgICAwMDAgICAgICAgMDAwICAgICAgIFxuIyAgICAwMDAgICAgIDAwMCAgIDAwMCAgICAgICAgMDAwICAgICAgIDAwMCAgIDAwMCAgMDAwMDAwICAgIDAwMDAwMCAgICAwMDAwMDAwICAgMDAwMDAwMCAgIFxuIyAgICAwMDAgICAgIDAwMCAgIDAwMCAgICAgICAgMDAwICAgICAgIDAwMCAgIDAwMCAgMDAwICAgICAgIDAwMCAgICAgICAwMDAgICAgICAgMDAwICAgICAgIFxuIyAgICAwMDAgICAgICAwMDAwMDAwICAgICAgICAgIDAwMDAwMDAgICAwMDAwMDAwICAgMDAwICAgICAgIDAwMCAgICAgICAwMDAwMDAwMCAgMDAwMDAwMDAgIFxuXG50b0NvZmZlZSA9IChqc0ZpbGUsIGpzTGluZSwganNDb2w9MCkgLT5cblxuICAgIGpzTGluZSA9IHBhcnNlSW50IGpzTGluZVxuICAgIGpzQ29sICA9IHBhcnNlSW50IGpzQ29sXG4gICAgXG4gICAgY29mZmVlRmlsZSA9IHNsYXNoLnRpbGRlIGpzRmlsZVxuICAgIGNvZmZlZUxpbmUgPSBqc0xpbmVcbiAgICBjb2ZmZWVDb2wgID0ganNDb2xcbiAgICAgICAgXG4gICAgaWYgc2xhc2guZmlsZUV4aXN0cyBqc0ZpbGVcbiAgICAgICAgbWFwRGF0YSA9IG1hcENvbnZlcnQuZnJvbVNvdXJjZShmcy5yZWFkRmlsZVN5bmMganNGaWxlLCAndXRmOCcpPy50b09iamVjdCgpXG4gICAgICAgIGlmIHZhbGlkIG1hcERhdGFcbiAgICAgICAgICAgIG1hcERhdGEuc291cmNlc1swXSA9IHNsYXNoLnJlc29sdmUgc2xhc2guam9pbiBzbGFzaC5kaXIoanNGaWxlKSwgbWFwRGF0YT8uc291cmNlc1swXSBpZiBtYXBEYXRhPy5zb3VyY2VzWzBdXG4gICAgICAgICAgICBjb25zdW1lciA9IG5ldyBzb3VyY2VNYXAuU291cmNlTWFwQ29uc3VtZXIgbWFwRGF0YVxuICAgICAgICAgICAgaWYgY29uc3VtZXIub3JpZ2luYWxQb3NpdGlvbkZvclxuICAgICAgICAgICAgICAgIHBvcyA9IGNvbnN1bWVyLm9yaWdpbmFsUG9zaXRpb25Gb3IgbGluZTpqc0xpbmUsIGNvbHVtbjpqc0NvbCwgYmlhczpzb3VyY2VNYXAuU291cmNlTWFwQ29uc3VtZXIuTEVBU1RfVVBQRVJfQk9VTkRcbiAgICAgICAgICAgICAgICBpZiB2YWxpZChwb3MubGluZSkgYW5kIHZhbGlkKHBvcy5jb2x1bW4pXG4gICAgICAgICAgICAgICAgICAgIGNvZmZlZUZpbGUgPSBzbGFzaC50aWxkZSBtYXBEYXRhLnNvdXJjZXNbMF1cbiAgICAgICAgICAgICAgICAgICAgY29mZmVlTGluZSA9IHBvcy5saW5lIFxuICAgICAgICAgICAgICAgICAgICBjb2ZmZWVDb2wgID0gcG9zLmNvbHVtblxuICAgICAgICAgICAgICAgIGVsc2VcbiAgICAgICAgICAgICAgICAgICAga2xvZyAnbm8gcG9zLmxpbmUnLCBwb3NcbiAgICAgICAgICAgIGVsc2VcbiAgICAgICAgICAgICAgICBrbG9nICdubyBjb25zdW1lciBvcmlnaW5hbFBvc2l0aW9uRm9yJywgbWFwRGF0YT8sIGNvbnN1bWVyP1xuICAgICAgICBcbiAgICBbY29mZmVlRmlsZSwgY29mZmVlTGluZSwgY29mZmVlQ29sXVxuXG4jIDAwMDAwMDAwMCAgIDAwMDAwMDAgICAgICAgICAgICAgICAwMDAgICAwMDAwMDAwICBcbiMgICAgMDAwICAgICAwMDAgICAwMDAgICAgICAgICAgICAgIDAwMCAgMDAwICAgICAgIFxuIyAgICAwMDAgICAgIDAwMCAgIDAwMCAgICAgICAgICAgICAgMDAwICAwMDAwMDAwICAgXG4jICAgIDAwMCAgICAgMDAwICAgMDAwICAgICAgICAwMDAgICAwMDAgICAgICAgMDAwICBcbiMgICAgMDAwICAgICAgMDAwMDAwMCAgICAgICAgICAwMDAwMDAwICAgMDAwMDAwMCAgIFxuXG50b0pzID0gKGNvZmZlZUZpbGUsIGNvZmZlZUxpbmUsIGNvZmZlZUNvbD0wKSAtPlxuICAgIFxuICAgIGpzRmlsZSA9IGNvZmZlZUZpbGUucmVwbGFjZSAvXFwvY29mZmVlXFwvLywgJy9qcy8nXG4gICAganNGaWxlID0ganNGaWxlLnJlcGxhY2UgL1xcLmNvZmZlZSQvLCAnLmpzJ1xuICAgIFxuICAgIGlmIG5vdCBzbGFzaC5maWxlRXhpc3RzIGpzRmlsZVxuICAgICAgICByZXR1cm4gW251bGwsIG51bGwsIG51bGxdXG4gICAgICAgIFxuICAgIGlmIG5vdCBjb2ZmZWVMaW5lPyB0aGVuIHJldHVybiBqc0ZpbGVcbiAgICBcbiAgICBtYXBEYXRhID0gbWFwQ29udmVydC5mcm9tU291cmNlKGZzLnJlYWRGaWxlU3luYyBqc0ZpbGUsICd1dGY4Jyk/LnRvT2JqZWN0KClcbiAgICBpZiB2YWxpZCBtYXBEYXRhXG4gICAgICAgIG1hcERhdGEuc291cmNlc1swXSA9IHNsYXNoLnJlc29sdmUgc2xhc2guam9pbiBzbGFzaC5kaXIoanNGaWxlKSwgbWFwRGF0YT8uc291cmNlc1swXSBpZiBtYXBEYXRhPy5zb3VyY2VzWzBdXG4gICAgICAgIGNvbnN1bWVyID0gbmV3IHNvdXJjZU1hcC5Tb3VyY2VNYXBDb25zdW1lciBtYXBEYXRhXG4gICAgICAgIGlmIGNvbnN1bWVyPy5hbGxHZW5lcmF0ZWRQb3NpdGlvbnNGb3I/XG4gICAgICAgICAgICBwb3NzID0gY29uc3VtZXIuYWxsR2VuZXJhdGVkUG9zaXRpb25zRm9yIHNvdXJjZTptYXBEYXRhLnNvdXJjZXNbMF0sIGxpbmU6Y29mZmVlTGluZSMsIGNvbHVtbjpjb2ZmZWVDb2xcbiAgICAgICAgICAgIGlmIHZhbGlkIHBvc3NcbiAgICAgICAgICAgICAgICByZXR1cm4gW2pzRmlsZSwgcG9zc1swXT8ubGluZSwgcG9zc1swXT8uY29sdW1uXVxuICAgICAgICAgICAgZWxzZVxuICAgICAgICAgICAgICAgIGxvZyAnc3JjbWFwLnRvSnMgLS0gZW1wdHkgcG9zcyEnXG4gICAgICAgIGVsc2VcbiAgICAgICAgICAgIGxvZyAnc3JjbWFwLnRvSnMgLS0gbm8gYWxsR2VuZXJhdGVkUG9zaXRpb25zRm9yIGluJywgY29uc3VtZXJcbiAgICAgICAgXG4gICAgW2pzRmlsZSwgbnVsbCwgbnVsbF1cbiAgICAgICAgXG5tb2R1bGUuZXhwb3J0cyA9XG4gICAgdG9KczogICAgICAgdG9Kc1xuICAgIHRvQ29mZmVlOiAgIHRvQ29mZmVlXG4gICAgZXJyb3JTdGFjazogZXJyb3JTdGFja1xuICAgIGVycm9yVHJhY2U6IGVycm9yVHJhY2VcbiAgICBsb2dFcnI6ICAgICBsb2dFcnJcbiAgICBcbiAgICAiXX0=
//# sourceURL=../coffee/srcmap.coffee