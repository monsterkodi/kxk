// koffee 1.7.0

/*
 0000000  00000000    0000000  00     00   0000000   00000000   
000       000   000  000       000   000  000   000  000   000  
0000000   0000000    000       000000000  000000000  00000000   
     000  000   000  000       000 0 000  000   000  000        
0000000   000   000   0000000  000   000  000   000  000
 */
var _, empty, errorStack, errorTrace, filePos, klog, logErr, mapConvert, ref, regex1, regex2, slash, sourceMap, toCoffee, toJs, valid;

ref = require('./kxk'), _ = ref._, empty = ref.empty, klog = ref.klog, slash = ref.slash, valid = ref.valid;

sourceMap = require('source-map');

mapConvert = require('convert-source-map');

regex1 = /^\s+at\s+(\S+)\s+\((.*):(\d+):(\d+)\)/;

regex2 = /^\s+at\s+(.*):(\d+):(\d+)/;

logErr = function(err, sep) {
    var i, len, line, ref1, results, trace;
    if (sep == null) {
        sep = 'ðŸ’¥';
    }
    console.log(err);
    trace = errorTrace(err);
    if (valid(trace.lines)) {
        klog.flog({
            str: trace.text,
            source: trace.lines[0].file,
            line: trace.lines[0].line,
            sep: sep
        });
        ref1 = trace.lines;
        results = [];
        for (i = 0, len = ref1.length; i < len; i++) {
            line = ref1[i];
            sep = slash.isAbsolute(line.file) || line.file[0] === '~' ? 'ðŸž' : 'ðŸ”¼';
            if (sep === 'ðŸž' || line.file[0] === '.') {
                results.push(klog.flog({
                    str: '       ' + line.func,
                    source: line.file,
                    line: line.line,
                    sep: sep
                }));
            } else {
                results.push(void 0);
            }
        }
        return results;
    } else {
        return klog.flog({
            str: trace.text,
            source: '',
            line: 0,
            sep: sep
        });
    }
};

filePos = function(line) {
    var a, absFile, b, coffeeCol, coffeeFile, coffeeLine, jsFile, mappedLine, match, ref1, ref2, result;
    if (match = regex1.exec(line)) {
        result = {
            func: match[1].replace('.<anonymous>', ''),
            file: match[2],
            line: match[3],
            col: match[4]
        };
        if (slash.ext(result.file) === 'js') {
            mappedLine = toCoffee(result.file, result.line, result.col);
            if (mappedLine != null) {
                result.file = mappedLine[0];
                result.line = mappedLine[1];
                result.col = mappedLine[2];
            }
        } else if (slash.ext(result.file) === 'coffee' && !slash.isAbsolute(result.file)) {
            absFile = slash.resolve(slash.join(process.cwd(), 'coffee', result.file));
            if (slash.fileExists(absFile)) {
                ref1 = toJs(absFile, 1, 0), jsFile = ref1[0], a = ref1[1], b = ref1[2];
                if (slash.fileExists(jsFile)) {
                    ref2 = toCoffee(jsFile, result.line, result.col), coffeeFile = ref2[0], coffeeLine = ref2[1], coffeeCol = ref2[2];
                    if (slash.fileExists(coffeeFile)) {
                        result.file = coffeeFile;
                        result.line = coffeeLine;
                        result.col = coffeeCol;
                    }
                }
            }
        }
    } else if (match = regex2.exec(line)) {
        result = {
            func: slash.file(match[1]),
            file: match[1],
            line: match[2],
            col: match[3]
        };
        if (slash.ext(result.file) === 'js') {
            mappedLine = toCoffee(result.file, result.line, result.col);
            if (mappedLine != null) {
                result.file = mappedLine[0];
                result.line = mappedLine[1];
                result.col = mappedLine[2];
            }
        }
    }
    return result;
};

errorStack = function(err) {
    var fp, i, len, lines, ref1, stackLine;
    lines = [];
    ref1 = err.stack.split('\n');
    for (i = 0, len = ref1.length; i < len; i++) {
        stackLine = ref1[i];
        if (fp = filePos(stackLine)) {
            lines.push("       " + (_.padEnd(fp.func, 30)) + " " + fp.file + ":" + fp.line);
        } else {
            lines.push(stackLine);
        }
    }
    return lines.join('\n');
};

errorTrace = function(err) {
    var fp, i, len, lines, ref1, stackLine, text;
    lines = [];
    text = [];
    ref1 = err.stack.split('\n');
    for (i = 0, len = ref1.length; i < len; i++) {
        stackLine = ref1[i];
        if (fp = filePos(stackLine)) {
            lines.push(fp);
        } else {
            text.push(stackLine);
        }
    }
    return {
        lines: lines,
        text: text.join('\n')
    };
};

toCoffee = function(jsFile, jsLine, jsCol) {
    var coffeeCol, coffeeFile, coffeeLine, consumer, mapData, pos, ref1;
    if (jsCol == null) {
        jsCol = 0;
    }
    jsLine = parseInt(jsLine);
    jsCol = parseInt(jsCol);
    coffeeFile = jsFile.replace(/\/js\//, '/coffee/');
    coffeeFile = coffeeFile.replace(/\.js$/, '.coffee');
    coffeeLine = jsLine;
    coffeeCol = jsCol;
    if (slash.fileExists(jsFile)) {
        mapData = (ref1 = mapConvert.fromSource(slash.readText(jsFile))) != null ? ref1.toObject() : void 0;
        if (empty(mapData.sources[0])) {
            mapData.sources[0] = coffeeFile;
        }
        if (valid(mapData)) {
            consumer = new sourceMap.SourceMapConsumer(mapData);
            if (consumer.originalPositionFor) {
                pos = consumer.originalPositionFor({
                    line: jsLine,
                    column: jsCol,
                    bias: sourceMap.SourceMapConsumer.LEAST_UPPER_BOUND
                });
                if (valid(pos.line) && valid(pos.column)) {
                    coffeeFile = slash.tilde(mapData.sources[0]);
                    coffeeLine = pos.line;
                    coffeeCol = pos.column;
                } else {
                    klog('invalid line.column');
                }
            } else {
                klog('no consumer originalPositionFor', mapData != null, consumer != null);
            }
        }
    } else {
        klog("no jsFile " + jsFile);
    }
    return [coffeeFile, coffeeLine, coffeeCol];
};

toJs = function(coffeeFile, coffeeLine, coffeeCol) {
    var consumer, jsFile, mapData, poss, ref1, ref2, ref3;
    if (coffeeCol == null) {
        coffeeCol = 0;
    }
    jsFile = coffeeFile.replace(/\/coffee\//, '/js/');
    jsFile = jsFile.replace(/\.coffee$/, '.js');
    if (!slash.fileExists(jsFile)) {
        return [null, null, null];
    }
    if (coffeeLine == null) {
        return [jsFile, null, null];
    }
    mapData = (ref1 = mapConvert.fromSource(slash.readText(jsFile))) != null ? ref1.toObject() : void 0;
    if (empty(mapData.sources[0])) {
        mapData.sources[0] = coffeeFile;
    }
    if (valid(mapData)) {
        consumer = new sourceMap.SourceMapConsumer(mapData);
        if ((consumer != null ? consumer.allGeneratedPositionsFor : void 0) != null) {
            poss = consumer.allGeneratedPositionsFor({
                source: mapData.sources[0],
                line: coffeeLine,
                column: coffeeCol
            });
            if (valid(poss)) {
                return [jsFile, (ref2 = poss[0]) != null ? ref2.line : void 0, (ref3 = poss[0]) != null ? ref3.column : void 0];
            } else {
                console.log('srcmap.toJs -- empty poss!', mapData.sources[0]);
            }
        } else {
            console.log('srcmap.toJs -- no allGeneratedPositionsFor in', consumer);
        }
    }
    return [jsFile, null, null];
};

module.exports = {
    toJs: toJs,
    toCoffee: toCoffee,
    errorStack: errorStack,
    errorTrace: errorTrace,
    logErr: logErr
};

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic3JjbWFwLmpzIiwic291cmNlUm9vdCI6Ii4iLCJzb3VyY2VzIjpbIiJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOztBQUFBOzs7Ozs7O0FBQUEsSUFBQTs7QUFRQSxNQUFtQyxPQUFBLENBQVEsT0FBUixDQUFuQyxFQUFFLFNBQUYsRUFBSyxpQkFBTCxFQUFZLGVBQVosRUFBa0IsaUJBQWxCLEVBQXlCOztBQUV6QixTQUFBLEdBQWEsT0FBQSxDQUFRLFlBQVI7O0FBQ2IsVUFBQSxHQUFhLE9BQUEsQ0FBUSxvQkFBUjs7QUFFYixNQUFBLEdBQWE7O0FBQ2IsTUFBQSxHQUFhOztBQVFiLE1BQUEsR0FBUyxTQUFDLEdBQUQsRUFBTSxHQUFOO0FBR04sUUFBQTs7UUFIWSxNQUFJOztJQUdoQixPQUFBLENBQUMsR0FBRCxDQUFLLEdBQUw7SUFDQyxLQUFBLEdBQVEsVUFBQSxDQUFXLEdBQVg7SUFFUixJQUFHLEtBQUEsQ0FBTSxLQUFLLENBQUMsS0FBWixDQUFIO1FBQ0ksSUFBSSxDQUFDLElBQUwsQ0FBVTtZQUFBLEdBQUEsRUFBSSxLQUFLLENBQUMsSUFBVjtZQUFnQixNQUFBLEVBQU8sS0FBSyxDQUFDLEtBQU0sQ0FBQSxDQUFBLENBQUUsQ0FBQyxJQUF0QztZQUE0QyxJQUFBLEVBQUssS0FBSyxDQUFDLEtBQU0sQ0FBQSxDQUFBLENBQUUsQ0FBQyxJQUFoRTtZQUFzRSxHQUFBLEVBQUksR0FBMUU7U0FBVjtBQUNBO0FBQUE7YUFBQSxzQ0FBQTs7WUFDSSxHQUFBLEdBQVMsS0FBSyxDQUFDLFVBQU4sQ0FBaUIsSUFBSSxDQUFDLElBQXRCLENBQUEsSUFBK0IsSUFBSSxDQUFDLElBQUssQ0FBQSxDQUFBLENBQVYsS0FBYyxHQUFoRCxHQUF5RCxJQUF6RCxHQUFtRTtZQUN6RSxJQUFHLEdBQUEsS0FBTyxJQUFQLElBQWUsSUFBSSxDQUFDLElBQUssQ0FBQSxDQUFBLENBQVYsS0FBZ0IsR0FBbEM7NkJBQ0ksSUFBSSxDQUFDLElBQUwsQ0FBVTtvQkFBQSxHQUFBLEVB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Q0FBQSxDQUFBLENBQXZCO2dCQUEyQixJQUFBLEVBQUssVUFBaEM7Z0JBQTRDLE1BQUEsRUFBTyxTQUFuRDthQUFsQztZQUNQLElBQUcsS0FBQSxDQUFNLElBQU4sQ0FBSDtBQUNJLHVCQUFPLENBQUMsTUFBRCxpQ0FBZ0IsQ0FBRSxhQUFsQixpQ0FBK0IsQ0FBRSxlQUFqQyxFQURYO2FBQUEsTUFBQTtnQkFHRyxPQUFBLENBQUMsR0FBRCxDQUFLLDRCQUFMLEVBQWtDLE9BQU8sQ0FBQyxPQUFRLENBQUEsQ0FBQSxDQUFsRCxFQUhIO2FBRko7U0FBQSxNQUFBO1lBT0csT0FBQSxDQUFDLEdBQUQsQ0FBSywrQ0FBTCxFQUFxRCxRQUFyRCxFQVBIO1NBRko7O1dBV0EsQ0FBQyxNQUFELEVBQVMsSUFBVCxFQUFlLElBQWY7QUF4Qkc7O0FBMEJQLE1BQU0sQ0FBQyxPQUFQLEdBQ0k7SUFBQSxJQUFBLEVBQVksSUFBWjtJQUNBLFFBQUEsRUFBWSxRQURaO0lBRUEsVUFBQSxFQUFZLFVBRlo7SUFHQSxVQUFBLEVBQVksVUFIWjtJQUlBLE1BQUEsRUFBWSxNQUpaIiwic291cmNlc0NvbnRlbnQiOlsiIyMjXG4gMDAwMDAwMCAgMDAwMDAwMDAgICAgMDAwMDAwMCAgMDAgICAgIDAwICAgMDAwMDAwMCAgIDAwMDAwMDAwICAgXG4wMDAgICAgICAgMDAwICAgMDAwICAwMDAgICAgICAgMDAwICAgMDAwICAwMDAgICAwMDAgIDAwMCAgIDAwMCAgXG4wMDAwMDAwICAgMDAwMDAwMCAgICAwMDAgICAgICAgMDAwMDAwMDAwICAwMDAwMDAwMDAgIDAwMDAwMDAwICAgXG4gICAgIDAwMCAgMDAwICAgMDAwICAwMDAgICAgICAgMDAwIDAgMDAwICAwMDAgICAwMDAgIDAwMCAgICAgICAgXG4wMDAwMDAwICAgMDAwICAgMDAwICAgMDAwMDAwMCAgMDAwICAgMDAwICAwMDAgICAwMDAgIDAwMCAgICAgICAgXG4jIyNcblxueyBfLCBlbXB0eSwga2xvZywgc2xhc2gsIHZhbGlkIH0gPSByZXF1aXJlICcuL2t4aydcblxuc291cmNlTWFwICA9IHJlcXVpcmUgJ3NvdXJjZS1tYXAnXG5tYXBDb252ZXJ0ID0gcmVxdWlyZSAnY29udmVydC1zb3VyY2UtbWFwJ1xuXG5yZWdleDEgICAgID0gL15cXHMrYXRcXHMrKFxcUyspXFxzK1xcKCguKik6KFxcZCspOihcXGQrKVxcKS9cbnJlZ2V4MiAgICAgPSAvXlxccythdFxccysoLiopOihcXGQrKTooXFxkKykvXG5cbiMgMDAwICAgICAgIDAwMDAwMDAgICAgMDAwMDAwMCAgIDAwMDAwMDAwICAwMDAwMDAwMCAgIDAwMDAwMDAwICAgXG4jIDAwMCAgICAgIDAwMCAgIDAwMCAgMDAwICAgICAgICAwMDAgICAgICAgMDAwICAgMDAwICAwMDAgICAwMDAgIFxuIyAwMDAgICAgICAwMDAgICAwMDAgIDAwMCAgMDAwMCAgMDAwMDAwMCAgIDAwMDAwMDAgICAgMDAwMDAwMCAgICBcbiMgMDAwICAgICAgMDAwICAgMDAwICAwMDAgICAwMDAgIDAwMCAgICAgICAwMDAgICAwMDAgIDAwMCAgIDAwMCAgXG4jIDAwMDAwMDAgICAwMDAwMDAwICAgIDAwMDAwMDAgICAwMDAwMDAwMCAgMDAwICAgMDAwICAwMDAgICAwMDAgIFxuXG5sb2dFcnIgPSAoZXJyLCBzZXA9J/CfkqUnKSAtPlxuICAgIFxuICAgICMgbG9nIGVycm9yU3RhY2sgZXJyXG4gICAgbG9nIGVyclxuICAgIHRyYWNlID0gZXJyb3JUcmFjZSBlcnJcbiAgICAjIGNvbnNvbGUubG9nICd0cmFjZTonLCBzdHIodHJhY2UpXG4gICAgaWYgdmFsaWQgdHJhY2UubGluZXNcbiAgICAgICAga2xvZy5mbG9nIHN0cjp0cmFjZS50ZXh0LCBzb3VyY2U6dHJhY2UubGluZXNbMF0uZmlsZSwgbGluZTp0cmFjZS5saW5lc1swXS5saW5lLCBzZXA6c2VwXG4gICAgICAgIGZvciBsaW5lIGluIHRyYWNlLmxpbmVzXG4gICAgICAgICAgICBzZXAgPSBpZiBzbGFzaC5pc0Fic29sdXRlKGxpbmUuZmlsZSkgb3IgbGluZS5maWxlWzBdPT0nficgdGhlbiAn8J+QnicgZWxzZSAn8J+UvCdcbiAgICAgICAgICAgIGlmIHNlcCA9PSAn8J+Qnicgb3IgbGluZS5maWxlWzBdID09ICcuJ1xuICAgICAgICAgICAgICAgIGtsb2cuZmxvZyBzdHI6JyAgICAgICAnK2xpbmUuZnVuYywgc291cmNlOmxpbmUuZmlsZSwgbGluZTpsaW5lLmxpbmUsIHNlcDpzZXBcbiAgICBlbHNlXG4gICAgICAgIGtsb2cuZmxvZyBzdHI6dHJhY2UudGV4dCwgc291cmNlOicnLCBsaW5lOjAsIHNlcDpzZXBcblxuIyAwMDAwMDAwMCAgMDAwICAwMDAgICAgICAwMDAwMDAwMCAgMDAwMDAwMDAgICAgMDAwMDAwMCAgICAwMDAwMDAwICBcbiMgMDAwICAgICAgIDAwMCAgMDAwICAgICAgMDAwICAgICAgIDAwMCAgIDAwMCAgMDAwICAgMDAwICAwMDAgICAgICAgXG4jIDAwMDAwMCAgICAwMDAgIDAwMCAgICAgIDAwMDAwMDAgICAwMDAwMDAwMCAgIDAwMCAgIDAwMCAgMDAwMDAwMCAgIFxuIyAwMDAgICAgICAgMDAwICAwMDAgICAgICAwMDAgICAgICAgMDAwICAgICAgICAwMDAgICAwMDAgICAgICAgMDAwICBcbiMgMDAwICAgICAgIDAwMCAgMDAwMDAwMCAgMDAwMDAwMDAgIDAwMCAgICAgICAgIDAwMDAwMDAgICAwMDAwMDAwICAgXG5cbmZpbGVQb3MgPSAobGluZSkgLT5cblxuICAgIGlmIG1hdGNoID0gcmVnZXgxLmV4ZWMgbGluZVxuICAgICAgICBcbiAgICAgICAgcmVzdWx0ID1cbiAgICAgICAgICAgIGZ1bmM6IG1hdGNoWzFdLnJlcGxhY2UgJy48YW5vbnltb3VzPicsICcnXG4gICAgICAgICAgICBmaWxlOiBtYXRjaFsyXVxuICAgICAgICAgICAgbGluZTogbWF0Y2hbM11cbiAgICAgICAgICAgIGNvbDogIG1hdGNoWzRdXG4gICAgICAgIFxuICAgICAgICBpZiBzbGFzaC5leHQocmVzdWx0LmZpbGUpID09ICdqcydcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgbWFwcGVkTGluZSA9IHRvQ29mZmVlIHJlc3VsdC5maWxlLCByZXN1bHQubGluZSwgcmVzdWx0LmNvbFxuICAgICAgICAgICAgXG4gICAgICAgICAgICBpZiBtYXBwZWRMaW5lP1xuICAgICAgICAgICAgICAgIHJlc3VsdC5maWxlID0gbWFwcGVkTGluZVswXVxuICAgICAgICAgICAgICAgIHJlc3VsdC5saW5lID0gbWFwcGVkTGluZVsxXVxuICAgICAgICAgICAgICAgIHJlc3VsdC5jb2wgID0gbWFwcGVkTGluZVsyXVxuICAgICAgICAgICAgICAgIFxuICAgICAgICBlbHNlIGlmIHNsYXNoLmV4dChyZXN1bHQuZmlsZSkgPT0gJ2NvZmZlZScgYW5kIG5vdCBzbGFzaC5pc0Fic29sdXRlIHJlc3VsdC5maWxlXG4gICAgICAgICAgICBcbiAgICAgICAgICAgICMgc2VlbXMgbGlrZSBjaHJvbWUgaXMgcmVzb2x2aW5nIHRvIHJlbGF0aXZlIHBhdGhzIGFscmVhZHkgd2l0aG91dCBtYXBwaW5nIHRoZSBsaW5lIG51bWJlcnMgY29ycmVjdGx5IDooXG4gICAgICAgICAgICBcbiAgICAgICAgICAgICMgY29uc29sZS5sb2cgXCJmaWxlUG9zMSBsaW5lOicje2xpbmV9JyByZXN1bHQ6XCIsIHN0ciByZXN1bHRcbiAgICAgICAgICAgICMgY29uc29sZS5sb2cgJ3Byb2Nlc3MuY3dkJywgcHJvY2Vzcy5jd2QoKVxuICAgICAgICAgICAgIyB0cnlcbiAgICAgICAgICAgICAgICAjIGNvbnNvbGUubG9nICdhcHAuZ2V0UGF0aChcImV4ZVwiKScsIHJlcXVpcmUoJ2VsZWN0cm9uJykucmVtb3RlLmFwcC5nZXRQYXRoICdleGUnXG4gICAgICAgICAgICAjIGNhdGNoIGVyclxuICAgICAgICAgICAgICAgICMgY29uc29sZS5sb2cgZXJyLnN0YWNrXG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICBhYnNGaWxlID0gc2xhc2gucmVzb2x2ZSBzbGFzaC5qb2luIHByb2Nlc3MuY3dkKCksICdjb2ZmZWUnLCByZXN1bHQuZmlsZVxuICAgICAgICAgICAgaWYgc2xhc2guZmlsZUV4aXN0cyBhYnNGaWxlXG4gICAgICAgICAgICAgICAgW2pzRmlsZSxhLGJdID0gdG9KcyBhYnNGaWxlLCAxLCAwXG4gICAgICAgICAgICAgICAgaWYgc2xhc2guZmlsZUV4aXN0cyBqc0ZpbGVcbiAgICAgICAgICAgICAgICAgICAgW2NvZmZlZUZpbGUsIGNvZmZlZUxpbmUsIGNvZmZlZUNvbF0gPSB0b0NvZmZlZSBqc0ZpbGUsIHJlc3VsdC5saW5lLCByZXN1bHQuY29sXG4gICAgICAgICAgICAgICAgICAgIGlmIHNsYXNoLmZpbGVFeGlzdHMgY29mZmVlRmlsZVxuICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0LmZpbGUgPSBjb2ZmZWVGaWxlICMgdGhpcyAnZml4JyByZWxpZXMgb24gcHJvY2Vzcy5jd2QgdG8gYmUgdW5jaGFuZ2VkXG4gICAgICAgICAgICAgICAgICAgICAgICByZXN1bHQubGluZSA9IGNvZmZlZUxpbmUgIyBhbmQgb25seSB3b3JrcyBmb3IgYXBwIHN0YXJ0ZWQgZnJvbSBzb3VyY2VcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdC5jb2wgID0gY29mZmVlQ29sICAjIHZpYSBub2RlX21vZHVsZXMvZWxlY3Ryb24uLi4gOihcbiAgICAgICAgICAgICAgICAgICAgICAgICMgdXNpbmcgYXBwLmdldFBhdGgoXCJleGVcIikgYW5kIGZpbHRlciBvdXQgbm9kZV9tb2R1bGVzIHdvdWxkIHByb2JhYmx5IGJlIGJldHRlclxuICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgZWxzZSBpZiBtYXRjaCA9IHJlZ2V4Mi5leGVjIGxpbmVcbiAgICAgICAgXG4gICAgICAgIHJlc3VsdCA9XG4gICAgICAgICAgICBmdW5jOiBzbGFzaC5maWxlIG1hdGNoWzFdXG4gICAgICAgICAgICBmaWxlOiBtYXRjaFsxXVxuICAgICAgICAgICAgbGluZTogbWF0Y2hbMl1cbiAgICAgICAgICAgIGNvbDogIG1hdGNoWzNdXG4gICAgICAgIFxuICAgICAgICBpZiBzbGFzaC5leHQocmVzdWx0LmZpbGUpID09ICdqcydcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgbWFwcGVkTGluZSA9IHRvQ29mZmVlIHJlc3VsdC5maWxlLCByZXN1bHQubGluZSwgcmVzdWx0LmNvbFxuICAgICAgICAgICAgXG4gICAgICAgICAgICBpZiBtYXBwZWRMaW5lP1xuICAgICAgICAgICAgICAgIHJlc3VsdC5maWxlID0gbWFwcGVkTGluZVswXVxuICAgICAgICAgICAgICAgIHJlc3VsdC5saW5lID0gbWFwcGVkTGluZVsxXVxuICAgICAgICAgICAgICAgIHJlc3VsdC5jb2wgID0gbWFwcGVkTGluZVsyXVxuICAgICAgICAgICAgICAgIFxuICAgICAgICAjIGVsc2UgaWYgc2xhc2guZXh0KHJlc3VsdC5maWxlKSA9PSAnY29mZmVlJyBhbmQgbm90IHNsYXNoLmlzQWJzb2x1dGUgcmVzdWx0LmZpbGUgICAgICAgICAgICAgICAgXG4jICAgICAgICAgICAgIFxuICAgICAgICAgICAgIyBjb25zb2xlLmxvZyBcImZpbGVQb3MyIEZJWE1FIVwiLCBsaW5lLCByZXN1bHRcbiAgICAgICAgICAgIFxuICAgIHJlc3VsdFxuXG4jICAwMDAwMDAwICAwMDAwMDAwMDAgICAwMDAwMDAwICAgIDAwMDAwMDAgIDAwMCAgIDAwMCAgXG4jIDAwMCAgICAgICAgICAwMDAgICAgIDAwMCAgIDAwMCAgMDAwICAgICAgIDAwMCAgMDAwICAgXG4jIDAwMDAwMDAgICAgICAwMDAgICAgIDAwMDAwMDAwMCAgMDAwICAgICAgIDAwMDAwMDAgICAgXG4jICAgICAgMDAwICAgICAwMDAgICAgIDAwMCAgIDAwMCAgMDAwICAgICAgIDAwMCAgMDAwICAgXG4jIDAwMDAwMDAgICAgICAwMDAgICAgIDAwMCAgIDAwMCAgIDAwMDAwMDAgIDAwMCAgIDAwMCAgXG5cbmVycm9yU3RhY2sgPSAoZXJyKSAtPlxuICAgIFxuICAgIGxpbmVzID0gW11cbiAgICBcbiAgICBmb3Igc3RhY2tMaW5lIGluIGVyci5zdGFjay5zcGxpdCAnXFxuJyBcbiAgICAgICAgXG4gICAgICAgIGlmIGZwID0gZmlsZVBvcyBzdGFja0xpbmVcbiAgICAgICAgICAgIGxpbmVzLnB1c2ggXCIgICAgICAgI3tfLnBhZEVuZCBmcC5mdW5jLCAzMH0gI3tmcC5maWxlfToje2ZwLmxpbmV9XCIgXG4gICAgICAgIGVsc2VcbiAgICAgICAgICAgIGxpbmVzLnB1c2ggc3RhY2tMaW5lIFxuXG4gIFxuICAgIGxpbmVzLmpvaW4gJ1xcbidcblxuIyAwMDAwMDAwMDAgIDAwMDAwMDAwICAgIDAwMDAwMDAgICAgMDAwMDAwMCAgMDAwMDAwMDAgIFxuIyAgICAwMDAgICAgIDAwMCAgIDAwMCAgMDAwICAgMDAwICAwMDAgICAgICAgMDAwICAgICAgIFxuIyAgICAwMDAgICAgIDAwMDAwMDAgICAgMDAwMDAwMDAwICAwMDAgICAgICAgMDAwMDAwMCAgIFxuIyAgICAwMDAgICAgIDAwMCAgIDAwMCAgMDAwICAgMDAwICAwMDAgICAgICAgMDAwICAgICAgIFxuIyAgICAwMDAgICAgIDAwMCAgIDAwMCAgMDAwICAgMDAwICAgMDAwMDAwMCAgMDAwMDAwMDAgIFxuXG5lcnJvclRyYWNlID0gKGVycikgLT5cbiAgICBcbiAgICBsaW5lcyA9IFtdXG4gICAgdGV4dCAgPSBbXVxuXG4gICAgZm9yIHN0YWNrTGluZSBpbiBlcnIuc3RhY2suc3BsaXQgJ1xcbicgXG4gICAgICAgIFxuICAgICAgICBpZiBmcCA9IGZpbGVQb3Mgc3RhY2tMaW5lXG4gICAgICAgICAgICBsaW5lcy5wdXNoIGZwXG4gICAgICAgIGVsc2VcbiAgICAgICAgICAgIHRleHQucHVzaCBzdGFja0xpbmUgXG5cbiAgXG4gICAgbGluZXM6ICBsaW5lc1xuICAgIHRleHQ6ICAgdGV4dC5qb2luICdcXG4nXG4gICAgXG4jIDAwMDAwMDAwMCAgIDAwMDAwMDAgICAgICAgICAgMDAwMDAwMCAgIDAwMDAwMDAgICAwMDAwMDAwMCAgMDAwMDAwMDAgIDAwMDAwMDAwICAwMDAwMDAwMCAgXG4jICAgIDAwMCAgICAgMDAwICAgMDAwICAgICAgICAwMDAgICAgICAgMDAwICAgMDAwICAwMDAgICAgICAgMDAwICAgICAgIDAwMCAgICAgICAwMDAgICAgICAgXG4jICAgIDAwMCAgICAgMDAwICAgMDAwICAgICAgICAwMDAgICAgICAgMDAwICAgMDAwICAwMDAwMDAgICAgMDAwMDAwICAgIDAwMDAwMDAgICAwMDAwMDAwICAgXG4jICAgIDAwMCAgICAgMDAwICAgMDAwICAgICAgICAwMDAgICAgICAgMDAwICAgMDAwICAwMDAgICAgICAgMDAwICAgICAgIDAwMCAgICAgICAwMDAgICAgICAgXG4jICAgIDAwMCAgICAgIDAwMDAwMDAgICAgICAgICAgMDAwMDAwMCAgIDAwMDAwMDAgICAwMDAgICAgICAgMDAwICAgICAgIDAwMDAwMDAwICAwMDAwMDAwMCAgXG5cbnRvQ29mZmVlID0gKGpzRmlsZSwganNMaW5lLCBqc0NvbD0wKSAtPlxuXG4gICAganNMaW5lID0gcGFyc2VJbnQganNMaW5lXG4gICAganNDb2wgID0gcGFyc2VJbnQganNDb2xcbiAgICBcbiAgICBjb2ZmZWVGaWxlID0ganNGaWxlLnJlcGxhY2UgL1xcL2pzXFwvLywgJy9jb2ZmZWUvJ1xuICAgIGNvZmZlZUZpbGUgPSBjb2ZmZWVGaWxlLnJlcGxhY2UgL1xcLmpzJC8sICcuY29mZmVlJ1xuICAgIGNvZmZlZUxpbmUgPSBqc0xpbmVcbiAgICBjb2ZmZWVDb2wgID0ganNDb2xcbiAgICBcbiAgICBpZiBzbGFzaC5maWxlRXhpc3RzIGpzRmlsZVxuICAgICAgICBtYXBEYXRhID0gbWFwQ29udmVydC5mcm9tU291cmNlKHNsYXNoLnJlYWRUZXh0IGpzRmlsZSk/LnRvT2JqZWN0KClcbiAgICAgICAgaWYgZW1wdHkgbWFwRGF0YS5zb3VyY2VzWzBdXG4gICAgICAgICAgICBtYXBEYXRhLnNvdXJjZXNbMF0gPSBjb2ZmZWVGaWxlXG4gICAgICAgIGlmIHZhbGlkIG1hcERhdGFcbiAgICAgICAgICAgIGNvbnN1bWVyID0gbmV3IHNvdXJjZU1hcC5Tb3VyY2VNYXBDb25zdW1lciBtYXBEYXRhXG4gICAgICAgICAgICBpZiBjb25zdW1lci5vcmlnaW5hbFBvc2l0aW9uRm9yXG4gICAgICAgICAgICAgICAgcG9zID0gY29uc3VtZXIub3JpZ2luYWxQb3NpdGlvbkZvciBsaW5lOmpzTGluZSwgY29sdW1uOmpzQ29sLCBiaWFzOnNvdXJjZU1hcC5Tb3VyY2VNYXBDb25zdW1lci5MRUFTVF9VUFBFUl9CT1VORFxuICAgICAgICAgICAgICAgIGlmIHZhbGlkKHBvcy5saW5lKSBhbmQgdmFsaWQocG9zLmNvbHVtbilcbiAgICAgICAgICAgICAgICAgICAgY29mZmVlRmlsZSA9IHNsYXNoLnRpbGRlIG1hcERhdGEuc291cmNlc1swXVxuICAgICAgICAgICAgICAgICAgICBjb2ZmZWVMaW5lID0gcG9zLmxpbmUgXG4gICAgICAgICAgICAgICAgICAgIGNvZmZlZUNvbCAgPSBwb3MuY29sdW1uXG4gICAgICAgICAgICAgICAgZWxzZVxuICAgICAgICAgICAgICAgICAgICBrbG9nICdpbnZhbGlkIGxpbmUuY29sdW1uJ1xuICAgICAgICAgICAgZWxzZVxuICAgICAgICAgICAgICAgIGtsb2cgJ25vIGNvbnN1bWVyIG9yaWdpbmFsUG9zaXRpb25Gb3InLCBtYXBEYXRhPywgY29uc3VtZXI/XG4gICAgZWxzZVxuICAgICAgICBrbG9nIFwibm8ganNGaWxlICN7anNGaWxlfVwiXG4gICAgICAgIFxuICAgIFtjb2ZmZWVGaWxlLCBjb2ZmZWVMaW5lLCBjb2ZmZWVDb2xdXG5cbiMgMDAwMDAwMDAwICAgMDAwMDAwMCAgICAgICAgICAgICAgIDAwMCAgIDAwMDAwMDAgIFxuIyAgICAwMDAgICAgIDAwMCAgIDAwMCAgICAgICAgICAgICAgMDAwICAwMDAgICAgICAgXG4jICAgIDAwMCAgICAgMDAwICAgMDAwICAgICAgICAgICAgICAwMDAgIDAwMDAwMDAgICBcbiMgICAgMDAwICAgICAwMDAgICAwMDAgICAgICAgIDAwMCAgIDAwMCAgICAgICAwMDAgIFxuIyAgICAwMDAgICAgICAwMDAwMDAwICAgICAgICAgIDAwMDAwMDAgICAwMDAwMDAwICAgXG5cbnRvSnMgPSAoY29mZmVlRmlsZSwgY29mZmVlTGluZSwgY29mZmVlQ29sPTApIC0+XG4gICAgXG4gICAganNGaWxlID0gY29mZmVlRmlsZS5yZXBsYWNlIC9cXC9jb2ZmZWVcXC8vLCAnL2pzLydcbiAgICBqc0ZpbGUgPSBqc0ZpbGUucmVwbGFjZSAvXFwuY29mZmVlJC8sICcuanMnXG4gICAgXG4gICAgaWYgbm90IHNsYXNoLmZpbGVFeGlzdHMganNGaWxlXG4gICAgICAgIHJldHVybiBbbnVsbCwgbnVsbCwgbnVsbF1cbiAgICAgICAgXG4gICAgaWYgbm90IGNvZmZlZUxpbmU/IHRoZW4gcmV0dXJuIFtqc0ZpbGUsIG51bGwsIG51bGxdXG4gICAgXG4gICAgbWFwRGF0YSA9IG1hcENvbnZlcnQuZnJvbVNvdXJjZShzbGFzaC5yZWFkVGV4dCBqc0ZpbGUpPy50b09iamVjdCgpXG4gICAgaWYgZW1wdHkgbWFwRGF0YS5zb3VyY2VzWzBdXG4gICAgICAgIG1hcERhdGEuc291cmNlc1swXSA9IGNvZmZlZUZpbGVcbiAgICBpZiB2YWxpZCBtYXBEYXRhXG4gICAgICAgIGNvbnN1bWVyID0gbmV3IHNvdXJjZU1hcC5Tb3VyY2VNYXBDb25zdW1lciBtYXBEYXRhXG4gICAgICAgIGlmIGNvbnN1bWVyPy5hbGxHZW5lcmF0ZWRQb3NpdGlvbnNGb3I/XG4gICAgICAgICAgICBwb3NzID0gY29uc3VtZXIuYWxsR2VuZXJhdGVkUG9zaXRpb25zRm9yIHNvdXJjZTptYXBEYXRhLnNvdXJjZXNbMF0sIGxpbmU6Y29mZmVlTGluZSwgY29sdW1uOmNvZmZlZUNvbFxuICAgICAgICAgICAgaWYgdmFsaWQgcG9zc1xuICAgICAgICAgICAgICAgIHJldHVybiBbanNGaWxlLCBwb3NzWzBdPy5saW5lLCBwb3NzWzBdPy5jb2x1bW5dXG4gICAgICAgICAgICBlbHNlXG4gICAgICAgICAgICAgICAgbG9nICdzcmNtYXAudG9KcyAtLSBlbXB0eSBwb3NzIScgbWFwRGF0YS5zb3VyY2VzWzBdXG4gICAgICAgIGVsc2VcbiAgICAgICAgICAgIGxvZyAnc3JjbWFwLnRvSnMgLS0gbm8gYWxsR2VuZXJhdGVkUG9zaXRpb25zRm9yIGluJyBjb25zdW1lclxuICAgICAgICBcbiAgICBbanNGaWxlLCBudWxsLCBudWxsXVxuICAgICAgICBcbm1vZHVsZS5leHBvcnRzID1cbiAgICB0b0pzOiAgICAgICB0b0pzXG4gICAgdG9Db2ZmZWU6ICAgdG9Db2ZmZWVcbiAgICBlcnJvclN0YWNrOiBlcnJvclN0YWNrXG4gICAgZXJyb3JUcmFjZTogZXJyb3JUcmFjZVxuICAgIGxvZ0VycjogICAgIGxvZ0VyclxuICAgIFxuICAgICJdfQ==
//# sourceURL=../coffee/srcmap.coffee