// koffee 0.50.0

/*
 0000000  000000000  00000000 
000          000     000   000
0000000      000     0000000  
     000     000     000   000
0000000      000     000   000
 */
var ESCAPEREGEXP, STRIPANSI, _, entity, noon, str, time, xmlEntities;

_ = require('lodash');

noon = require('noon');

entity = require('html-entities');

time = require('pretty-time');

xmlEntities = new entity.XmlEntities();

str = function(o) {
    if (o == null) {
        return 'null';
    }
    if (typeof o === 'object') {
        if (o._str != null) {
            return o._str();
        } else {
            return "\n" + noon.stringify(o, {
                circular: true
            });
        }
    } else {
        return String(o);
    }
};


/*
00000000  000   000   0000000   0000000   0000000    00000000
000       0000  000  000       000   000  000   000  000     
0000000   000 0 000  000       000   000  000   000  0000000 
000       000  0000  000       000   000  000   000  000     
00000000  000   000   0000000   0000000   0000000    00000000
 */

str.encode = function(s, spaces) {
    var r;
    if (spaces == null) {
        spaces = true;
    }
    if (s) {
        r = xmlEntities.encode(s);
        if (spaces) {
            r = r.replace(/\s/g, '&nbsp;');
        }
        return r;
    } else {
        return '';
    }
};

ESCAPEREGEXP = /[-\\^$*+?.()|[\]{}\/]/g;

str.escapeRegexp = function(s) {
    return s.replace(ESCAPEREGEXP, '\\$&');
};

STRIPANSI = /\x1B[[(?);]{0,2}(;?\d)*./g;

str.stripansi = function(s) {
    return s.replace(STRIPANSI, '');
};

str.replaceTabs = function(s) {
    var i;
    i = 0;
    while (i < s.length) {
        if (s[i] === '\t') {
            s = s.splice(i, 1, _.padStart("", 4 - (i % 4)));
        }
        i += 1;
    }
    return s;
};

str.time = function(t) {
    var f, j, len, ref, u;
    if (typeof t === 'bigint') {
        f = 1000n;
        ref = ['ns', 'Î¼s', 'ms', 's'];
        for (j = 0, len = ref.length; j < len; j++) {
            u = ref[j];
            if (u === 's' || t < f) {
                return '' + (1000n * t / f) + u;
            }
            f *= 1000n;
        }
    } else {
        return time(t);
    }
};

module.exports = str;

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic3RyLmpzIiwic291cmNlUm9vdCI6Ii4iLCJzb3VyY2VzIjpbIiJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOztBQUFBOzs7Ozs7O0FBQUEsSUFBQTs7QUFRQSxDQUFBLEdBQVMsT0FBQSxDQUFRLFFBQVI7O0FBQ1QsSUFBQSxHQUFTLE9BQUEsQ0FBUSxNQUFSOztBQUNULE1BQUEsR0FBUyxPQUFBLENBQVEsZUFBUjs7QUFDVCxJQUFBLEdBQVMsT0FBQSxDQUFRLGFBQVI7O0FBRVQsV0FBQSxHQUFjLElBQUksTUFBTSxDQUFDLFdBQVgsQ0FBQTs7QUFFZCxHQUFBLEdBQU0sU0FBQyxDQUFEO0lBQ0YsSUFBcUIsU0FBckI7QUFBQSxlQUFPLE9BQVA7O0lBQ0EsSUFBRyxPQUFPLENBQVAsS0FBYSxRQUFoQjtRQUNJLElBQUcsY0FBSDttQkFDSSxDQUFDLENBQUMsSUFBRixDQUFBLEVBREo7U0FBQSxNQUFBO21CQUdJLElBQUEsR0FBTyxJQUFJLENBQUMsU0FBTCxDQUFlLENBQWYsRUFBa0I7Z0JBQUEsUUFBQSxFQUFVLElBQVY7YUFBbEIsRUFIWDtTQURKO0tBQUEsTUFBQTtlQU1JLE1BQUEsQ0FBTyxDQUFQLEVBTko7O0FBRkU7OztBQVVOOzs7Ozs7OztBQVFBLEdBQUcsQ0FBQyxNQUFKLEdBQWEsU0FBQyxDQUFELEVBQUksTUFBSjtBQUNULFFBQUE7O1FBRGEsU0FBTzs7SUFDcEIsSUFBRyxDQUFIO1FBQ0ksQ0FBQSxHQUFJLFdBQVcsQ0FBQyxNQUFaLENBQW1CLENBQW5CO1FBQ0osSUFBRyxNQUFIO1lBQ0ksQ0FBQSxHQUFJLENBQUMsQ0FBQyxPQUFGLENBQVUsS0FBVixFQUFpQixRQUFqQixFQURSOztlQUVBLEVBSko7S0FBQSxNQUFBO2VBTUksR0FOSjs7QUFEUzs7QUFVYixZQUFBLEdBQWU7O0FBQ2YsR0FBRyxDQUFDLFlBQUosR0FBbUIsU0FBQyxDQUFEO1dBQ2YsQ0FBQyxDQUFDLE9BQUYsQ0FBVSxZQUFWLEVBQXdCLE1BQXhCO0FBRGU7O0FBR25CLFNBQUEsR0FBWTs7QUFDWixHQUFHLENBQUMsU0FBSixHQUFnQixTQUFDLENBQUQ7V0FDWixDQUFDLENBQUMsT0FBRixDQUFVLFNBQVYsRUFBcUIsRUFBckI7QUFEWTs7QUFHaEIsR0FBRyxDQUFDLFdBQUosR0FBa0IsU0FBQyxDQUFEO0FBQ2QsUUFBQTtJQUFBLENBQUEsR0FBSTtBQUNKLFdBQU0sQ0FBQSxHQUFJLENBQUMsQ0FBQyxNQUFaO1FBQ0ksSUFBRyxDQUFFLENBQUEsQ0FBQSxDQUFGLEtBQVEsSUFBWDtZQUNJLENBQUEsR0FBSSxDQUFDLENBQUMsTUFBRixDQUFTLENBQVQsRUFBWSxDQUFaLEVBQWUsQ0FBQyxDQUFDLFFBQUYsQ0FBVyxFQUFYLEVBQWUsQ0FBQSxHQUFFLENBQUMsQ0FBQSxHQUFFLENBQUgsQ0FBakIsQ0FBZixFQURSOztRQUVBLENBQUEsSUFBSztJQUhUO1dBSUE7QUFOYzs7QUFRbEIsR0FBRyxDQUFDLElBQUosR0FBVyxTQUFDLENBQUQ7QUFDUCxRQUFBO0lBQUEsSUFBRyxPQUFPLENBQVAsS0FBYSxRQUFoQjtRQUNJLENBQUEsR0FBSTtBQUNKO0FBQUEsYUFBQSxxQ0FBQTs7WUFDSSxJQUFHLENBQUEsS0FBSyxHQUFMLElBQVksQ0FBQSxHQUFJLENBQW5CO0FBQ0ksdUJBQU8sRUFBQSxHQUFLLENBQUMsS0FBQSxHQUFRLENBQVIsR0FBWSxDQUFiLENBQUwsR0FBdUIsRUFEbEM7O1lBRUEsQ0FBQSxJQUFLO0FBSFQsU0FGSjtLQUFBLE1BQUE7ZUFPSSxJQUFBLENBQUssQ0FBTCxFQVBKOztBQURPOztBQVVYLE1BQU0sQ0FBQyxPQUFQLEdBQWlCIiwic291cmNlc0NvbnRlbnQiOlsiIyMjXG4gMDAwMDAwMCAgMDAwMDAwMDAwICAwMDAwMDAwMCBcbjAwMCAgICAgICAgICAwMDAgICAgIDAwMCAgIDAwMFxuMDAwMDAwMCAgICAgIDAwMCAgICAgMDAwMDAwMCAgXG4gICAgIDAwMCAgICAgMDAwICAgICAwMDAgICAwMDBcbjAwMDAwMDAgICAgICAwMDAgICAgIDAwMCAgIDAwMFxuIyMjXG5cbl8gICAgICA9IHJlcXVpcmUgJ2xvZGFzaCdcbm5vb24gICA9IHJlcXVpcmUgJ25vb24nXG5lbnRpdHkgPSByZXF1aXJlICdodG1sLWVudGl0aWVzJ1xudGltZSAgID0gcmVxdWlyZSAncHJldHR5LXRpbWUnXG5cbnhtbEVudGl0aWVzID0gbmV3IGVudGl0eS5YbWxFbnRpdGllcygpXG5cbnN0ciA9IChvKSAtPlxuICAgIHJldHVybiAnbnVsbCcgaWYgbm90IG8/XG4gICAgaWYgdHlwZW9mKG8pID09ICdvYmplY3QnXG4gICAgICAgIGlmIG8uX3N0cj9cbiAgICAgICAgICAgIG8uX3N0cigpXG4gICAgICAgIGVsc2VcbiAgICAgICAgICAgIFwiXFxuXCIgKyBub29uLnN0cmluZ2lmeSBvLCBjaXJjdWxhcjogdHJ1ZVxuICAgIGVsc2VcbiAgICAgICAgU3RyaW5nIG9cblxuIyMjXG4wMDAwMDAwMCAgMDAwICAgMDAwICAgMDAwMDAwMCAgIDAwMDAwMDAgICAwMDAwMDAwICAgIDAwMDAwMDAwXG4wMDAgICAgICAgMDAwMCAgMDAwICAwMDAgICAgICAgMDAwICAgMDAwICAwMDAgICAwMDAgIDAwMCAgICAgXG4wMDAwMDAwICAgMDAwIDAgMDAwICAwMDAgICAgICAgMDAwICAgMDAwICAwMDAgICAwMDAgIDAwMDAwMDAgXG4wMDAgICAgICAgMDAwICAwMDAwICAwMDAgICAgICAgMDAwICAgMDAwICAwMDAgICAwMDAgIDAwMCAgICAgXG4wMDAwMDAwMCAgMDAwICAgMDAwICAgMDAwMDAwMCAgIDAwMDAwMDAgICAwMDAwMDAwICAgIDAwMDAwMDAwXG4jIyNcblxuc3RyLmVuY29kZSA9IChzLCBzcGFjZXM9dHJ1ZSkgLT5cbiAgICBpZiBzXG4gICAgICAgIHIgPSB4bWxFbnRpdGllcy5lbmNvZGUgc1xuICAgICAgICBpZiBzcGFjZXNcbiAgICAgICAgICAgIHIgPSByLnJlcGxhY2UgL1xccy9nLCAnJm5ic3A7J1xuICAgICAgICByXG4gICAgZWxzZVxuICAgICAgICAnJ1xuICBcbiMgRVNDQVBFUkVHRVhQID0gL1tcXFxcXiQqKz8uKCl8W1xcXXt9XS9nXG5FU0NBUEVSRUdFWFAgPSAvWy1cXFxcXiQqKz8uKCl8W1xcXXt9XFwvXS9nXG5zdHIuZXNjYXBlUmVnZXhwID0gKHMpIC0+XG4gICAgcy5yZXBsYWNlIEVTQ0FQRVJFR0VYUCwgJ1xcXFwkJidcbiAgICAgICAgXG5TVFJJUEFOU0kgPSAvXFx4MUJbWyg/KTtdezAsMn0oOz9cXGQpKi4vZ1xuc3RyLnN0cmlwYW5zaSA9IChzKSAtPlxuICAgIHMucmVwbGFjZSBTVFJJUEFOU0ksICcnXG4gICAgICAgIFxuc3RyLnJlcGxhY2VUYWJzID0gKHMpIC0+XG4gICAgaSA9IDBcbiAgICB3aGlsZSBpIDwgcy5sZW5ndGhcbiAgICAgICAgaWYgc1tpXSA9PSAnXFx0J1xuICAgICAgICAgICAgcyA9IHMuc3BsaWNlIGksIDEsIF8ucGFkU3RhcnQgXCJcIiwgNC0oaSU0KVxuICAgICAgICBpICs9IDFcbiAgICBzXG4gICAgXG5zdHIudGltZSA9ICh0KSAtPlxuICAgIGlmIHR5cGVvZih0KSA9PSAnYmlnaW50J1xuICAgICAgICBmID0gMTAwMG4gXG4gICAgICAgIGZvciB1IGluIFsnbnMnJ868cycnbXMnJ3MnXSBcbiAgICAgICAgICAgIGlmIHUgPT0gJ3MnIG9yIHQgPCBmIFxuICAgICAgICAgICAgICAgIHJldHVybiAnJyArICgxMDAwbiAqIHQgLyBmKSArIHUgXG4gICAgICAgICAgICBmICo9IDEwMDBuICAgIFxuICAgIGVsc2VcbiAgICAgICAgdGltZSB0XG4gICAgICAgIFxubW9kdWxlLmV4cG9ydHMgPSBzdHJcbiJdfQ==
//# sourceURL=../coffee/str.coffee