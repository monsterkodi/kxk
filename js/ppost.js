(function() {
  /*
  00000000    0000000    0000000  000000000    
  000   000  000   000  000          000       
  00000000   000   000  0000000      000       
  000        000   000       000     000       
  000         0000000   0000000      000       
  */
  var Emitter, POST, PostMain, PostRenderer, _, electron, remote,
    boundMethodCheck = function(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new Error('Bound instance method accessed before binding'); } },
    indexOf = [].indexOf;

  _ = require('lodash');

  Emitter = require('events');

  POST = '__POST__';

  if (process.type === 'renderer') {
    electron = require('electron');
    remote = electron.remote;
    
    // 000   000  000  000   000    
    // 000 0 000  000  0000  000    
    // 000000000  000  000 0 000    
    // 000   000  000  000  0000    
    // 00     00  000  000   000    
    PostRenderer = class PostRenderer extends Emitter {
      constructor() {
        super();
        this.dispose = this.dispose.bind(this);
        this.dbg = false;
        this.id = remote.getCurrentWindow().id;
        this.ipc = electron.ipcRenderer;
        this.ipc.on(POST, (event, type, argl) => {
          return this.emit.apply(this, [type].concat(argl));
        });
        window.addEventListener('beforeunload', this.dispose);
      }

      dispose() {
        boundMethodCheck(this, PostRenderer);
        window.removeEventListener('beforeunload', this.dispose);
        this.ipc.removeAllListeners(POST);
        return this.ipc = null;
      }

      toAll(type, ...args) {
        return this.send('toAll', type, args);
      }

      toOthers(type, ...args) {
        return this.send('toOthers', type, args, this.id);
      }

      toMain(type, ...args) {
        return this.send('toMain', type, args);
      }

      toOtherWins(type, ...args) {
        return this.send('toOtherWins', type, args, this.id);
      }

      toWins(type, ...args) {
        return this.send('toWins', type, args);
      }

      toWin(id, type, ...args) {
        return this.send('toWin', type, args, id);
      }

      get(type, ...args) {
        return this.ipc.sendSync(POST, 'get', type, args);
      }

      debug(dbg = ['emit', 'toAll', 'toOthers', 'toMain', 'toOtherWins', 'toWins', 'toWin']) {
        this.dbg = dbg;
        return console.log(`post.debug id:${this.id}`, this.dbg);
      }

      emit(type, ...args) {
        if (indexOf.call(this.dbg, 'emit') >= 0) {
          console.log(`post.emit ${type}`, args.map(function(a) {
            return new String(a);
          }).join(' '));
        }
        return super.emit(...arguments);
      }

      send(receivers, type, args, id) {
        if (indexOf.call(this.dbg, receivers) >= 0) {
          console.log(`post.${receivers} ${type}`, args.map(function(a) {
            return new String(a);
          }).join(' '));
        }
        return this.ipc.send(POST, receivers, type, args, id);
      }

    };
    module.exports = new PostRenderer();
  } else {
    // 00     00   0000000   000  000   000  
    // 000   000  000   000  000  0000  000  
    // 000000000  000000000  000  000 0 000  
    // 000 0 000  000   000  000  000  0000  
    // 000   000  000   000  000  000   000  
    PostMain = class PostMain extends Emitter {
      constructor() {
        var err, ipc, ref;
        super();
        this.getCallbacks = {};
        try {
          ipc = require('electron').ipcMain;
          if (ipc != null) {
            ipc.on(POST, (event, kind, type, argl, id) => {
              var retval;
              id = id || event.sender.id;
              switch (kind) {
                case 'toMain':
                  return this.sendToMain(type, argl);
                case 'toAll':
                  return this.sendToWins(type, argl).sendToMain(type, argl);
                case 'toOthers':
                  return this.sendToWins(type, argl, id).sendToMain(type, argl);
                case 'toOtherWins':
                  return this.sendToWins(type, argl, id);
                case 'toWins':
                  return this.sendToWins(type, argl);
                case 'toWin':
                  if (this.dbg) {
                    console.log('to win', id, type, argl);
                  }
                  return this.toWin.apply(this, [id, type].concat(argl));
                case 'get':
                  if (this.dbg) {
                    console.log('post get', type, argl, this.getCallbacks[type]);
                  }
                  if (_.isFunction(this.getCallbacks[type])) {
                    retval = this.getCallbacks[type].apply(this.getCallbacks[type], argl);
                    return event.returnValue = retval != null ? retval : [];
                  }
              }
            });
          }
        } catch (error) {
          err = error;
          console.log((ref = err.message) != null ? ref : err);
        }
      }

      toAll(type, ...args) {
        return this.sendToWins(type, args).sendToMain(type, args);
      }

      toMain(type, ...args) {
        return this.sendToMain(type, args);
      }

      toWins(type, ...args) {
        return this.sendToWins(type, args);
      }

      toWin(id, type, ...args) {
        var ref;
        return (ref = require('electron').BrowserWindow.fromId(id)) != null ? ref.webContents.send(POST, type, args) : void 0;
      }

      onGet(type, cb) {
        this.getCallbacks[type] = cb;
        return this;
      }

      sendToMain(type, argl) {
        if (this.dbg) {
          console.log("post to main", type, argl);
        }
        argl.unshift(type);
        this.emit.apply(this, argl);
        return this;
      }

      sendToWins(type, argl, except) {
        var i, len, ref, win;
        ref = require('electron').BrowserWindow.getAllWindows();
        for (i = 0, len = ref.length; i < len; i++) {
          win = ref[i];
          if (win.id !== except) {
            if (this.dbg) {
              console.log(`post to ${win.id} ${type //, argl.map((a) -> new String(a)).join ' '
}`);
            }
            win.webContents.send(POST, type, argl);
          }
        }
        return this;
      }

      debug(dbg = true) {
        this.dbg = dbg;
        return console.log("post.debug", this.dbg);
      }

    };
    module.exports = new PostMain();
  }

}).call(this);

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicHBvc3QuanMiLCJzb3VyY2VSb290IjoiLiIsInNvdXJjZXMiOlsiLi4vY29mZmVlL3Bwb3N0LmNvZmZlZSJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtFQUFBOzs7Ozs7O0FBQUEsTUFBQSxPQUFBLEVBQUEsSUFBQSxFQUFBLFFBQUEsRUFBQSxZQUFBLEVBQUEsQ0FBQSxFQUFBLFFBQUEsRUFBQSxNQUFBO0lBQUE7OztFQVFBLENBQUEsR0FBVSxPQUFBLENBQVEsUUFBUjs7RUFDVixPQUFBLEdBQVUsT0FBQSxDQUFRLFFBQVI7O0VBQ1YsSUFBQSxHQUFVOztFQUVWLElBQUcsT0FBTyxDQUFDLElBQVIsS0FBZ0IsVUFBbkI7SUFFSSxRQUFBLEdBQVcsT0FBQSxDQUFRLFVBQVI7SUFDWCxNQUFBLEdBQVcsUUFBUSxDQUFDLE9BRHBCOzs7Ozs7O0lBU00sZUFBTixNQUFBLGFBQUEsUUFBMkIsUUFBM0I7TUFFSSxXQUFhLENBQUEsQ0FBQTs7WUFRYixDQUFBLGNBQUEsQ0FBQTtRQU5JLElBQUMsQ0FBQSxHQUFELEdBQU87UUFDUCxJQUFDLENBQUEsRUFBRCxHQUFPLE1BQU0sQ0FBQyxnQkFBUCxDQUFBLENBQXlCLENBQUM7UUFDakMsSUFBQyxDQUFBLEdBQUQsR0FBTyxRQUFRLENBQUM7UUFDaEIsSUFBQyxDQUFBLEdBQUcsQ0FBQyxFQUFMLENBQVEsSUFBUixFQUFjLENBQUMsS0FBRCxFQUFRLElBQVIsRUFBYyxJQUFkLENBQUEsR0FBQTtpQkFBdUIsSUFBQyxDQUFBLElBQUksQ0FBQyxLQUFOLENBQVksSUFBWixFQUFlLENBQUMsSUFBRCxDQUFNLENBQUMsTUFBUCxDQUFjLElBQWQsQ0FBZjtRQUF2QixDQUFkO1FBQ0EsTUFBTSxDQUFDLGdCQUFQLENBQXdCLGNBQXhCLEVBQXdDLElBQUMsQ0FBQSxPQUF6QztNQU5TOztNQVFiLE9BQVMsQ0FBQSxDQUFBOytCQVZQO1FBV0UsTUFBTSxDQUFDLG1CQUFQLENBQTJCLGNBQTNCLEVBQTJDLElBQUMsQ0FBQSxP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LENBQUMsT0FBUCxHQUFpQixJQUFJLFFBQUosQ0FBQSxFQTNHckI7O0FBWkEiLCJzb3VyY2VzQ29udGVudCI6WyIjIyNcbjAwMDAwMDAwICAgIDAwMDAwMDAgICAgMDAwMDAwMCAgMDAwMDAwMDAwICAgIFxuMDAwICAgMDAwICAwMDAgICAwMDAgIDAwMCAgICAgICAgICAwMDAgICAgICAgXG4wMDAwMDAwMCAgIDAwMCAgIDAwMCAgMDAwMDAwMCAgICAgIDAwMCAgICAgICBcbjAwMCAgICAgICAgMDAwICAgMDAwICAgICAgIDAwMCAgICAgMDAwICAgICAgIFxuMDAwICAgICAgICAgMDAwMDAwMCAgIDAwMDAwMDAgICAgICAwMDAgICAgICAgXG4jIyNcblxuXyAgICAgICA9IHJlcXVpcmUgJ2xvZGFzaCdcbkVtaXR0ZXIgPSByZXF1aXJlICdldmVudHMnXG5QT1NUICAgID0gJ19fUE9TVF9fJ1xuXG5pZiBwcm9jZXNzLnR5cGUgPT0gJ3JlbmRlcmVyJ1xuXG4gICAgZWxlY3Ryb24gPSByZXF1aXJlICdlbGVjdHJvbidcbiAgICByZW1vdGUgICA9IGVsZWN0cm9uLnJlbW90ZVxuICAgIFxuICAgICMgMDAwICAgMDAwICAwMDAgIDAwMCAgIDAwMCAgICBcbiAgICAjIDAwMCAwIDAwMCAgMDAwICAwMDAwICAwMDAgICAgXG4gICAgIyAwMDAwMDAwMDAgIDAwMCAgMDAwIDAgMDAwICAgIFxuICAgICMgMDAwICAgMDAwICAwMDAgIDAwMCAgMDAwMCAgICBcbiAgICAjIDAwICAgICAwMCAgMDAwICAwMDAgICAwMDAgICAgXG5cbiAgICBjbGFzcyBQb3N0UmVuZGVyZXIgZXh0ZW5kcyBFbWl0dGVyXG5cbiAgICAgICAgY29uc3RydWN0b3I6ICgpIC0+XG4gICAgICAgICAgICBzdXBlcigpXG4gICAgICAgICAgICBAZGJnID0gZmFsc2VcbiAgICAgICAgICAgIEBpZCAgPSByZW1vdGUuZ2V0Q3VycmVudFdpbmRvdygpLmlkXG4gICAgICAgICAgICBAaXBjID0gZWxlY3Ryb24uaXBjUmVuZGVyZXJcbiAgICAgICAgICAgIEBpcGMub24gUE9TVCwgKGV2ZW50LCB0eXBlLCBhcmdsKSA9PiBAZW1pdC5hcHBseSBALCBbdHlwZV0uY29uY2F0IGFyZ2xcbiAgICAgICAgICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyICdiZWZvcmV1bmxvYWQnLCBAZGlzcG9zZVxuXG4gICAgICAgIGRpc3Bvc2U6ICgpID0+XG4gICAgICAgICAgICB3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lciAnYmVmb3JldW5sb2FkJywgQGRpc3Bvc2VcbiAgICAgICAgICAgIEBpcGMucmVtb3ZlQWxsTGlzdGVuZXJzIFBPU1RcbiAgICAgICAgICAgIEBpcGMgPSBudWxsXG5cbiAgICAgICAgdG9BbGw6ICAgICAgICh0eXBlLCBhcmdzLi4uKSAtPiBAc2VuZCAndG9BbGwnLCAgICAgICB0eXBlLCBhcmdzXG4gICAgICAgIHRvT3RoZXJzOiAgICAodHlwZSwgYXJncy4uLikgLT4gQHNlbmQgJ3RvT3RoZXJzJywgICAgdHlwZSwgYXJncywgQGlkXG4gICAgICAgIHRvTWFpbjogICAgICAodHlwZSwgYXJncy4uLikgLT4gQHNlbmQgJ3RvTWFpbicsICAgICAgdHlwZSwgYXJnc1xuICAgICAgICB0b090aGVyV2luczogKHR5cGUsIGFyZ3MuLi4pIC0+IEBzZW5kICd0b090aGVyV2lucycsIHR5cGUsIGFyZ3MsIEBpZFxuICAgICAgICB0b1dpbnM6ICAgICAgKHR5cGUsIGFyZ3MuLi4pIC0+IEBzZW5kICd0b1dpbnMnLCAgICAgIHR5cGUsIGFyZ3NcbiAgICAgICAgdG9XaW46ICAgKGlkLCB0eXBlLCBhcmdzLi4uKSAtPiBAc2VuZCAndG9XaW4nLCAgICAgICB0eXBlLCBhcmdzLCBpZFxuICAgICAgICBcbiAgICAgICAgZ2V0OiAgICAgICAgICh0eXBlLCBhcmdzLi4uKSAtPiBAaXBjLnNlbmRTeW5jIFBPU1QsICdnZXQnLCB0eXBlLCBhcmdzXG5cbiAgICAgICAgZGVidWc6IChAZGJnPVsnZW1pdCcsICd0b0FsbCcsICd0b090aGVycycsICd0b01haW4nLCAndG9PdGhlcldpbnMnLCAndG9XaW5zJywgJ3RvV2luJ10pIC0+XG4gICAgICAgICAgICBjb25zb2xlLmxvZyBcInBvc3QuZGVidWcgaWQ6I3tAaWR9XCIsIEBkYmdcblxuICAgICAgICBlbWl0OiAodHlwZSwgYXJncy4uLikgLT4gXG4gICAgICAgICAgICBpZiAnZW1pdCcgaW4gQGRiZyB0aGVuIGNvbnNvbGUubG9nIFwicG9zdC5lbWl0ICN7dHlwZX1cIiwgYXJncy5tYXAoKGEpIC0+IG5ldyBTdHJpbmcoYSkpLmpvaW4gJyAnXG4gICAgICAgICAgICBzdXBlciBhcmd1bWVudHMuLi5cbiAgICAgICAgICAgIFxuICAgICAgICBzZW5kOiAocmVjZWl2ZXJzLCB0eXBlLCBhcmdzLCBpZCkgLT5cbiAgICAgICAgICAgIGlmIHJlY2VpdmVycyBpbiBAZGJnIHRoZW4gY29uc29sZS5sb2cgXCJwb3N0LiN7cmVjZWl2ZXJzfSAje3R5cGV9XCIsIGFyZ3MubWFwKChhKSAtPiBuZXcgU3RyaW5nKGEpKS5qb2luICcgJ1xuICAgICAgICAgICAgQGlwYy5zZW5kIFBPU1QsIHJlY2VpdmVycywgdHlwZSwgYXJncywgaWRcblxuICAgIG1vZHVsZS5leHBvcnRzID0gbmV3IFBvc3RSZW5kZXJlcigpXG5cbmVsc2VcblxuICAgICMgMDAgICAgIDAwICAgMDAwMDAwMCAgIDAwMCAgMDAwICAgMDAwICBcbiAgICAjIDAwMCAgIDAwMCAgMDAwICAgMDAwICAwMDAgIDAwMDAgIDAwMCAgXG4gICAgIyAwMDAwMDAwMDAgIDAwMDAwMDAwMCAgMDAwICAwMDAgMCAwMDAgIFxuICAgICMgMDAwIDAgMDAwICAwMDAgICAwMDAgIDAwMCAgMDAwICAwMDAwICBcbiAgICAjIDAwMCAgIDAwMCAgMDAwICAgMDAwICAwMDAgIDAwMCAgIDAwMCAgXG4gICAgXG4gICAgY2xhc3MgUG9zdE1haW4gZXh0ZW5kcyBFbWl0dGVyXG5cbiAgICAgICAgY29uc3RydWN0b3I6ICgpIC0+XG4gICAgICAgICAgICBzdXBlcigpXG4gICAgICAgICAgICBAZ2V0Q2FsbGJhY2tzID0ge31cbiAgICAgICAgICAgIHRyeVxuICAgICAgICAgICAgICAgIGlwYyA9IHJlcXVpcmUoJ2VsZWN0cm9uJykuaXBjTWFpblxuICAgICAgICAgICAgICAgIGlwYz8ub24gUE9TVCwgKGV2ZW50LCBraW5kLCB0eXBlLCBhcmdsLCBpZCkgPT5cbiAgICAgICAgICAgICAgICAgICAgaWQgPSBpZCBvciBldmVudC5zZW5kZXIuaWRcbiAgICAgICAgICAgICAgICAgICAgc3dpdGNoIGtpbmRcbiAgICAgICAgICAgICAgICAgICAgICAgIHdoZW4gJ3RvTWFpbicgICAgICB0aGVuIEBzZW5kVG9NYWluIHR5cGUsIGFyZ2xcbiAgICAgICAgICAgICAgICAgICAgICAgIHdoZW4gJ3RvQWxsJyAgICAgICB0aGVuIEBzZW5kVG9XaW5zKHR5cGUsIGFyZ2wpLnNlbmRUb01haW4odHlwZSwgYXJnbClcbiAgICAgICAgICAgICAgICAgICAgICAgIHdoZW4gJ3RvT3RoZXJzJyAgICB0aGVuIEBzZW5kVG9XaW5zKHR5cGUsIGFyZ2wsIGlkKS5zZW5kVG9NYWluKHR5cGUsIGFyZ2wpXG4gICAgICAgICAgICAgICAgICAgICAgICB3aGVuICd0b090aGVyV2lucycgdGhlbiBAc2VuZFRvV2lucyB0eXBlLCBhcmdsLCBpZFxuICAgICAgICAgICAgICAgICAgICAgICAgd2hlbiAndG9XaW5zJyAgICAgIHRoZW4gQHNlbmRUb1dpbnMgdHlwZSwgYXJnbFxuICAgICAgICAgICAgICAgICAgICAgICAgd2hlbiAndG9XaW4nICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIEBkYmcgdGhlbiBjb25zb2xlLmxvZyAndG8gd2luJywgaWQsIHR5cGUsIGFyZ2xcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBAdG9XaW4uYXBwbHkgQCwgW2lkLCB0eXBlXS5jb25jYXQgYXJnbFxuICAgICAgICAgICAgICAgICAgICAgICAgd2hlbiAnZ2V0J1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIEBkYmcgdGhlbiBjb25zb2xlLmxvZyAncG9zdCBnZXQnLCB0eXBlLCBhcmdsLCBAZ2V0Q2FsbGJhY2tzW3R5cGVdXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgXy5pc0Z1bmN0aW9uIEBnZXRDYWxsYmFja3NbdHlwZV1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dmFsID0gQGdldENhbGxiYWNrc1t0eXBlXS5hcHBseSBAZ2V0Q2FsbGJhY2tzW3R5cGVdLCBhcmdsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV2ZW50LnJldHVyblZhbHVlID0gcmV0dmFsID8gW11cbiAgICAgICAgICAgIGNhdGNoIGVyclxuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nIGVyci5tZXNzYWdlID8gZXJyXG5cbiAgICAgICAgdG9BbGw6ICAoICAgIHR5cGUsIGFyZ3MuLi4pIC0+IEBzZW5kVG9XaW5zKHR5cGUsIGFyZ3MpLnNlbmRUb01haW4odHlwZSwgYXJncylcbiAgICAgICAgdG9NYWluOiAoICAgIHR5cGUsIGFyZ3MuLi4pIC0+IEBzZW5kVG9NYWluIHR5cGUsIGFyZ3NcbiAgICAgICAgdG9XaW5zOiAoICAgIHR5cGUsIGFyZ3MuLi4pIC0+IEBzZW5kVG9XaW5zIHR5cGUsIGFyZ3NcbiAgICAgICAgdG9XaW46ICAoaWQsIHR5cGUsIGFyZ3MuLi4pIC0+IHJlcXVpcmUoJ2VsZWN0cm9uJykuQnJvd3NlcldpbmRvdy5mcm9tSWQoaWQpPy53ZWJDb250ZW50cy5zZW5kIFBPU1QsIHR5cGUsIGFyZ3NcblxuICAgICAgICBvbkdldDogKHR5cGUsIGNiKSAtPlxuICAgICAgICAgICAgQGdldENhbGxiYWNrc1t0eXBlXSA9IGNiXG4gICAgICAgICAgICBAXG5cbiAgICAgICAgc2VuZFRvTWFpbjogKHR5cGUsIGFyZ2wpIC0+XG4gICAgICAgICAgICBpZiBAZGJnIHRoZW4gY29uc29sZS5sb2cgXCJwb3N0IHRvIG1haW5cIiwgdHlwZSwgYXJnbFxuICAgICAgICAgICAgYXJnbC51bnNoaWZ0IHR5cGVcbiAgICAgICAgICAgIEBlbWl0LmFwcGx5IEAsIGFyZ2xcbiAgICAgICAgICAgIEBcblxuICAgICAgICBzZW5kVG9XaW5zOiAodHlwZSwgYXJnbCwgZXhjZXB0KSAtPlxuICAgICAgICAgICAgZm9yIHdpbiBpbiByZXF1aXJlKCdlbGVjdHJvbicpLkJyb3dzZXJXaW5kb3cuZ2V0QWxsV2luZG93cygpXG4gICAgICAgICAgICAgICAgaWYgd2luLmlkICE9IGV4Y2VwdFxuICAgICAgICAgICAgICAgICAgICBpZiBAZGJnIHRoZW4gY29uc29sZS5sb2cgXCJwb3N0IHRvICN7d2luLmlkfSAje3R5cGV9XCIgIywgYXJnbC5tYXAoKGEpIC0+IG5ldyBTdHJpbmcoYSkpLmpvaW4gJyAnXG4gICAgICAgICAgICAgICAgICAgIHdpbi53ZWJDb250ZW50cy5zZW5kKFBPU1QsIHR5cGUsIGFyZ2wpIFxuICAgICAgICAgICAgQFxuICAgICAgICAgICAgXG4gICAgICAgIGRlYnVnOiAoQGRiZz10cnVlKSAtPlxuICAgICAgICAgICAgY29uc29sZS5sb2cgXCJwb3N0LmRlYnVnXCIsIEBkYmdcblxuICAgIG1vZHVsZS5leHBvcnRzID0gbmV3IFBvc3RNYWluKClcbiAgICAiXX0=
//# sourceURL=../coffee/ppost.coffee