// koffee 1.4.0

/*
0000000    00000000    0000000    0000000 
000   000  000   000  000   000  000      
000   000  0000000    000000000  000  0000
000   000  000   000  000   000  000   000
0000000    000   000  000   000   0000000
 */
var $, Drag, _, def, kerror, klog, kpos, ref, stopEvent,
    bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; };

ref = require('./kxk'), def = ref.def, kpos = ref.kpos, klog = ref.klog, stopEvent = ref.stopEvent, kerror = ref.kerror, $ = ref.$, _ = ref._;

Drag = (function() {
    function Drag(cfg) {
        this.deactivate = bind(this.deactivate, this);
        this.activate = bind(this.activate, this);
        this.dragStop = bind(this.dragStop, this);
        this.dragUp = bind(this.dragUp, this);
        this.dragMove = bind(this.dragMove, this);
        this.dragStart = bind(this.dragStart, this);
        this.eventPos = bind(this.eventPos, this);
        var t;
        _.extend(this, def(cfg, {
            target: null,
            handle: null,
            onStart: null,
            onMove: null,
            onStop: null,
            active: true,
            stopEvent: true
        }));
        if (_.isString(this.target)) {
            t = $(this.target);
            if (t == null) {
                return kerror("Drag -- can't find drag target with id", this.target);
            }
            this.target = t;
        }
        if (this.target == null) {
            return kerror("Drag -- can't find drag target");
        }
        if (this.target === document.body) {
            this.useScreenPos = true;
        }
        if ((this.onStart != null) && !_.isFunction(this.onStart)) {
            kerror("Drag -- onStart not a function?");
        }
        if ((this.onMove != null) && !_.isFunction(this.onMove)) {
            kerror("Drag -- onMove not a function?");
        }
        if ((this.onEnd != null) && !_.isFunction(this.onEnd)) {
            kerror("Drag -- onEnd not a function?");
        }
        this.dragging = false;
        this.listening = false;
        if (_.isString(this.handle)) {
            this.handle = $(this.handle);
        }
        if (this.handle != null) {
            this.handle;
        } else {
            this.handle = this.target;
        }
        if (this.active) {
            this.activate();
        }
    }

    Drag.prototype.start = function(p, event) {
        if (!this.dragging && this.listening) {
            this.dragging = true;
            this.startPos = p;
            this.pos = p;
            this.delta = kpos(0, 0);
            this.deltaSum = kpos(0, 0);
            if ('skip' === (typeof this.onStart === "function" ? this.onStart(this, event) : void 0)) {
                delete this.startPos;
                this.dragging = false;
                return this;
            }
            this.lastPos = p;
            if (this.stopEvent !== false) {
                stopEvent(event);
            }
            document.addEventListener('mousemove', this.dragMove);
            document.addEventListener('mouseup', this.dragUp);
        }
        return this;
    };

    Drag.prototype.eventPos = function(event) {
        if (this.useScreenPos) {
            return kpos({
                x: event.screenX,
                y: event.screenY
            });
        } else {
            return kpos(event);
        }
    };

    Drag.prototype.dragStart = function(event) {
        return this.start(this.eventPos(event), event);
    };

    Drag.prototype.dragMove = function(event) {
        if (this.dragging) {
            this.pos = this.eventPos(event);
            this.delta = this.lastPos.to(this.pos);
            this.deltaSum = this.startPos.to(this.pos);
            if ((this.constrainKey != null) && event[this.constrainKey]) {
                if (this.constrain != null) {
                    this.constrain;
                } else {
                    this.constrain = Math.abs(this.delta.x) >= Math.abs(this.delta.y) ? kpos(1, 0) : kpos(0, 1);
                }
                this.delta.x *= this.constrain.x;
                this.delta.y *= this.constrain.y;
            } else {
                delete this.constrain;
            }
            if (typeof this.onMove === "function") {
                this.onMove(this, event);
            }
            this.lastPos = this.pos;
        }
        return this;
    };

    Drag.prototype.dragUp = function(event) {
        delete this.constrain;
        return this.dragStop(event);
    };

    Drag.prototype.dragStop = function(event) {
        if (this.dragging) {
            document.removeEventListener('mousemove', this.dragMove);
            document.removeEventListener('mouseup', this.dragUp);
            if ((this.onStop != null) && (event != null)) {
                this.onStop(this, event);
            }
            delete this.lastPos;
            delete this.startPos;
            this.dragging = false;
        }
        return this;
    };

    Drag.prototype.activate = function() {
        if (!this.listening) {
            this.listening = true;
            this.handle.addEventListener('mousedown', this.dragStart);
        }
        return this;
    };

    Drag.prototype.deactivate = function() {
        if (this.listening) {
            this.handle.removeEventListener('mousedown', this.dragStart);
            this.listening = false;
            if (this.dragging) {
                this.dragStop();
            }
        }
        return this;
    };

    return Drag;

})();

module.exports = Drag;

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZHJhZy5qcyIsInNvdXJjZVJvb3QiOiIuIiwic291cmNlcyI6WyIiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7QUFBQTs7Ozs7OztBQUFBLElBQUEsbURBQUE7SUFBQTs7QUFRQSxNQUErQyxPQUFBLENBQVEsT0FBUixDQUEvQyxFQUFFLGFBQUYsRUFBTyxlQUFQLEVBQWEsZUFBYixFQUFtQix5QkFBbkIsRUFBOEIsbUJBQTlCLEVBQXNDLFNBQXRDLEVBQXlDOztBQUVuQztJQUVDLGNBQUMsR0FBRDs7Ozs7Ozs7QUFFQyxZQUFBO1FBQUEsQ0FBQyxDQUFDLE1BQUYsQ0FBUyxJQUFULEVBQVksR0FBQSxDQUFJLEdBQUosRUFDUjtZQUFBLE1BQUEsRUFBVyxJQUFYO1lBQ0EsTUFBQSxFQUFXLElBRFg7WUFFQSxPQUFBLEVBQVcsSUFGWDtZQUdBLE1BQUEsRUFBVyxJQUhYO1lBSUEsTUFBQSxFQUFXLElBSlg7WUFLQSxNQUFBLEVBQVcsSUFMWDtZQU1BLFNBQUEsRUFBVyxJQU5YO1NBRFEsQ0FBWjtRQVNBLElBQUcsQ0FBQyxDQUFDLFFBQUYsQ0FBVyxJQUFDLENBQUEsTUFBWixDQUFIO1lBQ0ksQ0FBQSxHQUFHLENBQUEsQ0FBRSxJQUFDLENBQUEsTUFBSDtZQUNILElBQU8sU0FBUDtBQUNJLHVCQUFPLE1BQUEsQ0FBTyx3Q0FBUCxFQUFpRCxJQUFDLENBQUEsTUFBbEQsRUFEWDs7WUFFQSxJQUFDLENBQUEsTUFBRCxHQUFVLEVBSmQ7O1FBTUEsSUFBTyxtQkFBUDtBQUNJLG1CQUFPLE1BQUEsQ0FBTyxnQ0FBUCxFQURYOztRQUdBLElBQUcsSUFBQyxDQUFBLE1BQUQsS0FBVyxRQUFRLENBQUMsSUFBdkI7WUFDSSxJQUFDLENBQUEsWUFBRCxHQUFnQixLQURwQjs7UUFHQSxJQUE0QyxzQkFBQSxJQUFjLENBQUksQ0FBQyxDQUFDLFVBQUYsQ0FBYSxJQUFDLENBQUEsT0FBZCxDQUE5RDtZQUFBLE1BQUEsQ0FBTyxpQ0FBUCxFQUFBOztRQUNBLElBQTJDLHFCQUFBLElBQWEsQ0FBSSxDQUFDLENBQUMsVUFBRixDQUFhLElBQUMsQ0FBQSxNQUFkLENBQTVEO1lBQUEsTUFBQSxDQUFPLGdDQUFQLEVBQUE7O1FBQ0EsSUFBMEMsb0JBQUEsSUFBWSxDQUFJLENBQUMsQ0FBQyxVQUFGLENBQWEsSUFBQyxDQUFBLEtBQWQsQ0FBMUQ7WUFBQSxNQUFBLENBQU8sK0JBQVAsRUFBQTs7UUFFQSxJQUFDLENBQUEsUUFBRCxHQUFhO1FBQ2IsSUFBQyxDQUFBLFNBQUQsR0FBYTtRQUNiLElBQTJCLENBQUMsQ0FBQyxRQUFGLENBQVcsSUFBQyxDQUFBLE1BQVosQ0FBM0I7WUFBQSxJQUFDLENBQUEsTUFBRCxHQUFhLENBQUEsQ0FBRSxJQUFDLENBQUEsTUFBSCxFQUFiOzs7WUFDQSxJQUFDLENBQUE7O1lBQUQsSUFBQyxDQUFBLFNBQVksSUFBQyxDQUFBOztRQUNkLElBQWUsSUFBQyxDQUFBLE1BQWhCO1lBQUEsSUFBQyxDQUFBLFFBQUQsQ0FBQSxFQUFBOztJQS9CRDs7bUJBdUNILEtBQUEsR0FBTyxTQUFDLENBQUQsRUFBSSxLQUFKO1FBRUgsSUFBRyxDQUFJLElBQUMsQ0FBQSxRQUFMLElBQWtCLElBQUMsQ0FBQSxTQUF0QjtZQUNJLElBQUMsQ0FBQSxRQUFELEdBQVk7WUFDWixJQUFDLENBQUEsUUFBRCxHQUFZO1lBQ1osSUFBQyxDQUFBLEdBQUQsR0FBWTtZQUNaLElBQUMsQ0FBQSxLQUFELEdBQVksSUFBQSxDQUFLLENBQUwsRUFBTyxDQUFQO1lBQ1osSUFBQyxDQUFBLFFBQUQsR0FBWSxJQUFBLENBQUssQ0FBTCxFQUFPLENBQVA7WUFFWixJQUFHLE1BQUEsMkNBQVUsSUFBQyxDQUFBLFFBQVMsTUFBRyxnQkFBMUI7Z0JBQ0ksT0FBTyxJQUFDLENBQUE7Z0JBQ1IsSUFBQyxDQUFBLFFBQUQsR0FBWTtBQUNaLHVCQUFPLEtBSFg7O1lBS0EsSUFBQyxDQUFBLE9BQUQsR0FBVztZQUVYLElBQUcsSUFBQyxDQUFBLFNBQUQsS0FBYyxLQUFqQjtnQkFDSSxTQUFBLENBQVUsS0FBVixFQURKOztZQUdBLFFBQVEsQ0FBQyxnQkFBVCxDQUEwQixXQUExQixFQUFzQyxJQUFDLENBQUEsUUFBdkM7WUFDQSxRQUFRLENBQUMsZ0JBQVQsQ0FBMEIsU0FBMUIsRUFBc0MsSUFBQyxDQUFBLE1BQXZDLEVBbEJKOztlQW1CQTtJQXJCRzs7bUJBdUJQLFFBQUEsR0FBVSxTQUFDLEtBQUQ7UUFDTixJQUFHLElBQUMsQ0FBQSxZQUFKO21CQUNJLElBQUEsQ0FBSztnQkFBQSxDQUFBLEVBQUUsS0FBSyxDQUFDLE9BQVI7Z0JBQWlCLENBQUEsRUFBRSxLQUFLLENBQUMsT0FBekI7YUFBTCxFQURKO1NBQUEsTUFBQTttQkFHSSxJQUFBLENBQUssS0FBTCxFQUhKOztJQURNOzttQkFNVixTQUFBLEdBQVcsU0FBQyxLQUFEO2VBQVcsSUFBQyxDQUFBLEtBQUQsQ0FBTyxJQUFDLENBQUEsUUFBRCxDQUFVLEtBQVYsQ0FBUCxFQUF5QixLQUF6QjtJQUFYOzttQkFRWCxRQUFBLEdBQVUsU0FBQyxLQUFEO1FBRU4sSUFBRyxJQUFDLENBQUEsUUFBSjtZQUNJLElBQUMsQ0FBQSxHQUFELEdBQVksSUFBQyxDQUFBLFFBQUQsQ0FBVSxLQUFWO1lBQ1osSUFBQyxDQUFBLEtBQUQsR0FBWSxJQUFDLENBQUEsT0FBTyxDQUFDLEVBQVQsQ0FBWSxJQUFDLENBQUEsR0FBYjtZQUNaLElBQUMsQ0FBQSxRQUFELEdBQVksSUFBQyxDQUFBLFFBQVEsQ0FBQyxFQUFWLENBQWEsSUFBQyxDQUFBLEdBQWQ7WUFFWixJQUFHLDJCQUFBLElBQW1CLEtBQU0sQ0FBQSxJQUFDLENBQUEsWUFBRCxDQUE1Qjs7b0JBQ0ksSUFBQyxDQUFBOztvQkFBRCxJQUFDLENBQUEsWUFBZ0IsSUFBSSxDQUFDLEdBQUwsQ0FBUyxJQUFDLENBQUEsS0FBSyxDQUFDLENBQWhCLENBQUEsSUFBc0IsSUFBSSxDQUFDLEdBQUwsQ0FBUyxJQUFDLENBQUEsS0FBSyxDQUFDLENBQWhCLENBQXpCLEdBQWlELElBQUEsQ0FBSyxDQUFMLEVBQU8sQ0FBUCxDQUFqRCxHQUErRCxJQUFBLENBQUssQ0FBTCxFQUFPLENBQVA7O2dCQUM3RSxJQUFDLENBQUEsS0FBSyxDQUFDLENBQVAsSUFBWSxJQUFDLENBQUEsU0FBUyxDQUFDO2dCQUN2QixJQUFDLENBQUEsS0FBSyxDQUFDLENBQVAsSUFBWSxJQUFDLENBQUEsU0FBUyxDQUFDLEVBSDNCO2FBQUEsTUFBQTtnQkFLSSxPQUFPLElBQUMsQ0FBQSxVQUxaOzs7Z0JBT0EsSUFBQyxDQUFBLE9BQVEsTUFBRzs7WUFDWixJQUFDLENBQUEsT0FBRCxHQUFXLElBQUMsQ0FBQSxJQWJoQjs7ZUFjQTtJQWhCTTs7bUJBa0JWLE1BQUEsR0FBUSxTQUFDLEtBQUQ7UUFFSixPQUFPLElBQUMsQ0FBQTtlQUNSLElBQUMsQ0FBQSxRQUFELENBQVUsS0FBVjtJQUhJOzttQkFXUixRQUFBLEdBQVUsU0FBQyxLQUFEO1FBRU4sSUFBRyxJQUFDLENBQUEsUUFBSjtZQUNJLFFBQVEsQ0FBQyxtQkFBVCxDQUE2QixXQUE3QixFQUF5QyxJQUFDLENBQUEsUUFBMUM7WUFDQSxRQUFRLENBQUMsbUJBQVQsQ0FBNkIsU0FBN0IsRUFBeUMsSUFBQyxDQUFBLE1BQTFDO1lBQ0EsSUFBb0IscUJBQUEsSUFBYSxlQUFqQztnQkFBQSxJQUFDLENBQUEsTUFBRCxDQUFRLElBQVIsRUFBVyxLQUFYLEVBQUE7O1lBQ0EsT0FBTyxJQUFDLENBQUE7WUFDUixPQUFPLElBQUMsQ0FBQTtZQUNSLElBQUMsQ0FBQSxRQUFELEdBQVksTUFOaEI7O2VBT0E7SUFUTTs7bUJBaUJWLFFBQUEsR0FBVSxTQUFBO1FBRU4sSUFBRyxDQUFJLElBQUMsQ0FBQSxTQUFSO1lBQ0ksSUFBQyxDQUFBLFNBQUQsR0FBYTtZQUNiLElBQUMsQ0FBQSxNQUFNLENBQUMsZ0JBQVIsQ0FBeUIsV0FBekIsRUFBcUMsSUFBQyxDQUFBLFNBQXRDLEVBRko7O2VBR0E7SUFMTTs7bUJBT1YsVUFBQSxHQUFZLFNBQUE7UUFFUixJQUFHLElBQUMsQ0FBQSxTQUFKO1lBQ0ksSUFBQyxDQUFBLE1BQU0sQ0FBQyxtQkFBUixDQUE0QixXQUE1QixFQUF3QyxJQUFDLENBQUEsU0FBekM7WUFDQSxJQUFDLENBQUEsU0FBRCxHQUFhO1lBQ2IsSUFBZSxJQUFDLENBQUEsUUFBaEI7Z0JBQUEsSUFBQyxDQUFBLFFBQUQsQ0FBQSxFQUFBO2FBSEo7O2VBSUE7SUFOUTs7Ozs7O0FBUWhCLE1BQU0sQ0FBQyxPQUFQLEdBQWlCIiwic291cmNlc0NvbnRlbnQiOlsiIyMjXG4wMDAwMDAwICAgIDAwMDAwMDAwICAgIDAwMDAwMDAgICAgMDAwMDAwMCBcbjAwMCAgIDAwMCAgMDAwICAgMDAwICAwMDAgICAwMDAgIDAwMCAgICAgIFxuMDAwICAgMDAwICAwMDAwMDAwICAgIDAwMDAwMDAwMCAgMDAwICAwMDAwXG4wMDAgICAwMDAgIDAwMCAgIDAwMCAgMDAwICAgMDAwICAwMDAgICAwMDBcbjAwMDAwMDAgICAgMDAwICAgMDAwICAwMDAgICAwMDAgICAwMDAwMDAwIFxuIyMjXG5cbnsgZGVmLCBrcG9zLCBrbG9nLCBzdG9wRXZlbnQsIGtlcnJvciwgJCwgXyB9ID0gcmVxdWlyZSAnLi9reGsnXG5cbmNsYXNzIERyYWdcblxuICAgIEA6IChjZmcpIC0+XG4gICAgICAgIFxuICAgICAgICBfLmV4dGVuZCBALCBkZWYgY2ZnLFxuICAgICAgICAgICAgdGFyZ2V0OiAgICBudWxsXG4gICAgICAgICAgICBoYW5kbGU6ICAgIG51bGxcbiAgICAgICAgICAgIG9uU3RhcnQ6ICAgbnVsbFxuICAgICAgICAgICAgb25Nb3ZlOiAgICBudWxsXG4gICAgICAgICAgICBvblN0b3A6ICAgIG51bGxcbiAgICAgICAgICAgIGFjdGl2ZTogICAgdHJ1ZVxuICAgICAgICAgICAgc3RvcEV2ZW50OiB0cnVlXG5cbiAgICAgICAgaWYgXy5pc1N0cmluZyBAdGFyZ2V0XG4gICAgICAgICAgICB0ID0kIEB0YXJnZXRcbiAgICAgICAgICAgIGlmIG5vdCB0P1xuICAgICAgICAgICAgICAgIHJldHVybiBrZXJyb3IgXCJEcmFnIC0tIGNhbid0IGZpbmQgZHJhZyB0YXJnZXQgd2l0aCBpZFwiLCBAdGFyZ2V0XG4gICAgICAgICAgICBAdGFyZ2V0ID0gdFxuICAgICAgICAgICAgXG4gICAgICAgIGlmIG5vdCBAdGFyZ2V0P1xuICAgICAgICAgICAgcmV0dXJuIGtlcnJvciBcIkRyYWcgLS0gY2FuJ3QgZmluZCBkcmFnIHRhcmdldFwiXG4gICAgICAgIFxuICAgICAgICBpZiBAdGFyZ2V0ID09IGRvY3VtZW50LmJvZHlcbiAgICAgICAgICAgIEB1c2VTY3JlZW5Qb3MgPSB0cnVlXG4gICAgICAgICAgICBcbiAgICAgICAga2Vycm9yIFwiRHJhZyAtLSBvblN0YXJ0IG5vdCBhIGZ1bmN0aW9uP1wiIGlmIEBvblN0YXJ0PyBhbmQgbm90IF8uaXNGdW5jdGlvbiBAb25TdGFydFxuICAgICAgICBrZXJyb3IgXCJEcmFnIC0tIG9uTW92ZSBub3QgYSBmdW5jdGlvbj9cIiBpZiBAb25Nb3ZlPyBhbmQgbm90IF8uaXNGdW5jdGlvbiBAb25Nb3ZlXG4gICAgICAgIGtlcnJvciBcIkRyYWcgLS0gb25FbmQgbm90IGEgZnVuY3Rpb24/XCIgaWYgQG9uRW5kPyBhbmQgbm90IF8uaXNGdW5jdGlvbiBAb25FbmRcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgQGRyYWdnaW5nICA9IGZhbHNlXG4gICAgICAgIEBsaXN0ZW5pbmcgPSBmYWxzZVxuICAgICAgICBAaGFuZGxlICAgID0gJChAaGFuZGxlKSBpZiBfLmlzU3RyaW5nIEBoYW5kbGVcbiAgICAgICAgQGhhbmRsZSAgID89IEB0YXJnZXRcbiAgICAgICAgQGFjdGl2YXRlKCkgaWYgQGFjdGl2ZVxuXG4gICAgIyAgMDAwMDAwMCAgMDAwMDAwMDAwICAgMDAwMDAwMCAgIDAwMDAwMDAwICAgMDAwMDAwMDAwICBcbiAgICAjIDAwMCAgICAgICAgICAwMDAgICAgIDAwMCAgIDAwMCAgMDAwICAgMDAwICAgICAwMDAgICAgIFxuICAgICMgMDAwMDAwMCAgICAgIDAwMCAgICAgMDAwMDAwMDAwICAwMDAwMDAwICAgICAgIDAwMCAgICAgXG4gICAgIyAgICAgIDAwMCAgICAgMDAwICAgICAwMDAgICAwMDAgIDAwMCAgIDAwMCAgICAgMDAwICAgICBcbiAgICAjIDAwMDAwMDAgICAgICAwMDAgICAgIDAwMCAgIDAwMCAgMDAwICAgMDAwICAgICAwMDAgICAgIFxuICAgIFxuICAgIHN0YXJ0OiAocCwgZXZlbnQpIC0+XG4gICAgICAgIFxuICAgICAgICBpZiBub3QgQGRyYWdnaW5nIGFuZCBAbGlzdGVuaW5nXG4gICAgICAgICAgICBAZHJhZ2dpbmcgPSB0cnVlXG4gICAgICAgICAgICBAc3RhcnRQb3MgPSBwXG4gICAgICAgICAgICBAcG9zICAgICAgPSBwXG4gICAgICAgICAgICBAZGVsdGEgICAgPSBrcG9zIDAgMFxuICAgICAgICAgICAgQGRlbHRhU3VtID0ga3BvcyAwIDBcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgaWYgJ3NraXAnID09IEBvblN0YXJ0PyBALCBldmVudFxuICAgICAgICAgICAgICAgIGRlbGV0ZSBAc3RhcnRQb3NcbiAgICAgICAgICAgICAgICBAZHJhZ2dpbmcgPSBmYWxzZVxuICAgICAgICAgICAgICAgIHJldHVybiBAXG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICBAbGFzdFBvcyA9IHBcbiAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICBpZiBAc3RvcEV2ZW50ICE9IGZhbHNlXG4gICAgICAgICAgICAgICAgc3RvcEV2ZW50IGV2ZW50XG4gICAgXG4gICAgICAgICAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyICdtb3VzZW1vdmUnIEBkcmFnTW92ZVxuICAgICAgICAgICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lciAnbW91c2V1cCcgICBAZHJhZ1VwXG4gICAgICAgIEBcbiAgICBcbiAgICBldmVudFBvczogKGV2ZW50KSA9PlxuICAgICAgICBpZiBAdXNlU2NyZWVuUG9zXG4gICAgICAgICAgICBrcG9zIHg6ZXZlbnQuc2NyZWVuWCwgeTpldmVudC5zY3JlZW5ZXG4gICAgICAgIGVsc2VcbiAgICAgICAgICAgIGtwb3MgZXZlbnRcbiAgICAgICAgXG4gICAgZHJhZ1N0YXJ0OiAoZXZlbnQpID0+IEBzdGFydCBAZXZlbnRQb3MoZXZlbnQpLCBldmVudFxuICAgICAgICBcbiAgICAjIDAwICAgICAwMCAgIDAwMDAwMDAgICAwMDAgICAwMDAgIDAwMDAwMDAwICBcbiAgICAjIDAwMCAgIDAwMCAgMDAwICAgMDAwICAwMDAgICAwMDAgIDAwMCAgICAgICBcbiAgICAjIDAwMDAwMDAwMCAgMDAwICAgMDAwICAgMDAwIDAwMCAgIDAwMDAwMDAgICBcbiAgICAjIDAwMCAwIDAwMCAgMDAwICAgMDAwICAgICAwMDAgICAgIDAwMCAgICAgICBcbiAgICAjIDAwMCAgIDAwMCAgIDAwMDAwMDAgICAgICAgMCAgICAgIDAwMDAwMDAwICBcbiAgICBcbiAgICBkcmFnTW92ZTogKGV2ZW50KSA9PlxuXG4gICAgICAgIGlmIEBkcmFnZ2luZ1xuICAgICAgICAgICAgQHBvcyAgICAgID0gQGV2ZW50UG9zIGV2ZW50XG4gICAgICAgICAgICBAZGVsdGEgICAgPSBAbGFzdFBvcy50byBAcG9zXG4gICAgICAgICAgICBAZGVsdGFTdW0gPSBAc3RhcnRQb3MudG8gQHBvc1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBpZiBAY29uc3RyYWluS2V5PyBhbmQgZXZlbnRbQGNvbnN0cmFpbktleV1cbiAgICAgICAgICAgICAgICBAY29uc3RyYWluID89IGlmIE1hdGguYWJzKEBkZWx0YS54KSA+PSBNYXRoLmFicyhAZGVsdGEueSkgdGhlbiBrcG9zIDEsMCBlbHNlIGtwb3MgMCwxXG4gICAgICAgICAgICAgICAgQGRlbHRhLnggKj0gQGNvbnN0cmFpbi54XG4gICAgICAgICAgICAgICAgQGRlbHRhLnkgKj0gQGNvbnN0cmFpbi55XG4gICAgICAgICAgICBlbHNlXG4gICAgICAgICAgICAgICAgZGVsZXRlIEBjb25zdHJhaW5cbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgIEBvbk1vdmU/IEAsIGV2ZW50IFxuICAgICAgICAgICAgQGxhc3RQb3MgPSBAcG9zXG4gICAgICAgIEBcbiAgICAgICAgICAgICAgICBcbiAgICBkcmFnVXA6IChldmVudCkgPT4gXG4gICAgICAgIFxuICAgICAgICBkZWxldGUgQGNvbnN0cmFpblxuICAgICAgICBAZHJhZ1N0b3AgZXZlbnRcblxuICAgICMgIDAwMDAwMDAgIDAwMDAwMDAwMCAgIDAwMDAwMDAgICAwMDAwMDAwMCAgIFxuICAgICMgMDAwICAgICAgICAgIDAwMCAgICAgMDAwICAgMDAwICAwMDAgICAwMDAgIFxuICAgICMgMDAwMDAwMCAgICAgIDAwMCAgICAgMDAwICAgMDAwICAwMDAwMDAwMCAgIFxuICAgICMgICAgICAwMDAgICAgIDAwMCAgICAgMDAwICAgMDAwICAwMDAgICAgICAgIFxuICAgICMgMDAwMDAwMCAgICAgIDAwMCAgICAgIDAwMDAwMDAgICAwMDAgICAgICAgIFxuICAgIFxuICAgIGRyYWdTdG9wOiAoZXZlbnQpID0+XG5cbiAgICAgICAgaWYgQGRyYWdnaW5nXG4gICAgICAgICAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyICdtb3VzZW1vdmUnIEBkcmFnTW92ZVxuICAgICAgICAgICAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lciAnbW91c2V1cCcgICBAZHJhZ1VwXG4gICAgICAgICAgICBAb25TdG9wIEAsIGV2ZW50IGlmIEBvblN0b3A/IGFuZCBldmVudD9cbiAgICAgICAgICAgIGRlbGV0ZSBAbGFzdFBvc1xuICAgICAgICAgICAgZGVsZXRlIEBzdGFydFBvc1xuICAgICAgICAgICAgQGRyYWdnaW5nID0gZmFsc2VcbiAgICAgICAgQFxuXG4gICAgIyAgMDAwMDAwMCAgICAwMDAwMDAwICAwMDAwMDAwMDAgIDAwMCAgMDAwICAgMDAwICAgMDAwMDAwMCAgIDAwMDAwMDAwMCAgMDAwMDAwMDAgIFxuICAgICMgMDAwICAgMDAwICAwMDAgICAgICAgICAgMDAwICAgICAwMDAgIDAwMCAgIDAwMCAgMDAwICAgMDAwICAgICAwMDAgICAgIDAwMCAgICAgICBcbiAgICAjIDAwMDAwMDAwMCAgMDAwICAgICAgICAgIDAwMCAgICAgMDAwICAgMDAwIDAwMCAgIDAwMDAwMDAwMCAgICAgMDAwICAgICAwMDAwMDAwICAgXG4gICAgIyAwMDAgICAwMDAgIDAwMCAgICAgICAgICAwMDAgICAgIDAwMCAgICAgMDAwICAgICAwMDAgICAwMDAgICAgIDAwMCAgICAgMDAwICAgICAgIFxuICAgICMgMDAwICAgMDAwICAgMDAwMDAwMCAgICAgMDAwICAgICAwMDAgICAgICAwICAgICAgMDAwICAgMDAwICAgICAwMDAgICAgIDAwMDAwMDAwICBcbiAgICBcbiAgICBhY3RpdmF0ZTogPT5cbiAgICAgICAgXG4gICAgICAgIGlmIG5vdCBAbGlzdGVuaW5nXG4gICAgICAgICAgICBAbGlzdGVuaW5nID0gdHJ1ZVxuICAgICAgICAgICAgQGhhbmRsZS5hZGRFdmVudExpc3RlbmVyICdtb3VzZWRvd24nIEBkcmFnU3RhcnRcbiAgICAgICAgQFxuXG4gICAgZGVhY3RpdmF0ZTogPT5cblxuICAgICAgICBpZiBAbGlzdGVuaW5nXG4gICAgICAgICAgICBAaGFuZGxlLnJlbW92ZUV2ZW50TGlzdGVuZXIgJ21vdXNlZG93bicgQGRyYWdTdGFydFxuICAgICAgICAgICAgQGxpc3RlbmluZyA9IGZhbHNlXG4gICAgICAgICAgICBAZHJhZ1N0b3AoKSBpZiBAZHJhZ2dpbmdcbiAgICAgICAgQFxuXG5tb2R1bGUuZXhwb3J0cyA9IERyYWdcbiJdfQ==
//# sourceURL=../coffee/drag.coffee