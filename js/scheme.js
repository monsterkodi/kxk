/*
 0000000   0000000  000   000  00000000  00     00  00000000
000       000       000   000  000       000   000  000
0000000   000       000000000  0000000   000000000  0000000
     000  000       000   000  000       000 0 000  000
0000000    0000000  000   000  00000000  000   000  00000000
*/
var $, Scheme, _, elem, post, prefs, slash;

({prefs, elem, post, slash, $, _} = require('./kxk'));

Scheme = class Scheme {
  static toggle(schemes = ['dark', 'bright']) {
    var currentScheme, link, nextScheme, nextSchemeIndex;
    if (link = $('style-link')) {
      currentScheme = slash.basename(_.last(link.href.split('/')), '.css');
      nextSchemeIndex = (schemes.indexOf(currentScheme) + 1) % schemes.length;
      nextScheme = schemes[nextSchemeIndex];
      return Scheme.set(nextScheme);
    }
  }

  static set(scheme) {
    var href, link, newlink;
    link = $("#style-link");
    if (!link || !link.parentNode) {
      return;
    }
    scheme = slash.basename(scheme, '.css');
    prefs.set('scheme', scheme);
    newlink = elem('link', {
      href: `css/${scheme}.css`,
      rel: 'stylesheet',
      type: 'text/css',
      id: 'style-link'
    });
    link.parentNode.replaceChild(newlink, link);
    if (link = $("#style-title")) {
      href = slash.join(slash.dir(link.href), `${scheme}.css`);
      newlink = elem('link', {
        href: href,
        rel: 'stylesheet',
        type: 'text/css',
        id: 'style-title'
      });
      link.parentNode.replaceChild(newlink, link);
    }
    return post.emit('schemeChanged', scheme);
  }

};

module.exports = Scheme;

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic2NoZW1lLmpzIiwic291cmNlUm9vdCI6Ii4iLCJzb3VyY2VzIjpbIi4uL2NvZmZlZS9zY2hlbWUuY29mZmVlIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBOzs7Ozs7O0FBQUEsSUFBQSxDQUFBLEVBQUEsTUFBQSxFQUFBLENBQUEsRUFBQSxJQUFBLEVBQUEsSUFBQSxFQUFBLEtBQUEsRUFBQTs7QUFRQSxDQUFBLENBQUUsS0FBRixFQUFTLElBQVQsRUFBZSxJQUFmLEVBQXFCLEtBQXJCLEVBQTRCLENBQTVCLEVBQStCLENBQS9CLENBQUEsR0FBcUMsT0FBQSxDQUFRLE9BQVIsQ0FBckM7O0FBRU0sU0FBTixNQUFBLE9BQUE7RUFFYSxPQUFSLE1BQVEsQ0FBQyxVQUFVLENBQUMsTUFBRCxFQUFTLFFBQVQsQ0FBWCxDQUFBO0FBRUwsUUFBQSxhQUFBLEVBQUEsSUFBQSxFQUFBLFVBQUEsRUFBQTtJQUFBLElBQUcsSUFBQSxHQUFNLENBQUEsQ0FBRSxZQUFGLENBQVQ7TUFDSSxhQUFBLEdBQWdCLEtBQUssQ0FBQyxRQUFOLENBQWUsQ0FBQyxDQUFDLElBQUYsQ0FBTyxJQUFJLENBQUMsSUFBSSxDQUFDLEtBQVYsQ0FBZ0IsR0FBaEIsQ0FBUCxDQUFmLEVBQTZDLE1BQTdDO01BQ2hCLGVBQUEsR0FBa0IsQ0FBRSxPQUFPLENBQUMsT0FBUixDQUFnQixhQUFoQixDQUFBLEdBQWlDLENBQW5DLENBQUEsR0FBd0MsT0FBTyxDQUFDO01BQ2xFLFVBQUEsR0FBYSxPQUFRLENBQUEsZUFBQTthQUNyQixNQUFNLENBQUMsR0FBUCxDQUFXLFVBQVgsRUFKSjs7RUFGSzs7RUFRSCxPQUFMLEdBQUssQ0FBQyxNQUFELENBQUE7QUFFRixRQUFBLElBQUEsRUFBQSxJQUFBLEVBQUE7SUFBQSxJQUFBLEdBQU0sQ0FBQSxDQUFFLGFBQUY7SUFFTixJQUFVLENBQUksSUFBSixJQUFZLENBQUksSUFBSSxDQUFDLFVBQS9CO0FBQUEsYUFBQTs7SUFFQSxNQUFBLEdBQVMsS0FBSyxDQUFDLFFBQU4sQ0FBZSxNQUFmLEVBQXVCLE1BQXZCO0lBQ1QsS0FBSyxDQUFDLEdBQU4sQ0FBVSxRQUFWLEVBQW9CLE1BQXBCO0lBRUEsT0FBQSxHQUFVLElBQUEsQ0FBSyxNQUFMLEVBQ047TUFBQSxJQUFBLEVBQU0sQ0FBQSxJQUFBLENBQUEsQ0FBTyxNQUFQLENBQWMsSUFBZCxDQUFOO01BQ0EsR0FBQSxFQUFNLFlBRE47TUFFQSxJQUFBLEVBQU0sVUFGTjtNQUdBLEVBQUEsRUFBTTtJQUhOLENBRE07SUFLVixJQUFJLENBQUMsVUFBVSxDQUFDLFlBQWhCLENBQTZCLE9BQTdCLEVBQXNDLElBQXRDO0lBRUEsSUFBRyxJQUFBLEdBQU0sQ0FBQSxDQUFFLGNBQUYsQ0FBVDtNQUNJLElBQUEsR0FBTyxLQUFLLENBQUMsSUFBTixDQUFXLEtBQUssQ0FBQyxHQUFOLENBQVUsSUFBSSxDQUFDLElBQWYsQ0FBWCxFQUFpQyxDQUFBLENBQUEsQ0FBRyxNQUFILENBQVUsSUFBVixDQUFqQztNQUNQLE9BQUEsR0FBVSxJQUFBLENBQUssTUFBTCxFQUNOO1FBQUEsSUFBQSxFQUFNLElBQU47UUFDQSxHQUFBLEVBQU0sWUFETjtRQUVBLElBQUEsRUFBTSxVQUZOO1FBR0EsRUFBQSxFQUFNO01BSE4sQ0FETTtNQUtWLElBQUksQ0FBQyxVQUFVLENBQUMsWUFBaEIsQ0FBNkIsT0FBN0IsRUFBc0MsSUFBdEMsRUFQSjs7V0FTQSxJQUFJLENBQUMsSUFBTCxDQUFVLGVBQVYsRUFBMkIsTUFBM0I7RUF6QkU7O0FBVlY7O0FBcUNBLE1BQU0sQ0FBQyxPQUFQLEdBQWlCIiwic291cmNlc0NvbnRlbnQiOlsiIyMjXG4gMDAwMDAwMCAgIDAwMDAwMDAgIDAwMCAgIDAwMCAgMDAwMDAwMDAgIDAwICAgICAwMCAgMDAwMDAwMDBcbjAwMCAgICAgICAwMDAgICAgICAgMDAwICAgMDAwICAwMDAgICAgICAgMDAwICAgMDAwICAwMDBcbjAwMDAwMDAgICAwMDAgICAgICAgMDAwMDAwMDAwICAwMDAwMDAwICAgMDAwMDAwMDAwICAwMDAwMDAwXG4gICAgIDAwMCAgMDAwICAgICAgIDAwMCAgIDAwMCAgMDAwICAgICAgIDAwMCAwIDAwMCAgMDAwXG4wMDAwMDAwICAgIDAwMDAwMDAgIDAwMCAgIDAwMCAgMDAwMDAwMDAgIDAwMCAgIDAwMCAgMDAwMDAwMDBcbiMjI1xuXG57IHByZWZzLCBlbGVtLCBwb3N0LCBzbGFzaCwgJCwgXyB9ID0gcmVxdWlyZSAnLi9reGsnXG5cbmNsYXNzIFNjaGVtZVxuXG4gICAgQHRvZ2dsZTogKHNjaGVtZXMgPSBbJ2RhcmsnLCAnYnJpZ2h0J10pIC0+XG4gICAgICAgIFxuICAgICAgICBpZiBsaW5rID0kICdzdHlsZS1saW5rJ1xuICAgICAgICAgICAgY3VycmVudFNjaGVtZSA9IHNsYXNoLmJhc2VuYW1lIF8ubGFzdChsaW5rLmhyZWYuc3BsaXQoJy8nKSksICcuY3NzJ1xuICAgICAgICAgICAgbmV4dFNjaGVtZUluZGV4ID0gKCBzY2hlbWVzLmluZGV4T2YoY3VycmVudFNjaGVtZSkgKyAxKSAlIHNjaGVtZXMubGVuZ3RoXG4gICAgICAgICAgICBuZXh0U2NoZW1lID0gc2NoZW1lc1tuZXh0U2NoZW1lSW5kZXhdXG4gICAgICAgICAgICBTY2hlbWUuc2V0IG5leHRTY2hlbWVcblxuICAgIEBzZXQ6IChzY2hlbWUpIC0+XG4gICAgICAgIFxuICAgICAgICBsaW5rID0kIFwiI3N0eWxlLWxpbmtcIlxuICAgICAgICBcbiAgICAgICAgcmV0dXJuIGlmIG5vdCBsaW5rIG9yIG5vdCBsaW5rLnBhcmVudE5vZGVcbiAgICAgICAgXG4gICAgICAgIHNjaGVtZSA9IHNsYXNoLmJhc2VuYW1lIHNjaGVtZSwgJy5jc3MnXG4gICAgICAgIHByZWZzLnNldCAnc2NoZW1lJywgc2NoZW1lXG4gICAgICAgIFxuICAgICAgICBuZXdsaW5rID0gZWxlbSAnbGluaycsXG4gICAgICAgICAgICBocmVmOiBcImNzcy8je3NjaGVtZX0uY3NzXCJcbiAgICAgICAgICAgIHJlbDogICdzdHlsZXNoZWV0J1xuICAgICAgICAgICAgdHlwZTogJ3RleHQvY3NzJ1xuICAgICAgICAgICAgaWQ6ICAgJ3N0eWxlLWxpbmsnICAgICAgICAgICBcbiAgICAgICAgbGluay5wYXJlbnROb2RlLnJlcGxhY2VDaGlsZCBuZXdsaW5rLCBsaW5rXG4gICAgICAgIFxuICAgICAgICBpZiBsaW5rID0kIFwiI3N0eWxlLXRpdGxlXCJcbiAgICAgICAgICAgIGhyZWYgPSBzbGFzaC5qb2luIHNsYXNoLmRpcihsaW5rLmhyZWYpLCBcIiN7c2NoZW1lfS5jc3NcIlxuICAgICAgICAgICAgbmV3bGluayA9IGVsZW0gJ2xpbmsnLFxuICAgICAgICAgICAgICAgIGhyZWY6IGhyZWZcbiAgICAgICAgICAgICAgICByZWw6ICAnc3R5bGVzaGVldCdcbiAgICAgICAgICAgICAgICB0eXBlOiAndGV4dC9jc3MnXG4gICAgICAgICAgICAgICAgaWQ6ICAgJ3N0eWxlLXRpdGxlJyAgICAgICAgICAgXG4gICAgICAgICAgICBsaW5rLnBhcmVudE5vZGUucmVwbGFjZUNoaWxkIG5ld2xpbmssIGxpbmtcbiAgICAgICAgXG4gICAgICAgIHBvc3QuZW1pdCAnc2NoZW1lQ2hhbmdlZCcsIHNjaGVtZVxuXG5tb2R1bGUuZXhwb3J0cyA9IFNjaGVtZVxuIl19
//# sourceURL=../coffee/scheme.coffee