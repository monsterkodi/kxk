(function() {
  /*
  00       0000000    0000000 
  00      000   000  000      
  00      000   000  000  0000
  00      000   000  000   000
  000000   0000000    0000000 
  */
  var _, app, electron, err, fs, log, os, post, slog, sorcery, stack, str, sutil, udpLog, udpSend, udpStop;

  post = require('./ppost');

  str = require('./str');

  os = require('os');

  fs = require('fs');

  _ = require('lodash');

  sutil = require('stack-utils');

  sorcery = require('sorcery');

  stack = new sutil({
    cwd: process.cwd(),
    internals: sutil.nodeInternals()
  });

  udpSend = null;

  udpLog = function(info) {
    var udp;
    if (!udpSend) {
      udp = require('./udp');
      udpSend = new udp({
        debug: slog.debug
      });
    }
    info.id = slog.id;
    info.icon = slog.icon;
    return udpSend.send(info);
  };

  udpStop = function() {
    if (udpSend) {
      udpSend.close();
      return udpSend = null;
    }
  };

  slog = function(s) {
    var chain, err, f, file, info, match, meth, slash, source, sourceText;
    slash = require('./slash'); // fancy log with source-mapped files and line numbers
    try {
      f = stack.capture()[slog.depth];
      if (chain = sorcery.loadSync(f.getFileName())) {
        info = chain.trace(f.getLineNumber(), 0);
        source = f.getFileName();
        if (!slash.samePath(f.getScriptNameOrSourceURL(), f.getFileName())) {
          source = slash.path(f.getScriptNameOrSourceURL());
        } else {
          sourceText = fs.readFileSync(f.getFileName(), 'utf8');
          // balancer is broken. below is not a comment. should handle escaped hash signs. 
          match = sourceText.match(/\/\/\# sourceURL=(.+)$/);
          if ((match != null ? match[1] : void 0) != null) {
            source = match != null ? match[1] : void 0;
          }
        }
        info.source = slash.tilde(source);
      } else {
        info = {
          source: slash.tilde(f.getFileName()),
          line: f.getLineNumber()
        };
      }
      file = _.padStart(`${info.source}:${info.line}`, slog.filepad);
      meth = _.padEnd(f.getFunctionName(), slog.methpad);
      info.str = s;
      s = `${file}${slog.filesep}${meth}${slog.methsep}${s}`;
      post.emit('slog', s, info);
      if (slog.udp) {
        return udpLog(info);
      }
    } catch (error) {
      err = error;
      return post.emit('slog', `!${slog.methsep}${s} ${err}`);
    }
  };

  log = function() {
    var s;
    s = ((function() {
      var i, len, ref, results;
      ref = [].slice.call(arguments, 0);
      results = [];
      for (i = 0, len = ref.length; i < len; i++) {
        s = ref[i];
        results.push(str(s));
      }
      return results;
    }).apply(this, arguments)).join(" ");
    post.emit('log', s);
    console.log(s);
    return slog(s);
  };

  slog.udp = true;

  slog.id = '???';

  slog.icon = process.type === 'renderer' ? '●' : '◆';

  slog.depth = 2;

  slog.filesep = ' > '; //' ⦿ '

  slog.methsep = ' >> '; //' ▸ '

  slog.filepad = 30;

  slog.methpad = 15;

  log.slog = slog;

  log.stop = udpStop;

  try {
    electron = require('electron');
    if (process.type === 'renderer') {
      app = electron.remote.app;
    } else {
      app = electron.app;
    }
    slog.id = app.getName();
  } catch (error) {
    err = error;
    console.log('process.argv', process.argv.join(' '));
    null;
  }

  module.exports = log;

}).call(this);

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibG9nLmpzIiwic291cmNlUm9vdCI6Ii4uIiwic291cmNlcyI6WyJjb2ZmZWUvbG9nLmNvZmZlZSJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtFQUFBOzs7Ozs7O0FBQUEsTUFBQSxDQUFBLEVBQUEsR0FBQSxFQUFBLFFBQUEsRUFBQSxHQUFBLEVBQUEsRUFBQSxFQUFBLEdBQUEsRUFBQSxFQUFBLEVBQUEsSUFBQSxFQUFBLElBQUEsRUFBQSxPQUFBLEVBQUEsS0FBQSxFQUFBLEdBQUEsRUFBQSxLQUFBLEVBQUEsTUFBQSxFQUFBLE9BQUEsRUFBQTs7RUFRQSxJQUFBLEdBQVUsT0FBQSxDQUFRLFNBQVI7O0VBQ1YsR0FBQSxHQUFVLE9BQUEsQ0FBUSxPQUFSOztFQUNWLEVBQUEsR0FBVSxPQUFBLENBQVEsSUFBUjs7RUFDVixFQUFBLEdBQVUsT0FBQSxDQUFRLElBQVI7O0VBQ1YsQ0FBQSxHQUFVLE9BQUEsQ0FBUSxRQUFSOztFQUNWLEtBQUEsR0FBVSxPQUFBLENBQVEsYUFBUjs7RUFDVixPQUFBLEdBQVUsT0FBQSxDQUFRLFNBQVI7O0VBRVYsS0FBQSxHQUFVLElBQUksS0FBSixDQUFVO0lBQUEsR0FBQSxFQUFLLE9BQU8sQ0FBQyxHQUFSLENBQUEsQ0FBTDtJQUFvQixTQUFBLEVBQVcsS0FBSyxDQUFDLGFBQU4sQ0FBQTtFQUEvQixDQUFWOztFQUVWLE9BQUEsR0FBVTs7RUFDVixNQUFBLEdBQVMsUUFBQSxDQUFDLElBQUQsQ0FBQTtBQUNMLFFBQUE7SUFBQSxJQUFHLENBQUksT0FBUDtNQUNJLEdBQUEsR0FBTSxPQUFBLENBQVEsT0FBUjtNQUNOLE9BQUEsR0FBVSxJQUFJLEdBQUosQ0FBUTtRQUFBLEtBQUEsRUFBTSxJQUFJLENBQUM7TUFBWCxDQUFSLEVBRmQ7O0lBR0EsSUFBSSxDQUFDLEVBQUwsR0FBWSxJQUFJLENBQUM7SUFDakIsSUFBSSxDQUFDLElBQUwsR0FBWSxJQUFJLENBQUM7V0FDakIsT0FBTyxDQUFDLElBQVIsQ0FBYSxJQUFiO0VB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QTs7cUJBQVAsR0FBQSxDQUFJLENBQUo7TUFBTyxDQUFBOzs2QkFBUixDQUE0QyxDQUFDLElBQTdDLENBQWtELEdBQWxEO0lBRUosSUFBSSxDQUFDLElBQUwsQ0FBVSxLQUFWLEVBQWlCLENBQWpCO0lBQ0EsT0FBTyxDQUFDLEdBQVIsQ0FBWSxDQUFaO1dBQ0EsSUFBQSxDQUFLLENBQUw7RUFORTs7RUFRTixJQUFJLENBQUMsR0FBTCxHQUFlOztFQUNmLElBQUksQ0FBQyxFQUFMLEdBQWU7O0VBQ2YsSUFBSSxDQUFDLElBQUwsR0FBa0IsT0FBTyxDQUFDLElBQVIsS0FBZ0IsVUFBbkIsR0FBbUMsR0FBbkMsR0FBNEM7O0VBQzNELElBQUksQ0FBQyxLQUFMLEdBQWU7O0VBQ2YsSUFBSSxDQUFDLE9BQUwsR0FBZSxNQTVFZjs7RUE2RUEsSUFBSSxDQUFDLE9BQUwsR0FBZSxPQTdFZjs7RUE4RUEsSUFBSSxDQUFDLE9BQUwsR0FBZTs7RUFDZixJQUFJLENBQUMsT0FBTCxHQUFlOztFQUNmLEdBQUcsQ0FBQyxJQUFKLEdBQWU7O0VBQ2YsR0FBRyxDQUFDLElBQUosR0FBZTs7QUFFZjtJQUNJLFFBQUEsR0FBVyxPQUFBLENBQVEsVUFBUjtJQUNYLElBQUcsT0FBTyxDQUFDLElBQVIsS0FBZ0IsVUFBbkI7TUFDSSxHQUFBLEdBQU0sUUFBUSxDQUFDLE1BQU0sQ0FBQyxJQUQxQjtLQUFBLE1BQUE7TUFHSSxHQUFBLEdBQU0sUUFBUSxDQUFDLElBSG5COztJQUlBLElBQUksQ0FBQyxFQUFMLEdBQVUsR0FBRyxDQUFDLE9BQUosQ0FBQSxFQU5kO0dBQUEsYUFBQTtJQU9NO0lBQ0YsT0FBTyxDQUFDLEdBQVIsQ0FBWSxjQUFaLEVBQTRCLE9BQU8sQ0FBQyxJQUFJLENBQUMsSUFBYixDQUFrQixHQUFsQixDQUE1QjtJQUNBLEtBVEo7OztFQVdBLE1BQU0sQ0FBQyxPQUFQLEdBQWlCO0FBOUZqQiIsInNvdXJjZXNDb250ZW50IjpbIiMjI1xuMDAgICAgICAgMDAwMDAwMCAgICAwMDAwMDAwIFxuMDAgICAgICAwMDAgICAwMDAgIDAwMCAgICAgIFxuMDAgICAgICAwMDAgICAwMDAgIDAwMCAgMDAwMFxuMDAgICAgICAwMDAgICAwMDAgIDAwMCAgIDAwMFxuMDAwMDAwICAgMDAwMDAwMCAgICAwMDAwMDAwIFxuIyMjXG5cbnBvc3QgICAgPSByZXF1aXJlICcuL3Bwb3N0JyBcbnN0ciAgICAgPSByZXF1aXJlICcuL3N0cidcbm9zICAgICAgPSByZXF1aXJlICdvcydcbmZzICAgICAgPSByZXF1aXJlICdmcydcbl8gICAgICAgPSByZXF1aXJlICdsb2Rhc2gnXG5zdXRpbCAgID0gcmVxdWlyZSAnc3RhY2stdXRpbHMnXG5zb3JjZXJ5ID0gcmVxdWlyZSAnc29yY2VyeSdcblxuc3RhY2sgICA9IG5ldyBzdXRpbCBjd2Q6IHByb2Nlc3MuY3dkKCksIGludGVybmFsczogc3V0aWwubm9kZUludGVybmFscygpXG5cbnVkcFNlbmQgPSBudWxsXG51ZHBMb2cgPSAoaW5mbykgLT5cbiAgICBpZiBub3QgdWRwU2VuZFxuICAgICAgICB1ZHAgPSByZXF1aXJlICcuL3VkcCdcbiAgICAgICAgdWRwU2VuZCA9IG5ldyB1ZHAgZGVidWc6c2xvZy5kZWJ1Z1xuICAgIGluZm8uaWQgICA9IHNsb2cuaWRcbiAgICBpbmZvLmljb24gPSBzbG9nLmljb25cbiAgICB1ZHBTZW5kLnNlbmQgaW5mb1xuICAgIFxudWRwU3RvcCA9IC0+XG4gICAgaWYgdWRwU2VuZFxuICAgICAgICB1ZHBTZW5kLmNsb3NlKClcbiAgICAgICAgdWRwU2VuZCA9IG51bGxcblxuc2xvZyA9IChzKSAtPlxuICAgIFxuICAgIHNsYXNoID0gcmVxdWlyZSAnLi9zbGFzaCdcbiAgICBcbiAgICB0cnkgIyBmYW5jeSBsb2cgd2l0aCBzb3VyY2UtbWFwcGVkIGZpbGVzIGFuZCBsaW5lIG51bWJlcnNcbiAgICAgICAgZiA9IHN0YWNrLmNhcHR1cmUoKVtzbG9nLmRlcHRoXVxuICAgICAgICBpZiBjaGFpbiA9IHNvcmNlcnkubG9hZFN5bmMoZi5nZXRGaWxlTmFtZSgpKVxuICAgICAgICAgICAgaW5mbyAgID0gY2hhaW4udHJhY2UoZi5nZXRMaW5lTnVtYmVyKCksIDApXG4gICAgICAgICAgICBzb3VyY2UgPSBmLmdldEZpbGVOYW1lKClcbiAgICAgICAgICAgIGlmIG5vdCBzbGFzaC5zYW1lUGF0aCBmLmdldFNjcmlwdE5hbWVPclNvdXJjZVVSTCgpLCBmLmdldEZpbGVOYW1lKClcbiAgICAgICAgICAgICAgICBzb3VyY2UgPSBzbGFzaC5wYXRoIGYuZ2V0U2NyaXB0TmFtZU9yU291cmNlVVJMKClcbiAgICAgICAgICAgIGVsc2VcbiAgICAgICAgICAgICAgICBzb3VyY2VUZXh0ID0gZnMucmVhZEZpbGVTeW5jIGYuZ2V0RmlsZU5hbWUoKSwgJ3V0ZjgnXG4gICAgICAgICAgICAgICAgIyBiYWxhbmNlciBpcyBicm9rZW4uIGJlbG93IGlzIG5vdCBhIGNvbW1lbnQuIHNob3VsZCBoYW5kbGUgZXNjYXBlZCBoYXNoIHNpZ25zLiBcbiAgICAgICAgICAgICAgICBtYXRjaCAgPSBzb3VyY2VUZXh0Lm1hdGNoIC9cXC9cXC9cXCMgc291cmNlVVJMPSguKykkL1xuICAgICAgICAgICAgICAgIGlmIG1hdGNoP1sxXT9cbiAgICAgICAgICAgICAgICAgICAgc291cmNlID0gbWF0Y2g/WzFdXG4gICAgICAgICAgICBpbmZvLnNvdXJjZSA9IHNsYXNoLnRpbGRlIHNvdXJjZVxuICAgICAgICBlbHNlXG4gICAgICAgICAgICBpbmZvID0gc291cmNlOiBzbGFzaC50aWxkZShmLmdldEZpbGVOYW1lKCkpLCBsaW5lOiBmLmdldExpbmVOdW1iZXIoKVxuXG4gICAgICAgIGZpbGUgPSBfLnBhZFN0YXJ0IFwiI3tpbmZvLnNvdXJjZX06I3tpbmZvLmxpbmV9XCIsIHNsb2cuZmlsZXBhZFxuICAgICAgICBtZXRoID0gXy5wYWRFbmQgZi5nZXRGdW5jdGlvbk5hbWUoKSwgc2xvZy5tZXRocGFkXG4gICAgICAgIGluZm8uc3RyID0gc1xuICAgICAgICBzID0gXCIje2ZpbGV9I3tzbG9nLmZpbGVzZXB9I3ttZXRofSN7c2xvZy5tZXRoc2VwfSN7c31cIlxuICAgICAgICBwb3N0LmVtaXQgJ3Nsb2cnLCBzLCBpbmZvXG4gICAgICAgIGlmIHNsb2cudWRwXG4gICAgICAgICAgICB1ZHBMb2cgaW5mb1xuICAgICAgICAgICAgXG4gICAgY2F0Y2ggZXJyXG4gICAgICAgIHBvc3QuZW1pdCAnc2xvZycsIFwiISN7c2xvZy5tZXRoc2VwfSN7c30gI3tlcnJ9XCJcblxubG9nID0gLT5cbiAgICBcbiAgICBzID0gKHN0cihzKSBmb3IgcyBpbiBbXS5zbGljZS5jYWxsIGFyZ3VtZW50cywgMCkuam9pbiBcIiBcIiBcbiAgICBcbiAgICBwb3N0LmVtaXQgJ2xvZycsIHNcbiAgICBjb25zb2xlLmxvZyBzXG4gICAgc2xvZyBzXG5cbnNsb2cudWRwICAgICA9IHRydWVcbnNsb2cuaWQgICAgICA9ICc/Pz8nXG5zbG9nLmljb24gICAgPSBpZiBwcm9jZXNzLnR5cGUgPT0gJ3JlbmRlcmVyJyB0aGVuICfil48nIGVsc2UgJ+KXhidcbnNsb2cuZGVwdGggICA9IDJcbnNsb2cuZmlsZXNlcCA9ICcgPiAnICMnIOKmvyAnXG5zbG9nLm1ldGhzZXAgPSAnID4+ICcgIycg4pa4ICdcbnNsb2cuZmlsZXBhZCA9IDMwXG5zbG9nLm1ldGhwYWQgPSAxNVxubG9nLnNsb2cgICAgID0gc2xvZ1xubG9nLnN0b3AgICAgID0gdWRwU3RvcFxuXG50cnlcbiAgICBlbGVjdHJvbiA9IHJlcXVpcmUgJ2VsZWN0cm9uJ1xuICAgIGlmIHByb2Nlc3MudHlwZSA9PSAncmVuZGVyZXInXG4gICAgICAgIGFwcCA9IGVsZWN0cm9uLnJlbW90ZS5hcHBcbiAgICBlbHNlXG4gICAgICAgIGFwcCA9IGVsZWN0cm9uLmFwcFxuICAgIHNsb2cuaWQgPSBhcHAuZ2V0TmFtZSgpXG5jYXRjaCBlcnJcbiAgICBjb25zb2xlLmxvZyAncHJvY2Vzcy5hcmd2JywgcHJvY2Vzcy5hcmd2LmpvaW4gJyAnXG4gICAgbnVsbFxuXG5tb2R1bGUuZXhwb3J0cyA9IGxvZ1xuXG4iXX0=
//# sourceURL=C:/Users/kodi/s/kxk/coffee/log.coffee