// koffee 0.56.0

/*
000   000  000       0000000    0000000     
000  000   000      000   000  000          
0000000    000      000   000  000  0000    
000  000   000      000   000  000   000    
000   000  0000000   0000000    0000000
 */
var app, dumpImmediately, dumpInfos, dumpTimer, electron, err, fileLog, infos, klog, ref, ref1, ref2, slash, slog, stack, sutil;

sutil = require('stack-utils');

stack = new sutil({
    cwd: process.cwd(),
    internals: sutil.nodeInternals()
});

infos = [];

dumpInfos = function() {
    var fs, info, slash, stream;
    fs = require('fs');
    slash = require('./slash');
    stream = fs.createWriteStream(slash.resolve(slog.logFile), {
        flags: 'a',
        encoding: 'utf8'
    });
    while (infos.length) {
        info = infos.shift();
        stream.write(JSON.stringify(info) + '\n');
    }
    return stream.end();
};

dumpImmediately = function() {
    var data, fs, info, slash;
    fs = require('fs');
    slash = require('./slash');
    data = '';
    while (infos.length) {
        info = infos.shift();
        data += JSON.stringify(info) + '\n';
    }
    return fs.appendFileSync(slash.resolve(slog.logFile), data, 'utf8');
};

dumpTimer = null;

fileLog = function(info) {
    var err, i, len, line, lines;
    try {
        info.id = slog.id;
        info.icon = slog.icon;
        info.type = slog.type;
        lines = info.str.split('\n');
        if (lines.length) {
            for (i = 0, len = lines.length; i < len; i++) {
                line = lines[i];
                info.str = line;
                infos.push(Object.assign({}, info));
                info.sep = '';
                info.icon = '';
            }
        } else {
            infos.push(info);
        }
        return dumpImmediately();
    } catch (error) {
        err = error;
        console.error("kxk.log.fileLog -- ", err.stack);
        return slog.file = false;
    }
};

slog = function(s) {
    var chain, err, f, file, info, kstr, meth, post, slash, sorcery, sorceryInfo, source;
    slash = require('./slash');
    post = require('./ppost');
    kstr = require('./str');
    try {
        f = stack.capture()[slog.depth];
        sorcery = require('sorcery');
        info = {
            source: slash.tilde(f.getFileName()),
            line: f.getLineNumber()
        };
        try {
            if (chain = sorcery.loadSync(f.getFileName())) {
                sorceryInfo = chain.trace(f.getLineNumber(), 0);
                if (!slash.samePath(f.getScriptNameOrSourceURL(), f.getFileName())) {
                    if (slash.isAbsolute(f.getScriptNameOrSourceURL())) {
                        source = slash.path(f.getScriptNameOrSourceURL());
                    } else {
                        source = slash.resolve(slash.join(slash.dir(f.getFileName()), f.getScriptNameOrSourceURL()));
                    }
                } else {
                    source = f.getFileName();
                }
                sorceryInfo.source = slash.tilde(source);
                info = sorceryInfo;
            } else {

            }
        } catch (error) {
            err = error;
            true;
        }
        file = kstr.lpad(info.source + ":" + info.line, slog.filepad);
        meth = kstr.rpad(f.getFunctionName(), slog.methpad);
        info.str = s;
        s = "" + file + slog.filesep + meth + slog.methsep + s;
        post.emit('slog', s, info);
        if (slog.file) {
            return fileLog(info);
        }
    } catch (error) {
        err = error;
        console.error(err);
        return post.emit('slog', "!" + slog.methsep + s + " " + err);
    }
};

klog = function() {
    var kstr, post, s;
    kstr = require('./str');
    s = ((function() {
        var i, len, ref, results;
        ref = [].slice.call(arguments, 0);
        results = [];
        for (i = 0, len = ref.length; i < len; i++) {
            s = ref[i];
            results.push(kstr(s));
        }
        return results;
    }).apply(this, arguments)).join(" ");
    post = require('./ppost');
    post.emit('log', s);
    console.log(s);
    return slog(s);
};

slog.file = true;

if (process.platform === 'win32') {
    slog.logFile = '~/AppData/Roaming/klog.txt';
} else if (process.platform === 'darwin') {
    slog.logFile = '~/Library/Application Support/klog.txt';
} else {
    slash = require('./slash');
    if (slash.isFile('~/AppData/Roaming/klog.txt')) {
        slog.logFile = '~/AppData/Roaming/klog.txt';
    } else {
        slog.file = false;
    }
}

slog.id = '???';

slog.type = process.type === 'renderer' ? 'win' : 'main';

slog.icon = process.type === 'renderer' ? '●' : '◼';

slog.depth = 2;

slog.filesep = ' > ';

slog.methsep = ' >> ';

slog.filepad = 30;

slog.methpad = 15;

klog.slog = slog;

klog.flog = fileLog;

try {
    electron = require('electron');
    if (process.type === 'renderer') {
        app = electron.remote.app;
    } else {
        app = electron.app;
    }
    slog.id = app.getName();
    slash = require('./slash');
    slog.logFile = slash.join(app.getPath('appData'), 'klog.txt');
} catch (error) {
    err = error;
    try {
        slash = require('./slash');
        if (process.argv[0].length && ((ref = slash.base(process.argv[0])) === 'node' || ref === 'coffee' || ref === 'koffee' || ref === 'electron')) {
            if ((ref1 = process.argv[1]) != null ? ref1.length : void 0) {
                slog.id = slash.base(process.argv[1]);
            }
        } else if ((ref2 = slash.ext(process.argv.slice(-1)[0])) === 'js') {
            slog.id = slash.base(process.argv.slice(-1)[0]);
        } else {
            console.warn("can't figure out slog.id -- process.argv:", process.argv.join(' '));
        }
    } catch (error) {
        err = error;
        null;
    }
}

module.exports = klog;

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibG9nLmpzIiwic291cmNlUm9vdCI6Ii4iLCJzb3VyY2VzIjpbIiJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOztBQUFBOzs7Ozs7O0FBQUEsSUFBQTs7QUFRQSxLQUFBLEdBQVUsT0FBQSxDQUFRLGFBQVI7O0FBQ1YsS0FBQSxHQUFVLElBQUksS0FBSixDQUFVO0lBQUEsR0FBQSxFQUFLLE9BQU8sQ0FBQyxHQUFSLENBQUEsQ0FBTDtJQUFvQixTQUFBLEVBQVcsS0FBSyxDQUFDLGFBQU4sQ0FBQSxDQUEvQjtDQUFWOztBQVFWLEtBQUEsR0FBUTs7QUFFUixTQUFBLEdBQVksU0FBQTtBQUVSLFFBQUE7SUFBQSxFQUFBLEdBQVMsT0FBQSxDQUFRLElBQVI7SUFDVCxLQUFBLEdBQVMsT0FBQSxDQUFRLFNBQVI7SUFDVCxNQUFBLEdBQVMsRUFBRSxDQUFDLGlCQUFILENBQXFCLEtBQUssQ0FBQyxPQUFOLENBQWMsSUFBSSxDQUFDLE9BQW5CLENBQXJCLEVBQWtEO1FBQUEsS0FBQSxFQUFNLEdBQU47UUFBVyxRQUFBLEVBQVUsTUFBckI7S0FBbEQ7QUFDVCxXQUFNLEtBQUssQ0FBQyxNQUFaO1FBQ0ksSUFBQSxHQUFPLEtBQUssQ0FBQyxLQUFOLENBQUE7UUFDUCxNQUFNLENBQUMsS0FBUCxDQUFhLElBQUksQ0FBQyxTQUFMLENBQWUsSUFBZixDQUFBLEdBQXFCLElBQWxDO0lBRko7V0FHQSxNQUFNLENBQUMsR0FBUCxDQUFBO0FBUlE7O0FBVVosZUFBQSxHQUFrQixTQUFBO0FBRWQsUUFBQTtJQUFBLEVBQUEsR0FBUyxPQUFBLENBQVEsSUFBUjtJQUNULEtBQUEsR0FBUyxPQUFBLENBQVEsU0FBUjtJQUNULElBQUEsR0FBTztBQUNQLFdBQU0sS0FBSyxDQUFDLE1BQVo7UUFDSSxJQUFBLEdBQU8sS0FBSyxDQUFDLEtBQU4sQ0FBQTtRQUNQLElBQUEsSUFBUSxJQUFJLENBQUMsU0FBTCxDQUFlLElBQWYsQ0FBQSxHQUFxQjtJQUZqQztXQUdBLEVBQUUsQ0FBQyxjQUFI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Q0FBQSxhQUFBO0lBU007QUFDRjtRQUNJLEtBQUEsR0FBUSxPQUFBLENBQVEsU0FBUjtRQUNSLElBQUcsT0FBTyxDQUFDLElBQUssQ0FBQSxDQUFBLENBQUUsQ0FBQyxNQUFoQixJQUEyQixRQUFBLEtBQUssQ0FBQyxJQUFOLENBQVcsT0FBTyxDQUFDLElBQUssQ0FBQSxDQUFBLENBQXhCLEVBQUEsS0FBZ0MsTUFBaEMsSUFBQSxHQUFBLEtBQXdDLFFBQXhDLElBQUEsR0FBQSxLQUFrRCxRQUFsRCxJQUFBLEdBQUEsS0FBNEQsVUFBNUQsQ0FBOUI7WUFDSSwyQ0FBa0IsQ0FBRSxlQUFwQjtnQkFDSSxJQUFJLENBQUMsRUFBTCxHQUFVLEtBQUssQ0FBQyxJQUFOLENBQVcsT0FBTyxDQUFDLElBQUssQ0FBQSxDQUFBLENBQXhCLEVBRGQ7YUFESjtTQUFBLE1BR0ssWUFBRyxLQUFLLENBQUMsR0FBTixDQUFVLE9BQU8sQ0FBQyxJQUFLLFVBQUUsQ0FBQSxDQUFBLENBQXpCLEVBQUEsS0FBZ0MsSUFBbkM7WUFDRCxJQUFJLENBQUMsRUFBTCxHQUFVLEtBQUssQ0FBQyxJQUFOLENBQVcsT0FBTyxDQUFDLElBQUssVUFBRSxDQUFBLENBQUEsQ0FBMUIsRUFEVDtTQUFBLE1BQUE7WUFHRixPQUFBLENBQUMsSUFBRCxDQUFNLDJDQUFOLEVBQW1ELE9BQU8sQ0FBQyxJQUFJLENBQUMsSUFBYixDQUFrQixHQUFsQixDQUFuRCxFQUhFO1NBTFQ7S0FBQSxhQUFBO1FBU007UUFDRixLQVZKO0tBVko7OztBQXNCQSxNQUFNLENBQUMsT0FBUCxHQUFpQiIsInNvdXJjZXNDb250ZW50IjpbIiMjI1xuMDAwICAgMDAwICAwMDAgICAgICAgMDAwMDAwMCAgICAwMDAwMDAwICAgICBcbjAwMCAgMDAwICAgMDAwICAgICAgMDAwICAgMDAwICAwMDAgICAgICAgICAgXG4wMDAwMDAwICAgIDAwMCAgICAgIDAwMCAgIDAwMCAgMDAwICAwMDAwICAgIFxuMDAwICAwMDAgICAwMDAgICAgICAwMDAgICAwMDAgIDAwMCAgIDAwMCAgICBcbjAwMCAgIDAwMCAgMDAwMDAwMCAgIDAwMDAwMDAgICAgMDAwMDAwMCAgICAgXG4jIyNcblxuc3V0aWwgICA9IHJlcXVpcmUgJ3N0YWNrLXV0aWxzJ1xuc3RhY2sgICA9IG5ldyBzdXRpbCBjd2Q6IHByb2Nlc3MuY3dkKCksIGludGVybmFsczogc3V0aWwubm9kZUludGVybmFscygpXG5cbiMgMDAwMDAwMDAgIDAwMCAgMDAwICAgICAgMDAwMDAwMDAgIFxuIyAwMDAgICAgICAgMDAwICAwMDAgICAgICAwMDAgICAgICAgXG4jIDAwMDAwMCAgICAwMDAgIDAwMCAgICAgIDAwMDAwMDAgICBcbiMgMDAwICAgICAgIDAwMCAgMDAwICAgICAgMDAwICAgICAgIFxuIyAwMDAgICAgICAgMDAwICAwMDAwMDAwICAwMDAwMDAwMCAgXG5cbmluZm9zID0gW11cblxuZHVtcEluZm9zID0gLT5cbiAgICBcbiAgICBmcyAgICAgPSByZXF1aXJlICdmcydcbiAgICBzbGFzaCAgPSByZXF1aXJlICcuL3NsYXNoJ1xuICAgIHN0cmVhbSA9IGZzLmNyZWF0ZVdyaXRlU3RyZWFtIHNsYXNoLnJlc29sdmUoc2xvZy5sb2dGaWxlKSwgZmxhZ3M6J2EnLCBlbmNvZGluZzogJ3V0ZjgnXG4gICAgd2hpbGUgaW5mb3MubGVuZ3RoXG4gICAgICAgIGluZm8gPSBpbmZvcy5zaGlmdCgpXG4gICAgICAgIHN0cmVhbS53cml0ZSBKU09OLnN0cmluZ2lmeShpbmZvKSsnXFxuJ1xuICAgIHN0cmVhbS5lbmQoKVxuXG5kdW1wSW1tZWRpYXRlbHkgPSAtPlxuICAgIFxuICAgIGZzICAgICA9IHJlcXVpcmUgJ2ZzJ1xuICAgIHNsYXNoICA9IHJlcXVpcmUgJy4vc2xhc2gnXG4gICAgZGF0YSA9ICcnXG4gICAgd2hpbGUgaW5mb3MubGVuZ3RoXG4gICAgICAgIGluZm8gPSBpbmZvcy5zaGlmdCgpXG4gICAgICAgIGRhdGEgKz0gSlNPTi5zdHJpbmdpZnkoaW5mbykrJ1xcbidcbiAgICBmcy5hcHBlbmRGaWxlU3luYyBzbGFzaC5yZXNvbHZlKHNsb2cubG9nRmlsZSksIGRhdGEsICd1dGY4J1xuICAgIFxuZHVtcFRpbWVyID0gbnVsbFxuICAgIFxuZmlsZUxvZyA9IChpbmZvKSAtPlxuICAgIFxuICAgIHRyeVxuICAgICAgICBpbmZvLmlkICAgPSBzbG9nLmlkXG4gICAgICAgIGluZm8uaWNvbiA9IHNsb2cuaWNvblxuICAgICAgICBpbmZvLnR5cGUgPSBzbG9nLnR5cGVcbiAgICAgICAgbGluZXMgPSBpbmZvLnN0ci5zcGxpdCAnXFxuJ1xuICAgICAgICBpZiBsaW5lcy5sZW5ndGhcbiAgICAgICAgICAgIGZvciBsaW5lIGluIGxpbmVzXG4gICAgICAgICAgICAgICAgaW5mby5zdHIgPSBsaW5lXG4gICAgICAgICAgICAgICAgaW5mb3MucHVzaCBPYmplY3QuYXNzaWduIHt9LCBpbmZvXG4gICAgICAgICAgICAgICAgaW5mby5zZXAgID0gJydcbiAgICAgICAgICAgICAgICBpbmZvLmljb24gPSAnJ1xuICAgICAgICBlbHNlXG4gICAgICAgICAgICBpbmZvcy5wdXNoIGluZm9cbiAgICAgICAgICAgIFxuICAgICAgICAjIGNsZWFySW1tZWRpYXRlIGR1bXBUaW1lclxuICAgICAgICAjIGR1bXBUaW1lciA9IHNldEltbWVkaWF0ZSBkdW1wSW5mb3NcbiAgICAgICAgXG4gICAgICAgIGR1bXBJbW1lZGlhdGVseSgpICMgc2hlbGwgc2NyaXB0cyBuZWVkIGltbWVkaWF0ZSBkdW1wXG4gICAgICAgIFxuICAgIGNhdGNoIGVyclxuICAgICAgICBlcnJvciBcImt4ay5sb2cuZmlsZUxvZyAtLSBcIiwgZXJyLnN0YWNrXG4gICAgICAgIHNsb2cuZmlsZSA9IGZhbHNlXG5cbiMgIDAwMDAwMDAgIDAwMCAgICAgICAwMDAwMDAwICAgIDAwMDAwMDAgICBcbiMgMDAwICAgICAgIDAwMCAgICAgIDAwMCAgIDAwMCAgMDAwICAgICAgICBcbiMgMDAwMDAwMCAgIDAwMCAgICAgIDAwMCAgIDAwMCAgMDAwICAwMDAwICBcbiMgICAgICAwMDAgIDAwMCAgICAgIDAwMCAgIDAwMCAgMDAwICAgMDAwICBcbiMgMDAwMDAwMCAgIDAwMDAwMDAgICAwMDAwMDAwICAgIDAwMDAwMDAgICBcblxuc2xvZyA9IChzKSAtPlxuICAgIFxuICAgIHNsYXNoID0gcmVxdWlyZSAnLi9zbGFzaCdcbiAgICBwb3N0ICA9IHJlcXVpcmUgJy4vcHBvc3QnXG4gICAga3N0ciAgPSByZXF1aXJlICcuL3N0cidcbiAgICBcbiAgICB0cnkgIyBmYW5jeSBsb2cgd2l0aCBzb3VyY2UtbWFwcGVkIGZpbGVzIGFuZCBsaW5lIG51bWJlcnNcbiAgICAgICAgZiA9IHN0YWNrLmNhcHR1cmUoKVtzbG9nLmRlcHRoXVxuICAgICAgICBzb3JjZXJ5ID0gcmVxdWlyZSAnc29yY2VyeSdcbiAgICAgICAgXG4gICAgICAgIGluZm8gPSBzb3VyY2U6IHNsYXNoLnRpbGRlKGYuZ2V0RmlsZU5hbWUoKSksIGxpbmU6IGYuZ2V0TGluZU51bWJlcigpXG4gICAgICAgIHRyeVxuICAgICAgICAgICAgaWYgY2hhaW4gPSBzb3JjZXJ5LmxvYWRTeW5jKGYuZ2V0RmlsZU5hbWUoKSlcbiAgICAgICAgICAgICAgICBzb3JjZXJ5SW5mbyA9IGNoYWluLnRyYWNlKGYuZ2V0TGluZU51bWJlcigpLCAwKVxuICAgICAgICAgICAgICAgIGlmIG5vdCBzbGFzaC5zYW1lUGF0aCBmLmdldFNjcmlwdE5hbWVPclNvdXJjZVVSTCgpLCBmLmdldEZpbGVOYW1lKClcbiAgICAgICAgICAgICAgICAgICAgaWYgc2xhc2guaXNBYnNvbHV0ZSBmLmdldFNjcmlwdE5hbWVPclNvdXJjZVVSTCgpXG4gICAgICAgICAgICAgICAgICAgICAgICBzb3VyY2UgPSBzbGFzaC5wYXRoIGYuZ2V0U2NyaXB0TmFtZU9yU291cmNlVVJMKClcbiAgICAgICAgICAgICAgICAgICAgZWxzZVxuICAgICAgICAgICAgICAgICAgICAgICAgc291cmNlID0gc2xhc2gucmVzb2x2ZSBzbGFzaC5qb2luIHNsYXNoLmRpcihmLmdldEZpbGVOYW1lKCkpLCBmLmdldFNjcmlwdE5hbWVPclNvdXJjZVVSTCgpXG4gICAgICAgICAgICAgICAgZWxzZVxuICAgICAgICAgICAgICAgICAgICBzb3VyY2UgPSBmLmdldEZpbGVOYW1lKClcbiAgICAgICAgICAgICAgICBzb3JjZXJ5SW5mby5zb3VyY2UgPSBzbGFzaC50aWxkZSBzb3VyY2VcbiAgICAgICAgICAgICAgICBpbmZvID0gc29yY2VyeUluZm9cbiAgICAgICAgICAgIGVsc2VcbiAgICAgICAgY2F0Y2ggZXJyXG4gICAgICAgICAgICB0cnVlXG5cbiAgICAgICAgZmlsZSA9IGtzdHIubHBhZCBcIiN7aW5mby5zb3VyY2V9OiN7aW5mby5saW5lfVwiLCBzbG9nLmZpbGVwYWRcbiAgICAgICAgbWV0aCA9IGtzdHIucnBhZCBmLmdldEZ1bmN0aW9uTmFtZSgpLCBzbG9nLm1ldGhwYWRcbiAgICAgICAgaW5mby5zdHIgPSBzXG4gICAgICAgIHMgPSBcIiN7ZmlsZX0je3Nsb2cuZmlsZXNlcH0je21ldGh9I3tzbG9nLm1ldGhzZXB9I3tzfVwiXG4gICAgICAgIHBvc3QuZW1pdCAnc2xvZycsIHMsIGluZm9cbiAgICAgICAgaWYgc2xvZy5maWxlXG4gICAgICAgICAgICBmaWxlTG9nIGluZm8gICAgICAgICAgICBcbiAgICAgICAgICAgIFxuICAgIGNhdGNoIGVyclxuICAgICAgICBlcnJvciBlcnJcbiAgICAgICAgcG9zdC5lbWl0ICdzbG9nJywgXCIhI3tzbG9nLm1ldGhzZXB9I3tzfSAje2Vycn1cIlxuXG4jIDAwMCAgICAgICAwMDAwMDAwICAgIDAwMDAwMDAgICBcbiMgMDAwICAgICAgMDAwICAgMDAwICAwMDAgICAgICAgIFxuIyAwMDAgICAgICAwMDAgICAwMDAgIDAwMCAgMDAwMCAgXG4jIDAwMCAgICAgIDAwMCAgIDAwMCAgMDAwICAgMDAwICBcbiMgMDAwMDAwMCAgIDAwMDAwMDAgICAgMDAwMDAwMCAgIFxuXG5rbG9nID0gLT5cbiAgICBcbiAgICBrc3RyID0gcmVxdWlyZSAnLi9zdHInXG4gICAgcyA9IChrc3RyKHMpIGZvciBzIGluIFtdLnNsaWNlLmNhbGwgYXJndW1lbnRzLCAwKS5qb2luIFwiIFwiIFxuICAgIFxuICAgIHBvc3QgPSByZXF1aXJlICcuL3Bwb3N0J1xuICAgIHBvc3QuZW1pdCAnbG9nJywgc1xuICAgIGNvbnNvbGUubG9nIHNcbiAgICBzbG9nIHNcblxuIyAgMDAwMDAwMCAgIDAwMDAwMDAgICAwMDAgICAwMDAgIDAwMDAwMDAwICAwMDAgICAwMDAwMDAwICAgICBcbiMgMDAwICAgICAgIDAwMCAgIDAwMCAgMDAwMCAgMDAwICAwMDAgICAgICAgMDAwICAwMDAgICAgICAgICAgXG4jIDAwMCAgICAgICAwMDAgICAwMDAgIDAwMCAwIDAwMCAgMDAwMDAwICAgIDAwMCAgMDAwICAwMDAwICAgIFxuIyAwMDAgICAgICAgMDAwICAgMDAwICAwMDAgIDAwMDAgIDAwMCAgICAgICAwMDAgIDAwMCAgIDAwMCAgICBcbiMgIDAwMDAwMDAgICAwMDAwMDAwICAgMDAwICAgMDAwICAwMDAgICAgICAgMDAwICAgMDAwMDAwMCAgICAgXG4gICAgXG5zbG9nLmZpbGUgPSB0cnVlXG5pZiBwcm9jZXNzLnBsYXRmb3JtID09ICd3aW4zMidcbiAgICBzbG9nLmxvZ0ZpbGUgPSAnfi9BcHBEYXRhL1JvYW1pbmcva2xvZy50eHQnXG5lbHNlIGlmIHByb2Nlc3MucGxhdGZvcm0gPT0gJ2RhcndpbidcbiAgICBzbG9nLmxvZ0ZpbGUgPSAnfi9MaWJyYXJ5L0FwcGxpY2F0aW9uIFN1cHBvcnQva2xvZy50eHQnXG5lbHNlXG4gICAgc2xhc2ggPSByZXF1aXJlICcuL3NsYXNoJ1xuICAgIGlmIHNsYXNoLmlzRmlsZSAnfi9BcHBEYXRhL1JvYW1pbmcva2xvZy50eHQnXG4gICAgICAgIHNsb2cubG9nRmlsZSA9ICd+L0FwcERhdGEvUm9hbWluZy9rbG9nLnR4dCdcbiAgICBlbHNlXG4gICAgICAgIHNsb2cuZmlsZSA9IGZhbHNlXG5cbnNsb2cuaWQgICAgICA9ICc/Pz8nXG5zbG9nLnR5cGUgICAgPSBpZiBwcm9jZXNzLnR5cGUgPT0gJ3JlbmRlcmVyJyB0aGVuICd3aW4nIGVsc2UgJ21haW4nXG5zbG9nLmljb24gICAgPSBpZiBwcm9jZXNzLnR5cGUgPT0gJ3JlbmRlcmVyJyB0aGVuICfil48nIGVsc2UgJ+KXvCdcbnNsb2cuZGVwdGggICA9IDJcbnNsb2cuZmlsZXNlcCA9ICcgPiAnXG5zbG9nLm1ldGhzZXAgPSAnID4+ICdcbnNsb2cuZmlsZXBhZCA9IDMwXG5zbG9nLm1ldGhwYWQgPSAxNVxuXG5rbG9nLnNsb2cgICAgPSBzbG9nXG5rbG9nLmZsb2cgICAgPSBmaWxlTG9nXG5cbnRyeVxuICAgIGVsZWN0cm9uID0gcmVxdWlyZSAnZWxlY3Ryb24nXG4gICAgaWYgcHJvY2Vzcy50eXBlID09ICdyZW5kZXJlcidcbiAgICAgICAgYXBwID0gZWxlY3Ryb24ucmVtb3RlLmFwcFxuICAgIGVsc2VcbiAgICAgICAgYXBwID0gZWxlY3Ryb24uYXBwXG4gICAgc2xvZy5pZCA9IGFwcC5nZXROYW1lKClcbiAgICBzbGFzaCA9IHJlcXVpcmUgJy4vc2xhc2gnXG4gICAgc2xvZy5sb2dGaWxlID0gc2xhc2guam9pbiBhcHAuZ2V0UGF0aCgnYXBwRGF0YScpLCAna2xvZy50eHQnXG5jYXRjaCBlcnJcbiAgICB0cnlcbiAgICAgICAgc2xhc2ggPSByZXF1aXJlICcuL3NsYXNoJ1xuICAgICAgICBpZiBwcm9jZXNzLmFyZ3ZbMF0ubGVuZ3RoIGFuZCBzbGFzaC5iYXNlKHByb2Nlc3MuYXJndlswXSkgaW4gWydub2RlJywgJ2NvZmZlZScsICdrb2ZmZWUnLCAnZWxlY3Ryb24nXVxuICAgICAgICAgICAgaWYgcHJvY2Vzcy5hcmd2WzFdPy5sZW5ndGhcbiAgICAgICAgICAgICAgICBzbG9nLmlkID0gc2xhc2guYmFzZSBwcm9jZXNzLmFyZ3ZbMV1cbiAgICAgICAgZWxzZSBpZiBzbGFzaC5leHQocHJvY2Vzcy5hcmd2Wy0xXSkgaW4gWydqcyddXG4gICAgICAgICAgICBzbG9nLmlkID0gc2xhc2guYmFzZSBwcm9jZXNzLmFyZ3ZbLTFdXG4gICAgICAgIGVsc2VcbiAgICAgICAgICAgIHdhcm4gXCJjYW4ndCBmaWd1cmUgb3V0IHNsb2cuaWQgLS0gcHJvY2Vzcy5hcmd2OlwiLCBwcm9jZXNzLmFyZ3Yuam9pbiAnICdcbiAgICBjYXRjaCBlcnJcbiAgICAgICAgbnVsbFxuICAgIFxubW9kdWxlLmV4cG9ydHMgPSBrbG9nXG5cbiJdfQ==
//# sourceURL=../coffee/log.coffee