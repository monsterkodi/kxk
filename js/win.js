(function() {
  /*
  000   000  000  000   000  
  000 0 000  000  0000  000  
  000000000  000  000 0 000  
  000   000  000  000  0000  
  00     00  000  000   000  
  */
  var $, Win, _, elem, empty, fs, keyinfo, log, popup, pos, post, prefs, scheme, slash, stopEvent, str, title, valid;

  ({post, keyinfo, title, scheme, stopEvent, prefs, slash, elem, empty, valid, popup, pos, str, fs, log, $, _} = require('./kxk'));

  Win = class Win {
    constructor(opt) {
      var electron;
      
      // 00     00  00000000  000   000  000   000   0000000    0000000  000000000  000   0000000   000   000  
      // 000   000  000       0000  000  000   000  000   000  000          000     000  000   000  0000  000  
      // 000000000  0000000   000 0 000  000   000  000000000  000          000     000  000   000  000 0 000  
      // 000 0 000  000       000  0000  000   000  000   000  000          000     000  000   000  000  0000  
      // 000   000  00000000  000   000   0000000   000   000   0000000     000     000   0000000   000   000  
      this.onMenuAction = this.onMenuAction.bind(this);
      //  0000000   0000000   000   000  000000000  00000000  000   000  000000000  
      // 000       000   000  0000  000     000     000        000 000      000     
      // 000       000   000  000 0 000     000     0000000     00000       000     
      // 000       000   000  000  0000     000     000        000 000      000     
      //  0000000   0000000   000   000     000     00000000  000   000     000     
      this.onContextMenu = this.onContextMenu.bind(this);
      
      // 000   000  00000000  000   000
      // 000  000   000        000 000
      // 0000000    0000000     00000
      // 000  000   000          000
      // 000   000  00000000     000
      this.onKeyDown = this.onKeyDown.bind(this);
      this.onKeyUp = this.onKeyUp.bind(this);
      this.opt = opt;
      window.onerror = function(msg, source, line, col, err) {
        var srcmap;
        srcmap = require('./srcmap');
        srcmap.logErr(err);
        return true;
      };
      prefs.init();
      if (this.opt.icon) {
        log.slog.icon = slash.fileUrl(slash.join(this.opt.dir, this.opt.icon));
      }
      electron = require('electron');
      this.win = window.win = electron.remote.getCurrentWindow();
      this.id = window.winID = this.win.id;
      this.modifiers = [];
      this.userData = electron.remote.app.getPath('userData');
      post.on('menuAction', this.onMenuAction);
      window.titlebar = new title(this.opt);
      document.body.addEventListener('contextmenu', this.onContextMenu);
      document.addEventListener('keydown', this.onKeyDown);
      document.addEventListener('keyup', this.onKeyUp);
      if (this.opt.scheme !== false) {
        scheme.set(prefs.get('scheme', 'dark'));
      }
    }

    // 0000000   0000000  00000000   00000000  00000000  000   000   0000000  000   000   0000000   000000000
    //000       000       000   000  000       000       0000  000  000       000   000  000   000     000
    //0000000   000       0000000    0000000   0000000   000 0 000  0000000   000000000  000   000     000
    //     000  000       000   000  000       000       000  0000       000  000   000  000   000     000
    //0000000    0000000  000   000  00000000  00000000  000   000  0000000   000   000   0000000      000
    screenshot() {
      return this.win.capturePage((img) => {
        var file;
        file = slash.resolve(`~/Desktop/${this.opt.pkg.name}-screenshot.png`);
        return fs.writeFile(file, img.toPNG(), function(err) {
          if (valid(err)) {
            return log('saving screenshot failed', err);
          } else {
            return log(`screenshot saved to ${file}`);
          }
        });
      });
    }

    onMenuAction(action, args) {
      switch (action) {
        case 'Screenshot':
          return this.screenshot();
        case 'About':
          return post.toMain('showAbout');
        case 'Save':
          return post.toMain('saveBuffer');
        case 'Quit':
          return post.toMain('quitApp');
      }
    }

    onContextMenu(event) {
      var absPos, items;
      absPos = pos(event);
      if (absPos == null) {
        absPos = pos($("#main").getBoundingClientRect().left, $("#main").getBoundingClientRect().top);
      }
      items = _.clone(window.titlebar.menuTemplate());
      if (_.isFunction(this.opt.context)) {
        items = this.opt.context(items);
      } else {
        items.unshift({
          text: 'Clear',
          accel: 'ctrl+k'
        });
      }
      return popup.menu({
        items: items,
        x: absPos.x,
        y: absPos.y,
        onClose: function() {
          return post.emit('contextClosed');
        }
      });
    }

    onKeyDown(event) {
      var info, ref;
      if ('unhandled' !== window.titlebar.handleKey(event, true)) {
        return stopEvent(event);
      }
      info = keyinfo.forEvent(event);
      if (info.combo) {
        info.event = event;
        if ((ref = info.combo) === 'ctrl' || ref === 'alt' || ref === 'meta') {
          _.pull(this.modifiers, info.combo);
          this.modifiers.push(info.combo);
        }
        return post.emit('combo', info.combo, info);
      }
    }

    onKeyUp(event) {
      var info, ref;
      info = keyinfo.forEvent(event);
      console.log('up', info.combo);
      if ((ref = info.combo) === 'ctrl' || ref === 'alt' || ref === 'meta') {
        return _.pull(this.modifiers, info.combo);
      }
    }

  };

  module.exports = Win;

}).call(this);

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoid2luLmpzIiwic291cmNlUm9vdCI6Ii4iLCJzb3VyY2VzIjpbIi4uL2NvZmZlZS93aW4uY29mZmVlIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0VBQUE7Ozs7Ozs7QUFBQSxNQUFBLENBQUEsRUFBQSxHQUFBLEVBQUEsQ0FBQSxFQUFBLElBQUEsRUFBQSxLQUFBLEVBQUEsRUFBQSxFQUFBLE9BQUEsRUFBQSxHQUFBLEVBQUEsS0FBQSxFQUFBLEdBQUEsRUFBQSxJQUFBLEVBQUEsS0FBQSxFQUFBLE1BQUEsRUFBQSxLQUFBLEVBQUEsU0FBQSxFQUFBLEdBQUEsRUFBQSxLQUFBLEVBQUE7O0VBUUEsQ0FBQSxDQUFFLElBQUYsRUFBUSxPQUFSLEVBQWlCLEtBQWpCLEVBQXdCLE1BQXhCLEVBQWdDLFNBQWhDLEVBQTJDLEtBQTNDLEVBQWtELEtBQWxELEVBQXlELElBQXpELEVBQStELEtBQS9ELEVBQXNFLEtBQXRFLEVBQTZFLEtBQTdFLEVBQW9GLEdBQXBGLEVBQXlGLEdBQXpGLEVBQThGLEVBQTlGLEVBQWtHLEdBQWxHLEVBQXVHLENBQXZHLEVBQTBHLENBQTFHLENBQUEsR0FBZ0gsT0FBQSxDQUFRLE9BQVIsQ0FBaEg7O0VBRU0sTUFBTixNQUFBLElBQUE7SUFFSSxXQUFhLElBQUEsQ0FBQTtBQUVULFVBQUEsUUFBQTs7Ozs7OztVQXNESixDQUFBLG1CQUFBLENBQUEsd0JBdERJOzs7Ozs7VUFvRUosQ0FBQSxvQkFBQSxDQUFBLHlCQXBFSTs7Ozs7OztVQTRGSixDQUFBLGdCQUFBLENBQUE7VUFhQSxDQUFBLGNBQUEsQ0FBQTtNQTNHYyxJQUFDLENBQUE7TUFFWCxNQUFNLENBQUMsT0FBUCxHQUFpQixRQUFBLENBQUMsR0FBRCxFQUFNLE1BQU4sRUFBYyxJQUFkLEVBQW9CLEdBQXBCLEVBQXlCLEdBQXpCLENBQUE7QUFFYixZQUFBO1FBQUEsTUFBQSxHQUFTLE9BQUEsQ0FBUSxVQUFSO1FBQ1QsTUFBTSxDQUFDLE1BQVAsQ0FBYyxHQUFkO2VBQ0E7TUFK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U0FBUyxDQUFDLElBQVgsQ0FBZ0IsSUFBSSxDQUFDLEtBQXJCLEVBRko7O2VBR0EsSUFBSSxDQUFDLElBQUwsQ0FBVSxPQUFWLEVBQW1CLElBQUksQ0FBQyxLQUF4QixFQUErQixJQUEvQixFQUxKOztJQU5POztJQWFYLE9BQVMsQ0FBQyxLQUFELENBQUE7QUFFTCxVQUFBLElBQUEsRUFBQTtNQUFBLElBQUEsR0FBTyxPQUFPLENBQUMsUUFBUixDQUFpQixLQUFqQjtNQUNQLE9BQU8sQ0FBQyxHQUFSLENBQVksSUFBWixFQUFrQixJQUFJLENBQUMsS0FBdkI7TUFFQSxXQUFHLElBQUksQ0FBQyxNQUFMLEtBQWUsTUFBZixJQUFBLEdBQUEsS0FBdUIsS0FBdkIsSUFBQSxHQUFBLEtBQThCLE1BQWpDO2VBQ0ksQ0FBQyxDQUFDLElBQUYsQ0FBTyxJQUFDLENBQUEsU0FBUixFQUFtQixJQUFJLENBQUMsS0FBeEIsRUFESjs7SUFMSzs7RUE3R2I7O0VBcUhBLE1BQU0sQ0FBQyxPQUFQLEdBQWlCO0FBL0hqQiIsInNvdXJjZXNDb250ZW50IjpbIiMjI1xuMDAwICAgMDAwICAwMDAgIDAwMCAgIDAwMCAgXG4wMDAgMCAwMDAgIDAwMCAgMDAwMCAgMDAwICBcbjAwMDAwMDAwMCAgMDAwICAwMDAgMCAwMDAgIFxuMDAwICAgMDAwICAwMDAgIDAwMCAgMDAwMCAgXG4wMCAgICAgMDAgIDAwMCAgMDAwICAgMDAwICBcbiMjI1xuXG57IHBvc3QsIGtleWluZm8sIHRpdGxlLCBzY2hlbWUsIHN0b3BFdmVudCwgcHJlZnMsIHNsYXNoLCBlbGVtLCBlbXB0eSwgdmFsaWQsIHBvcHVwLCBwb3MsIHN0ciwgZnMsIGxvZywgJCwgXyB9ID0gcmVxdWlyZSAnLi9reGsnXG5cbmNsYXNzIFdpblxuICAgIFxuICAgIGNvbnN0cnVjdG9yOiAoQG9wdCkgLT5cbiAgICAgICAgXG4gICAgICAgIHdpbmRvdy5vbmVycm9yID0gKG1zZywgc291cmNlLCBsaW5lLCBjb2wsIGVycikgLT5cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgc3JjbWFwID0gcmVxdWlyZSAnLi9zcmNtYXAnXG4gICAgICAgICAgICBzcmNtYXAubG9nRXJyIGVyclxuICAgICAgICAgICAgdHJ1ZVxuICAgICAgICBcbiAgICAgICAgcHJlZnMuaW5pdCgpXG4gICAgICAgIFxuICAgICAgICBpZiBAb3B0Lmljb25cbiAgICAgICAgICAgIGxvZy5zbG9nLmljb24gPSBzbGFzaC5maWxlVXJsIHNsYXNoLmpvaW4gQG9wdC5kaXIsIEBvcHQuaWNvblxuICAgICAgICBcbiAgICAgICAgZWxlY3Ryb24gPSByZXF1aXJlICdlbGVjdHJvbidcbiAgICAgICAgXG4gICAgICAgIEB3aW4gPSB3aW5kb3cud2luID0gZWxlY3Ryb24ucmVtb3RlLmdldEN1cnJlbnRXaW5kb3coKVxuICAgICAgICBAaWQgID0gd2luZG93LndpbklEID0gQHdpbi5pZFxuICAgICAgICBcbiAgICAgICAgQG1vZGlmaWVycyA9IFtdXG5cbiAgICAgICAgQHVzZXJEYXRhID0gZWxlY3Ryb24ucmVtb3RlLmFwcC5nZXRQYXRoICd1c2VyRGF0YSdcbiAgICAgICAgXG4gICAgICAgIHBvc3Qub24gJ21lbnVBY3Rpb24nLCBAb25NZW51QWN0aW9uXG4gICAgICAgIFxuICAgICAgICB3aW5kb3cudGl0bGViYXIgPSBuZXcgdGl0bGUgQG9wdFxuICAgICAgICBcbiAgICAgICAgZG9jdW1lbnQuYm9keS5hZGRFdmVudExpc3RlbmVyICdjb250ZXh0bWVudScsIEBvbkNvbnRleHRNZW51XG4gICAgICAgIFxuICAgICAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyICdrZXlkb3duJywgQG9uS2V5RG93blxuICAgICAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyICdrZXl1cCcsICAgQG9uS2V5VXBcbiAgICAgICAgXG4gICAgICAgIGlmIEBvcHQuc2NoZW1lICE9IGZhbHNlXG4gICAgICAgICAgICBzY2hlbWUuc2V0IHByZWZzLmdldCAnc2NoZW1lJywgJ2RhcmsnXG5cbiAgICAjIDAwMDAwMDAgICAwMDAwMDAwICAwMDAwMDAwMCAgIDAwMDAwMDAwICAwMDAwMDAwMCAgMDAwICAgMDAwICAgMDAwMDAwMCAgMDAwICAgMDAwICAgMDAwMDAwMCAgIDAwMDAwMDAwMFxuICAgICMwMDAgICAgICAgMDAwICAgICAgIDAwMCAgIDAwMCAgMDAwICAgICAgIDAwMCAgICAgICAwMDAwICAwMDAgIDAwMCAgICAgICAwMDAgICAwMDAgIDAwMCAgIDAwMCAgICAgMDAwXG4gICAgIzAwMDAwMDAgICAwMDAgICAgICAgMDAwMDAwMCAgICAwMDAwMDAwICAgMDAwMDAwMCAgIDAwMCAwIDAwMCAgMDAwMDAwMCAgIDAwMDAwMDAwMCAgMDAwICAgMDAwICAgICAwMDBcbiAgICAjICAgICAwMDAgIDAwMCAgICAgICAwMDAgICAwMDAgIDAwMCAgICAgICAwMDAgICAgICAgMDAwICAwMDAwICAgICAgIDAwMCAgMDAwICAgMDAwICAwMDAgICAwMDAgICAgIDAwMFxuICAgICMwMDAwMDAwICAgIDAwMDAwMDAgIDAwMCAgIDAwMCAgMDAwMDAwMDAgIDAwMDAwMDAwICAwMDAgICAwMDAgIDAwMDAwMDAgICAwMDAgICAwMDAgICAwMDAwMDAwICAgICAgMDAwXG4gICAgXG4gICAgc2NyZWVuc2hvdDogLT5cbiAgICBcbiAgICAgICAgQHdpbi5jYXB0dXJlUGFnZSAoaW1nKSA9PlxuICAgICAgICAgICAgZmlsZSA9IHNsYXNoLnJlc29sdmUgXCJ+L0Rlc2t0b3AvI3tAb3B0LnBrZy5uYW1lfS1zY3JlZW5zaG90LnBuZ1wiXG4gICAgICAgICAgICBmcy53cml0ZUZpbGUgZmlsZSwgaW1nLnRvUE5HKCksIChlcnIpIC0+XG4gICAgICAgICAgICAgICAgaWYgdmFsaWQgZXJyXG4gICAgICAgICAgICAgICAgICAgIGxvZyAnc2F2aW5nIHNjcmVlbnNob3QgZmFpbGVkJywgZXJyXG4gICAgICAgICAgICAgICAgZWxzZVxuICAgICAgICAgICAgICAgICAgICBsb2cgXCJzY3JlZW5zaG90IHNhdmVkIHRvICN7ZmlsZX1cIlxuICAgICAgICAgICAgXG4gICAgIyAwMCAgICAgMDAgIDAwMDAwMDAwICAwMDAgICAwMDAgIDAwMCAgIDAwMCAgIDAwMDAwMDAgICAgMDAwMDAwMCAgMDAwMDAwMDAwICAwMDAgICAwMDAwMDAwICAgMDAwICAgMDAwICBcbiAgICAjIDAwMCAgIDAwMCAgMDAwICAgICAgIDAwMDAgIDAwMCAgMDAwICAgMDAwICAwMDAgICAwMDAgIDAwMCAgICAgICAgICAwMDAgICAgIDAwMCAgMDAwICAgMDAwICAwMDAwICAwMDAgIFxuICAgICMgMDAwMDAwMDAwICAwMDAwMDAwICAgMDAwIDAgMDAwICAwMDAgICAwMDAgIDAwMDAwMDAwMCAgMDAwICAgICAgICAgIDAwMCAgICAgMDAwICAwMDAgICAwMDAgIDAwMCAwIDAwMCAgXG4gICAgIyAwMDAgMCAwMDAgIDAwMCAgICAgICAwMDAgIDAwMDAgIDAwMCAgIDAwMCAgMDAwICAgMDAwICAwMDAgICAgICAgICAgMDAwICAgICAwMDAgIDAwMCAgIDAwMCAgMDAwICAwMDAwICBcbiAgICAjIDAwMCAgIDAwMCAgMDAwMDAwMDAgIDAwMCAgIDAwMCAgIDAwMDAwMDAgICAwMDAgICAwMDAgICAwMDAwMDAwICAgICAwMDAgICAgIDAwMCAgIDAwMDAwMDAgICAwMDAgICAwMDAgIFxuICAgIFxuICAgIG9uTWVudUFjdGlvbjogKGFjdGlvbiwgYXJncykgPT5cbiAgICAgICAgXG4gICAgICAgIHN3aXRjaCBhY3Rpb25cbiAgICAgICAgICAgIHdoZW4gJ1NjcmVlbnNob3QnIHRoZW4gQHNjcmVlbnNob3QoKVxuICAgICAgICAgICAgd2hlbiAnQWJvdXQnICAgICAgdGhlbiBwb3N0LnRvTWFpbiAnc2hvd0Fib3V0J1xuICAgICAgICAgICAgd2hlbiAnU2F2ZScgICAgICAgdGhlbiBwb3N0LnRvTWFpbiAnc2F2ZUJ1ZmZlcidcbiAgICAgICAgICAgIHdoZW4gJ1F1aXQnICAgICAgIHRoZW4gcG9zdC50b01haW4gJ3F1aXRBcHAnXG5cbiAgICAjICAwMDAwMDAwICAgMDAwMDAwMCAgIDAwMCAgIDAwMCAgMDAwMDAwMDAwICAwMDAwMDAwMCAgMDAwICAgMDAwICAwMDAwMDAwMDAgIFxuICAgICMgMDAwICAgICAgIDAwMCAgIDAwMCAgMDAwMCAgMDAwICAgICAwMDAgICAgIDAwMCAgICAgICAgMDAwIDAwMCAgICAgIDAwMCAgICAgXG4gICAgIyAwMDAgICAgICAgMDAwICAgMDAwICAwMDAgMCAwMDAgICAgIDAwMCAgICAgMDAwMDAwMCAgICAgMDAwMDAgICAgICAgMDAwICAgICBcbiAgICAjIDAwMCAgICAgICAwMDAgICAwMDAgIDAwMCAgMDAwMCAgICAgMDAwICAgICAwMDAgICAgICAgIDAwMCAwMDAgICAgICAwMDAgICAgIFxuICAgICMgIDAwMDAwMDAgICAwMDAwMDAwICAgMDAwICAgMDAwICAgICAwMDAgICAgIDAwMDAwMDAwICAwMDAgICAwMDAgICAgIDAwMCAgICAgXG4gICAgXG4gICAgb25Db250ZXh0TWVudTogKGV2ZW50KSA9PlxuICAgICAgICBcbiAgICAgICAgYWJzUG9zID0gcG9zIGV2ZW50XG4gICAgICAgIGlmIG5vdCBhYnNQb3M/XG4gICAgICAgICAgICBhYnNQb3MgPSBwb3MgJChcIiNtYWluXCIpLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLmxlZnQsICQoXCIjbWFpblwiKS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKS50b3BcbiAgICAgICAgXG4gICAgICAgIGl0ZW1zID0gXy5jbG9uZSB3aW5kb3cudGl0bGViYXIubWVudVRlbXBsYXRlKClcbiAgICAgICAgaWYgXy5pc0Z1bmN0aW9uIEBvcHQuY29udGV4dFxuICAgICAgICAgICAgaXRlbXMgPSBAb3B0LmNvbnRleHQgaXRlbXNcbiAgICAgICAgZWxzZVxuICAgICAgICAgICAgaXRlbXMudW5zaGlmdCB0ZXh0OidDbGVhcicsIGFjY2VsOidjdHJsK2snXG4gICAgICAgICAgICBcbiAgICAgICAgcG9wdXAubWVudVxuICAgICAgICAgICAgaXRlbXM6ICAgaXRlbXNcbiAgICAgICAgICAgIHg6ICAgICAgIGFic1Bvcy54XG4gICAgICAgICAgICB5OiAgICAgICBhYnNQb3MueVxuICAgICAgICAgICAgb25DbG9zZTogLT4gcG9zdC5lbWl0ICdjb250ZXh0Q2xvc2VkJ1xuICAgIFxuICAgICMgMDAwICAgMDAwICAwMDAwMDAwMCAgMDAwICAgMDAwXG4gICAgIyAwMDAgIDAwMCAgIDAwMCAgICAgICAgMDAwIDAwMFxuICAgICMgMDAwMDAwMCAgICAwMDAwMDAwICAgICAwMDAwMFxuICAgICMgMDAwICAwMDAgICAwMDAgICAgICAgICAgMDAwXG4gICAgIyAwMDAgICAwMDAgIDAwMDAwMDAwICAgICAwMDBcbiAgICBcbiAgICBvbktleURvd246IChldmVudCkgPT5cbiAgICBcbiAgICAgICAgcmV0dXJuIHN0b3BFdmVudChldmVudCkgaWYgJ3VuaGFuZGxlZCcgIT0gd2luZG93LnRpdGxlYmFyLmhhbmRsZUtleSBldmVudCwgdHJ1ZVxuICAgICAgICBcbiAgICAgICAgaW5mbyA9IGtleWluZm8uZm9yRXZlbnQgZXZlbnRcbiAgICBcbiAgICAgICAgaWYgaW5mby5jb21ib1xuICAgICAgICAgICAgaW5mby5ldmVudCA9IGV2ZW50XG4gICAgICAgICAgICBpZiBpbmZvLmNvbWJvIGluIFsnY3RybCcsICdhbHQnLCAnbWV0YSddXG4gICAgICAgICAgICAgICAgXy5wdWxsIEBtb2RpZmllcnMsIGluZm8uY29tYm9cbiAgICAgICAgICAgICAgICBAbW9kaWZpZXJzLnB1c2ggaW5mby5jb21ib1xuICAgICAgICAgICAgcG9zdC5lbWl0ICdjb21ibycsIGluZm8uY29tYm8sIGluZm9cbiAgICBcbiAgICBvbktleVVwOiAoZXZlbnQpID0+XG4gICAgICAgIFxuICAgICAgICBpbmZvID0ga2V5aW5mby5mb3JFdmVudCBldmVudFxuICAgICAgICBjb25zb2xlLmxvZyAndXAnLCBpbmZvLmNvbWJvXG4gICAgICAgIFxuICAgICAgICBpZiBpbmZvLmNvbWJvIGluIFsnY3RybCcsICdhbHQnLCAnbWV0YSddICAgXG4gICAgICAgICAgICBfLnB1bGwgQG1vZGlmaWVycywgaW5mby5jb21ib1xuICAgICAgICBcbm1vZHVsZS5leHBvcnRzID0gV2luXG4iXX0=
//# sourceURL=../coffee/win.coffee